import{r as gt,_ as yt,u as bt,b as wt,a as kt}from"./index-df0c598a.js";/* empty css               *//* empty css                   *//* empty css                    *//* empty css                 *//* empty css                       *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                       *//* empty css                  *//* empty css                         *//* empty css                        *//* empty css                *//* empty css                             *//* empty css                       */import{r as c,j as Vt,b as A,ae as Ct,l as m,B as D,C as f,F as a,G as t,af as _e,p as v,E as u,aE as xt,ag as Rt,M as It,ai as Et,u as b,O as r,S as g,D as i,H as ee,I as te,aY as we,aw as Dt,aZ as Ft,J as ae,K as Ut,az as zt,am as Mt,aA as Pt,al as Bt,an as $t,ap as Tt,aq as At,ax as St,ay as Yt,a6 as qt,ao as Nt,a_ as jt,a$ as Lt,a5 as Ot,ah as Gt,aK as Jt,aL as ht,a7 as Ht,aB as Kt,a2 as Zt,aC as Qt,aD as Wt}from"./element-plus-eb4b90a0.js";import{a as Xt,b as ea,r as S,v as ta,e as aa,f as la,h as oa,i as na}from"./user-3ae2c7ee.js";import{g as ra}from"./agent-12a88c2f.js";import{g as sa}from"./product-c369b114.js";import{g as ia}from"./insurer-27126369.js";import{f as J}from"./format-20468769.js";import{u as ua}from"./uuid2url-c75e1a77.js";function da(pe){const h=new FormData;return h.append("image",pe),gt({url:"/api/admin/ocr/biz-license",method:"post",data:h,headers:{"Content-Type":"multipart/form-data"}})}const _a={class:"user-detail"},pa={class:"page-header"},ma={class:"header-actions"},fa={class:"log-content"},ca={class:"operator"},va={class:"action"},ga={class:"dialog-footer"},ya={class:"review-content"},ba={class:"dialog-footer"},wa={class:"review-content"},ka={class:"dialog-footer"},Va={class:"review-content"},Ca={class:"dialog-footer"},xa={class:"upload-section"},Ra={class:"upload-area"},Ia={key:0,class:"ocr-loading"},Ea={key:1,class:"ocr-result"},Da={class:"result-content"},Fa={class:"dialog-footer"},Ua={class:"dialog-footer"},za={__name:"detail",setup(pe){const h=bt(),ke=wt(),C=kt(),le=c(!1),n=c({}),oe=c([]),me=c([]),H=c([]),F=c(!1),U=c(!1),z=c(!1),Y=c(!1),q=c(!1),N=c(!1),j=c(!1),ne=c(null),Ve=Vt(()=>j.value?"编辑用户配置":"添加用户配置"),re=c(),Ce=c(),xe=c(),Re=c(),se=c(),ie=c(),p=A({product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0}),R=A({audit_note:""}),I=A({audit_note:""}),M=A({audit_note:""}),k=A({company_name:"",organization:""}),L=A({insurer_id:void 0}),K=c(!1),P=c(null),Ie=c(),Ee={product_id:[{required:!0,message:"请选择产品",trigger:"change"}],sell_mode:[{required:!0,message:"请选择销售模式",trigger:"change"}],agent_id:[{required:!1,message:"请选择渠道商",trigger:"change"}],seller:[{required:!1,message:"请输入销售员姓名",trigger:"blur"}],insurance_type:[{required:!1,message:"请选择主要险种",trigger:"change"}],overdue_date:[{required:!1,message:"请选择过期时间",trigger:"change"}]},ue={audit_note:[{required:!1,message:"请输入审核备注",trigger:"blur"}]},De={company_name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],organization:[{required:!1,message:"请输入统一社会信用代码",trigger:"blur"}]},Fe={insurer_id:[{required:!0,message:"请选择保险公司",trigger:"change"}]},w=async()=>{le.value=!0;try{const l=await Xt(ke.params.id);n.value=l.data}catch(l){console.error("获取用户详情失败:",l),u.error("获取用户详情失败")}le.value=!1},Ue=async()=>{try{const l=await ra({page:1,page_size:1e3});oe.value=l.data.list}catch(l){console.error("获取渠道商列表失败:",l)}},ze=async()=>{try{const l=await sa({page:1,page_size:1e3});me.value=l.data.list}catch(l){console.error("获取产品列表失败:",l)}},Me=async()=>{try{const l=await ia({page:1,page_size:1e3});H.value=l.data.list}catch(l){console.error("获取保险公司列表失败:",l)}},Pe=l=>{if(!l){p.seller="";return}const e=oe.value.find(s=>s.id===l);e&&(p.seller=e.seller||e.contact_name||e.company_name||"")},Be=()=>{h.back()},$e=()=>{j.value=!1,ne.value=null,F.value=!0,Object.assign(p,{product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0})},Te=l=>{j.value=!0,ne.value=l.id,Object.assign(p,{product_id:l.product_id,sell_mode:l.sell_mode,agent_id:l.agent_id||void 0,seller:l.seller||"",insurance_type:l.insurance_type||"",agent_cost:l.agent_cost||void 0,service_fee:l.service_fee||void 0,overdue_date:l.overdue_date?new Date(l.overdue_date):void 0}),F.value=!0},Ae=l=>{ae.confirm("确认要删除该配置吗？","提示",{type:"warning"}).then(async()=>{try{await ea(l.id),u.success("删除配置成功"),w()}catch(e){console.error("删除配置失败:",e),u.error("删除配置失败")}})},Se=()=>{q.value=!0,k.company_name="",k.organization="",K.value=!1,P.value=null},Ye=()=>{N.value=!0,L.insurer_id=void 0},qe=()=>{U.value=!0,R.audit_note=""},Ne=()=>{z.value=!0,I.audit_note=""},je=()=>{Y.value=!0,M.audit_note=""},Le=()=>{ae.confirm("确认要停用该用户吗？","提示",{type:"warning"}).then(async()=>{await S(n.value.id,{status:"已停用"}),u.success("用户已停用"),w()})},Oe=()=>{ae.confirm("确认要为该用户添加认证吗？","提示",{type:"warning"}).then(async()=>{try{await ta(n.value.id),u.success("添加认证成功"),w()}catch(l){console.error("添加认证失败:",l),u.error("添加认证失败")}})},Ge=()=>{if(!n.value.verify_url){u.error("认证链接不存在");return}try{if(typeof window<"u"&&window.open)window.open(n.value.verify_url,"_blank");else{const l=document.createElement("a");l.href=n.value.verify_url,l.target="_blank",l.rel="noopener noreferrer",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}catch(l){console.error("打开认证链接失败:",l),u.error("无法打开认证链接，请手动复制链接访问")}},Je=()=>{if(!n.value.verify_url){u.error("认证链接不存在");return}navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(n.value.verify_url).then(()=>{u.success("认证链接已复制到剪贴板")}).catch(l=>{console.error("使用 Clipboard API 复制失败:",l),fe(n.value.verify_url)}):fe(n.value.verify_url)},fe=l=>{try{const e=document.createElement("textarea");e.value=l,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");if(document.body.removeChild(e),s)u.success("认证链接已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(e){console.error("复制失败:",e),ae.alert(n.value.verify_url,"请手动复制认证链接",{confirmButtonText:"确定",type:"info"})}},he=async()=>{try{await S(n.value.id,{status:"待终审",audit_note:R.audit_note||"初审通过"}),u.success("初审通过，用户进入终审阶段"),U.value=!1,w()}catch(l){console.error("初审操作失败:",l),u.error("初审操作失败")}},He=async()=>{if(!R.audit_note.trim()){u.warning("打回修改时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:R.audit_note}),u.success("已打回修改"),U.value=!1,w()}catch(l){console.error("初审操作失败:",l),u.error("初审操作失败")}},Ke=async()=>{try{await S(n.value.id,{status:"审核通过",audit_note:I.audit_note||"终审通过"}),u.success("审核通过，用户可正常使用系统"),z.value=!1,w()}catch(l){console.error("终审操作失败:",l),u.error("终审操作失败")}},Ze=async()=>{if(!I.audit_note.trim()){u.warning("退回初审时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:I.audit_note}),u.success("已退回初审"),z.value=!1,w()}catch(l){console.error("终审操作失败:",l),u.error("终审操作失败")}},Qe=async()=>{if(!M.audit_note.trim()){u.warning("重置状态时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:M.audit_note}),u.success("状态已重置为待初审"),Y.value=!1,w()}catch(l){console.error("重置状态失败:",l),u.error("重置状态失败")}},Z=l=>{ua(l).then(e=>{window.open(e,"_blank")})},We=async()=>{re.value&&await re.value.validate(async l=>{if(l)try{const e={...p,overdue_date:p.overdue_date?J(p.overdue_date,"YYYY-MM-DD"):null};p.sell_mode==="直销"&&(e.agent_id=null,e.agent_cost=0),j.value?(await aa(ne.value,e),u.success("配置更新成功")):(await la(n.value.id,e),u.success("配置添加成功")),F.value=!1,w()}catch(e){console.error("配置操作失败:",e),u.error("配置操作失败")}})},Xe=async()=>{se.value&&await se.value.validate(async l=>{var e,s;if(l)try{await oa(n.value.id,{company_name:k.company_name,organization:k.organization}),u.success("添加被保险人成功"),q.value=!1,w()}catch(_){console.error("添加被保险人失败:",_),u.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"添加被保险人失败")}})},et=async()=>{ie.value&&await ie.value.validate(async l=>{var e,s;if(l)try{await na(n.value.id,{insurer_id:L.insurer_id}),u.success("添加保险公司成功"),N.value=!1,w()}catch(_){console.error("添加保险公司失败:",_),u.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"添加保险公司失败")}})},tt=l=>({待初审:"warning",待终审:"primary",审核通过:"success",已停用:"info"})[l]||"info",ce=l=>({未认证:"info",管理员资料已提交:"warning",企业基本资料已提交:"warning",已提交待审核:"warning",审核通过:"success",审核不通过:"danger",人工初审通过:"primary"})[l]||"info",at=l=>({create:"primary",update:"success",review:"warning",delete:"danger",audit_pass:"success",audit_reject:"danger",audit_pending:"warning",initial_review:"primary",final_review:"warning",reset_status:"info",update_config:"info"})[l]||"info",lt=l=>!l||!H.value.length?"":l.split(",").map(_=>parseInt(_.trim())).filter(_=>!isNaN(_)).map(_=>{const d=H.value.find(O=>O.id===_);return d?d.name:""}).filter(_=>_).join("、"),ot=l=>{if(!l)return"";let e=l.name||"";if(l.account_no&&l.account_no.length>=4){const s=l.account_no.slice(-4);e+=` (${s})`}return e},nt=l=>!l||l.trim()===""?[]:l.split(";").map(e=>{const s=e.split(",");return{company_name:s[0]||"",organization:s[1]||""}}).filter(e=>e.company_name.trim()!==""||e.organization.trim()!==""),rt=l=>{const e=nt(l||"");return e.length===0?"":e.map(s=>s.company_name).join("、")},st=l=>{const e=l.raw;if(!["image/jpeg","image/jpg","image/png","image/bmp"].includes(e.type)){u.error("只支持 JPG、PNG、BMP 格式的图片");return}const _=5*1024*1024;if(e.size>_){u.error("图片大小不能超过 5MB");return}it(e)},it=async l=>{var e,s;K.value=!0,P.value=null;try{const _=await da(l);_.code===0&&_.data?(P.value=_.data,_.data.name&&(k.company_name=_.data.name),_.data.reg_num&&(k.organization=_.data.reg_num),u.success("营业执照识别成功，信息已自动填入")):u.error(_.message||"识别失败")}catch(_){console.error("OCR识别失败:",_),u.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"识别服务暂时不可用，请稍后重试")}finally{K.value=!1}};return Ct(()=>{w(),Ue(),ze(),Me()}),(l,e)=>{const s=Ut,_=xt,d=zt,O=Mt,de=Pt,G=Rt,V=Bt,ut=$t,dt=Tt,_t=At,x=St,Q=Yt,y=qt,E=Nt,ve=jt,pt=Lt,B=Ot,ge=Gt,ye=Jt,mt=ht,$=Ht,T=It,W=Kt,be=Zt,ft=Qt,ct=Wt,vt=Et;return m(),D("div",_a,[f("div",pa,[a(_,{onBack:Be,title:n.value.company_name||"用户详情"},{extra:t(()=>[f("div",ma,[b(C).operationManagerPrivate?(m(),v(s,{key:0,type:"success",onClick:$e},{default:t(()=>e[30]||(e[30]=[r("配置产品")])),_:1,__:[30]})):g("",!0),b(C).operationBasicPrivate?(m(),v(s,{key:1,type:"default",onClick:Se},{default:t(()=>e[31]||(e[31]=[r("添加被保险人")])),_:1,__:[31]})):g("",!0),b(C).operationBasicPrivate?(m(),v(s,{key:2,type:"default",onClick:Ye},{default:t(()=>e[32]||(e[32]=[r("添加保险公司")])),_:1,__:[32]})):g("",!0),n.value.status==="待初审"&&b(C).riskBasicPrivate?(m(),v(s,{key:3,type:"primary",onClick:qe},{default:t(()=>e[33]||(e[33]=[r("初审通过")])),_:1,__:[33]})):g("",!0),n.value.status==="待终审"&&b(C).riskManagerPrivate?(m(),v(s,{key:4,type:"warning",onClick:Ne},{default:t(()=>e[34]||(e[34]=[r("终审通过")])),_:1,__:[34]})):g("",!0),n.value.status==="审核通过"||n.value.status==="已停用"&&b(C).operationManagerPrivate?(m(),v(s,{key:5,type:"info",onClick:je},{default:t(()=>e[35]||(e[35]=[r("重置状态")])),_:1,__:[35]})):g("",!0),n.value.status==="审核通过"&&b(C).operationManagerPrivate?(m(),v(s,{key:6,type:"danger",onClick:Le},{default:t(()=>e[36]||(e[36]=[r("停用")])),_:1,__:[36]})):g("",!0),n.value.customer_id?g("",!0):(m(),v(s,{key:7,type:"warning",onClick:Oe},{default:t(()=>e[37]||(e[37]=[r("实名认证")])),_:1,__:[37]})),n.value.verify_url&&n.value.audit_status==="未认证"?(m(),v(s,{key:8,type:"success",onClick:Ge},{default:t(()=>e[38]||(e[38]=[r("继续认证")])),_:1,__:[38]})):g("",!0),n.value.verify_url?(m(),v(s,{key:9,type:"info",onClick:Je},{default:t(()=>e[39]||(e[39]=[r("复制认证链接")])),_:1,__:[39]})):g("",!0)])]),_:1},8,["title"])]),_e((m(),v(G,{class:"detail-card"},{default:t(()=>[a(de,{column:3,border:""},{default:t(()=>[a(d,{label:"企业名称",span:2},{default:t(()=>[r(i(n.value.company_name),1)]),_:1}),a(d,{label:"用户名"},{default:t(()=>[r(i(n.value.username),1)]),_:1}),a(d,{label:"用户状态"},{default:t(()=>[a(O,{type:tt(n.value.status)},{default:t(()=>[r(i(n.value.status),1)]),_:1},8,["type"])]),_:1}),a(d,{label:"认证状态"},{default:t(()=>[a(O,{type:ce(n.value.audit_status),size:"small"},{default:t(()=>[r(i(n.value.audit_status||"未认证"),1)]),_:1},8,["type"])]),_:1}),a(d,{label:"联系人"},{default:t(()=>[r(i(n.value.contact_name),1)]),_:1}),a(d,{label:"联系电话"},{default:t(()=>[r(i(n.value.contact_phone),1)]),_:1}),a(d,{label:"联系邮箱"},{default:t(()=>[r(i(n.value.contact_email),1)]),_:1}),a(d,{label:"创建时间"},{default:t(()=>[r(i(b(J)(n.value.created_at)),1)]),_:1}),a(d,{label:"备注",span:3},{default:t(()=>[r(i(n.value.remark||"无"),1)]),_:1}),a(d,{span:3,label:"关联保险公司"},{default:t(()=>[r(i(lt(n.value.insurer_ids)||"未设置"),1)]),_:1}),a(d,{span:3,label:"被保人"},{default:t(()=>[r(i(rt(n.value.insureds)||"未设置"),1)]),_:1})]),_:1})]),_:1})),[[vt,le.value]]),a(G,{class:"detail-card"},{default:t(()=>[a(ut,{data:n.value.configs||[],border:"",style:{width:"100%"},"empty-text":"暂无配置信息","max-height":"300"},{default:t(()=>[a(V,{prop:"product.name",label:"产品",width:"360"}),a(V,{prop:"agent.company_name",label:"渠道商",width:"220"},{default:t(({row:o})=>{var X;return[r(i(o.sell_mode==="直销"?"直销":((X=o.agent)==null?void 0:X.company_name)||"-"),1)]}),_:1}),a(V,{prop:"insurance_type",label:"险种",width:"90",align:"center"}),a(V,{prop:"seller",label:"销售员",width:"80",align:"center"}),a(V,{prop:"service_fee",label:"服务费",width:"80",align:"center"},{default:t(({row:o})=>[r(i(o.service_fee)+"% ",1)]),_:1}),a(V,{prop:"agent_cost",label:"渠道费",width:"80",align:"center"},{default:t(({row:o})=>[r(i(o.agent_cost)+"% ",1)]),_:1}),a(V,{prop:"overdue_date",label:"过期时间",width:"110",align:"center"}),a(V,{prop:"created_at",label:"创建时间",width:"180",align:"center"},{default:t(({row:o})=>[r(i(b(J)(o.created_at)),1)]),_:1}),a(V,{prop:"updated_at",label:"更新时间",width:"180",align:"center"},{default:t(({row:o})=>[r(i(b(J)(o.updated_at)),1)]),_:1}),b(C).operationManagerPrivate?(m(),v(V,{key:0,label:"操作",width:"150",fixed:"right",align:"center"},{default:t(({row:o})=>[a(s,{type:"primary",size:"small",onClick:X=>Te(o)},{default:t(()=>e[40]||(e[40]=[r("编辑")])),_:2,__:[40]},1032,["onClick"]),a(s,{type:"danger",size:"small",onClick:X=>Ae(o)},{default:t(()=>e[41]||(e[41]=[r("删除")])),_:2,__:[41]},1032,["onClick"])]),_:1})):g("",!0)]),_:1},8,["data"])]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(de,{column:3,border:""},{default:t(()=>[a(d,{label:"法大大客户ID"},{default:t(()=>[r(i(n.value.customer_id||"未生成"),1)]),_:1}),a(d,{label:"认证方式"},{default:t(()=>[r(i(n.value.verify_type||"未设置"),1)]),_:1}),a(d,{label:"统一社会信用代码"},{default:t(()=>[r(i(n.value.organization||"未填写"),1)]),_:1}),a(d,{label:"法人姓名"},{default:t(()=>[r(i(n.value.legal_name||"未填写"),1)]),_:1}),a(d,{label:"法人身份证号"},{default:t(()=>[r(i(n.value.legal||"未填写"),1)]),_:1}),a(d,{label:"法人手机号"},{default:t(()=>[r(i(n.value.legal_mobile||"未填写"),1)]),_:1}),a(d,{label:"企业邮箱"},{default:t(()=>[r(i(n.value.company_email||"未填写"),1)]),_:1}),a(d,{label:"组织类型"},{default:t(()=>[r(i(n.value.organization_type||"未设置"),1)]),_:1}),a(d,{label:"证件类型"},{default:t(()=>[r(i(n.value.certificates_type||"未设置"),1)]),_:1}),a(d,{label:"审核时间"},{default:t(()=>[r(i(n.value.auditor_time||"未审核"),1)]),_:1}),a(d,{label:"营业执照"},{default:t(()=>[n.value.organization_path?(m(),v(s,{key:0,type:"primary",onClick:e[0]||(e[0]=o=>Z(n.value.organization_path))},{default:t(()=>e[42]||(e[42]=[r("查看")])),_:1,__:[42]})):g("",!0)]),_:1}),a(d,{label:"企业信息登记表"},{default:t(()=>[n.value.reg_form_path?(m(),v(s,{key:0,type:"primary",onClick:e[1]||(e[1]=o=>Z(n.value.reg_form_path))},{default:t(()=>e[43]||(e[43]=[r("查看")])),_:1,__:[43]})):g("",!0)]),_:1})]),_:1})]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(de,{column:3,border:""},{default:t(()=>[a(d,{label:"管理员类型"},{default:t(()=>[r(i(n.value.manager_type||"-"),1)]),_:1}),a(d,{label:"姓名"},{default:t(()=>[r(i(n.value.manager_name||"-"),1)]),_:1}),a(d,{label:"身份证号"},{default:t(()=>[r(i(n.value.manager_id_card||"-"),1)]),_:1}),a(d,{label:"手机号"},{default:t(()=>[r(i(n.value.manager_mobile||"-"),1)]),_:1}),a(d,{label:"身份证正面"},{default:t(()=>[n.value.manager_head_photo_path?(m(),v(s,{key:0,type:"primary",onClick:e[2]||(e[2]=o=>Z(n.value.manager_head_photo_path))},{default:t(()=>e[44]||(e[44]=[r("查看")])),_:1,__:[44]})):g("",!0)]),_:1}),a(d,{label:"身份证反面"},{default:t(()=>[n.value.manager_background_path?(m(),v(s,{key:0,type:"primary",onClick:e[3]||(e[3]=o=>Z(n.value.manager_background_path))},{default:t(()=>e[45]||(e[45]=[r("查看")])),_:1,__:[45]})):g("",!0)]),_:1}),a(d,{label:"审核时间"},{default:t(()=>[r(i(n.value.manager_auditor_time||"未审核"),1)]),_:1}),a(d,{label:"审核状态"},{default:t(()=>[a(O,{type:ce(n.value.manager_audit_status)},{default:t(()=>[r(i(n.value.manager_audit_status||"未审核"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(_t,null,{default:t(()=>[(m(!0),D(ee,null,te(n.value.logs,o=>(m(),v(dt,{key:o.id,timestamp:b(J)(o.created_at),type:at(o.action)},{default:t(()=>[f("div",fa,[f("span",ca,i(o.admin_name),1),f("span",va,i(o.content),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})]),_:1}),a(T,{title:Ve.value,modelValue:F.value,"onUpdate:modelValue":e[13]||(e[13]=o=>F.value=o),width:"700px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",ga,[a(s,{onClick:e[12]||(e[12]=o=>F.value=!1)},{default:t(()=>e[50]||(e[50]=[r("取 消")])),_:1,__:[50]}),a(s,{type:"primary",onClick:We},{default:t(()=>[r(i(j.value?"更新":"确定"),1)]),_:1})])]),default:t(()=>[a($,{ref_key:"configFormRef",ref:re,model:p,rules:Ee,"label-width":"120px"},{default:t(()=>[a(ge,{gutter:20},{default:t(()=>[a(E,{span:24},{default:t(()=>[a(y,{label:"产品",prop:"product_id"},{default:t(()=>[a(Q,{modelValue:p.product_id,"onUpdate:modelValue":e[4]||(e[4]=o=>p.product_id=o),placeholder:"请选择产品",style:{width:"100%"},filterable:""},{default:t(()=>[(m(!0),D(ee,null,te(me.value,o=>(m(),v(x,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(E,{span:24},{default:t(()=>[a(y,{label:"销售模式",prop:"sell_mode"},{default:t(()=>[a(pt,{modelValue:p.sell_mode,"onUpdate:modelValue":e[5]||(e[5]=o=>p.sell_mode=o)},{default:t(()=>[a(ve,{value:"直销"},{default:t(()=>e[46]||(e[46]=[r("直销")])),_:1,__:[46]}),a(ve,{value:"渠道"},{default:t(()=>e[47]||(e[47]=[r("渠道")])),_:1,__:[47]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),_e(a(E,{span:24},{default:t(()=>[a(y,{label:"业务归属",prop:"agent_id"},{default:t(()=>[a(Q,{modelValue:p.agent_id,"onUpdate:modelValue":e[6]||(e[6]=o=>p.agent_id=o),placeholder:"请选择业务归属",style:{width:"100%"},filterable:"",onChange:Pe},{default:t(()=>[(m(!0),D(ee,null,te(oe.value,o=>(m(),v(x,{key:o.id,label:o.company_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},512),[[we,p.sell_mode==="渠道"]]),a(E,{span:12},{default:t(()=>[a(y,{label:"销售员",prop:"seller"},{default:t(()=>[a(B,{modelValue:p.seller,"onUpdate:modelValue":e[7]||(e[7]=o=>p.seller=o),placeholder:"请输入销售员姓名"},null,8,["modelValue"])]),_:1})]),_:1}),a(E,{span:12},{default:t(()=>[a(y,{label:"主要险种",prop:"insurance_type"},{default:t(()=>[a(Q,{modelValue:p.insurance_type,"onUpdate:modelValue":e[8]||(e[8]=o=>p.insurance_type=o),placeholder:"请选择主要险种",style:{width:"100%"}},{default:t(()=>[a(x,{label:"车险",value:"车险"}),a(x,{label:"货运险",value:"货运险"}),a(x,{label:"船舶险",value:"船舶险"}),a(x,{label:"财产险",value:"财产险"}),a(x,{label:"工程险",value:"工程险"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ge,{gutter:20},{default:t(()=>[a(E,{span:p.sell_mode==="直销"?24:12},{default:t(()=>[a(y,{label:"服务费",prop:"service_fee"},{default:t(()=>[a(ye,{modelValue:p.service_fee,"onUpdate:modelValue":e[9]||(e[9]=o=>p.service_fee=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:t(()=>e[48]||(e[48]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},8,["span"]),_e(a(E,{span:12},{default:t(()=>[a(y,{label:"渠道成本",prop:"agent_cost"},{default:t(()=>[a(ye,{modelValue:p.agent_cost,"onUpdate:modelValue":e[10]||(e[10]=o=>p.agent_cost=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:t(()=>e[49]||(e[49]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},512),[[we,p.sell_mode==="渠道"]])]),_:1}),a(y,{label:"过期时间",prop:"overdue_date"},{default:t(()=>[a(mt,{modelValue:p.overdue_date,"onUpdate:modelValue":e[11]||(e[11]=o=>p.overdue_date=o),type:"date",placeholder:"请选择过期时间",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),a(T,{title:"初审",modelValue:U.value,"onUpdate:modelValue":e[16]||(e[16]=o=>U.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",ba,[a(s,{onClick:e[15]||(e[15]=o=>U.value=!1)},{default:t(()=>e[52]||(e[52]=[r("取 消")])),_:1,__:[52]}),a(s,{type:"success",onClick:he},{default:t(()=>e[53]||(e[53]=[r("通过初审")])),_:1,__:[53]}),a(s,{type:"danger",onClick:He},{default:t(()=>e[54]||(e[54]=[r("打回修改")])),_:1,__:[54]})])]),default:t(()=>[f("div",ya,[a(W,{title:`当前状态：${n.value.status}`,type:"info",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[51]||(e[51]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 请审核用户的基本信息和认证资料，确认无误后可以通过初审进入终审阶段。 ",-1))]),a($,{ref_key:"initialReviewFormRef",ref:Ce,model:R,rules:ue,"label-width":"100px"},{default:t(()=>[a(y,{label:"审核备注",prop:"audit_note"},{default:t(()=>[a(B,{modelValue:R.audit_note,"onUpdate:modelValue":e[14]||(e[14]=o=>R.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(T,{title:"终审",modelValue:z.value,"onUpdate:modelValue":e[19]||(e[19]=o=>z.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",ka,[a(s,{onClick:e[18]||(e[18]=o=>z.value=!1)},{default:t(()=>e[56]||(e[56]=[r("取 消")])),_:1,__:[56]}),a(s,{type:"success",onClick:Ke},{default:t(()=>e[57]||(e[57]=[r("审核通过")])),_:1,__:[57]}),a(s,{type:"warning",onClick:Ze},{default:t(()=>e[58]||(e[58]=[r("退回初审")])),_:1,__:[58]})])]),default:t(()=>[f("div",wa,[a(W,{title:`当前状态：${n.value.status}`,type:"warning",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[55]||(e[55]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户已通过初审，请进行最终审核确认。通过后用户即可正常使用系统。 ",-1))]),a($,{ref_key:"finalReviewFormRef",ref:xe,model:I,rules:ue,"label-width":"100px"},{default:t(()=>[a(y,{label:"审核备注",prop:"audit_note"},{default:t(()=>[a(B,{modelValue:I.audit_note,"onUpdate:modelValue":e[17]||(e[17]=o=>I.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(T,{title:"重置用户状态",modelValue:Y.value,"onUpdate:modelValue":e[22]||(e[22]=o=>Y.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",Ca,[a(s,{onClick:e[21]||(e[21]=o=>Y.value=!1)},{default:t(()=>e[60]||(e[60]=[r("取 消")])),_:1,__:[60]}),a(s,{type:"danger",onClick:Qe},{default:t(()=>e[61]||(e[61]=[r("重置到待初审")])),_:1,__:[61]})])]),default:t(()=>[f("div",Va,[a(W,{title:`当前状态：${n.value.status}`,type:"success",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[59]||(e[59]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户当前已通过审核，如需重新审核可以将状态重置到初审阶段。 ",-1))]),a($,{ref_key:"resetStatusFormRef",ref:Re,model:M,rules:ue,"label-width":"100px"},{default:t(()=>[a(y,{label:"重置原因",prop:"audit_note"},{default:t(()=>[a(B,{modelValue:M.audit_note,"onUpdate:modelValue":e[20]||(e[20]=o=>M.audit_note=o),type:"textarea",rows:4,placeholder:"请输入重置原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(T,{title:"添加被保险人",modelValue:q.value,"onUpdate:modelValue":e[26]||(e[26]=o=>q.value=o),width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",Fa,[a(s,{onClick:e[25]||(e[25]=o=>q.value=!1)},{default:t(()=>e[68]||(e[68]=[r("取 消")])),_:1,__:[68]}),a(s,{type:"primary",onClick:Xe},{default:t(()=>e[69]||(e[69]=[r("确 定")])),_:1,__:[69]})])]),default:t(()=>[a($,{ref_key:"addInsuredFormRef",ref:se,model:k,rules:De,"label-width":"140px"},{default:t(()=>[a(y,{label:"营业执照识别"},{default:t(()=>[f("div",xa,[a(ft,{ref_key:"uploadRef",ref:Ie,"file-list":[],"auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":st,drag:""},{default:t(()=>[f("div",Ra,[a(be,{class:"upload-icon"},{default:t(()=>[a(b(Dt))]),_:1}),e[62]||(e[62]=f("div",{class:"upload-text"},"点击或拖拽上传营业执照图片",-1)),e[63]||(e[63]=f("div",{class:"upload-tip"},"支持 JPG、PNG、BMP 格式，文件大小不超过 5MB",-1))])]),_:1},512),K.value?(m(),D("div",Ia,[a(be,{class:"is-loading"},{default:t(()=>[a(b(Ft))]),_:1}),e[64]||(e[64]=f("span",null,"正在识别营业执照...",-1))])):g("",!0),P.value?(m(),D("div",Ea,[a(W,{title:"识别成功，信息已自动填入",type:"success",closable:!1,style:{"margin-bottom":"10px"}},{default:t(()=>[f("div",Da,[f("p",null,[e[65]||(e[65]=f("strong",null,"公司名称：",-1)),r(i(P.value.name||"未识别"),1)]),f("p",null,[e[66]||(e[66]=f("strong",null,"信用代码：",-1)),r(i(P.value.reg_num||"未识别"),1)])])]),_:1})])):g("",!0)])]),_:1}),a(ct,null,{default:t(()=>e[67]||(e[67]=[r("或手动输入")])),_:1,__:[67]}),a(y,{label:"公司名称",prop:"company_name"},{default:t(()=>[a(B,{modelValue:k.company_name,"onUpdate:modelValue":e[23]||(e[23]=o=>k.company_name=o),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),a(y,{label:"统一社会信用代码",prop:"organization"},{default:t(()=>[a(B,{modelValue:k.organization,"onUpdate:modelValue":e[24]||(e[24]=o=>k.organization=o),placeholder:"请输入统一社会信用代码（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(T,{title:"添加保险公司",modelValue:N.value,"onUpdate:modelValue":e[29]||(e[29]=o=>N.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",Ua,[a(s,{onClick:e[28]||(e[28]=o=>N.value=!1)},{default:t(()=>e[70]||(e[70]=[r("取 消")])),_:1,__:[70]}),a(s,{type:"primary",onClick:et},{default:t(()=>e[71]||(e[71]=[r("确 定")])),_:1,__:[71]})])]),default:t(()=>[a($,{ref_key:"addInsurerFormRef",ref:ie,model:L,rules:Fe,"label-width":"120px"},{default:t(()=>[a(y,{label:"保险公司",prop:"insurer_id"},{default:t(()=>[a(Q,{modelValue:L.insurer_id,"onUpdate:modelValue":e[27]||(e[27]=o=>L.insurer_id=o),placeholder:"请选择保险公司",style:{width:"100%"},filterable:""},{default:t(()=>[(m(!0),D(ee,null,te(H.value,o=>(m(),v(x,{key:o.id,label:ot(o),value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},tl=yt(za,[["__scopeId","data-v-b7361ee0"]]);export{tl as default};
