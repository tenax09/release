import{_ as be,b as he,u as we,a as ke}from"./index-49cf57c0.js";/* empty css               *//* empty css                 *//* empty css                         *//* empty css                        *//* empty css                     *//* empty css               *//* empty css                *//* empty css                             *//* empty css                   *//* empty css                       */import{f as E,a as v}from"./format-20468769.js";import{a as Ce,r as xe,b as Ee,d as $e,f as Me}from"./order-a8df91b6.js";import{m as Te}from"./receivable-622ceb2d.js";import{r as T,ae as Be,l as m,B as h,C as d,F as e,G as a,p as k,S as w,E as g,aE as Pe,ag as Se,ah as Ve,M as De,O as s,u as _,af as K,D as o,ac as Ie,av as Fe,aF as Ne,H as Re,I as ze,J as N,K as Ae,az as Oe,am as Ue,aA as Le,ao as qe,al as Ge,an as He,ap as Je,aq as Ke,ar as je,a5 as Qe,a6 as We,a7 as Xe,ai as Ye}from"./element-plus-f067b2d4.js";const Ze={class:"order-detail"},ea={class:"page-header"},aa={class:"header-actions"},ta={class:"overview-section"},la={class:"key-metrics"},na={class:"metric-item"},oa={class:"metric-value"},ra={class:"metric-item"},sa={class:"metric-value"},ia={class:"metric-item"},ua={class:"metric-value"},da={class:"metric-item"},ca={class:"metric-value"},_a={key:0,class:"empty-state"},pa={key:0,class:"empty-state"},ma={style:{color:"#67c23a","font-weight":"bold"}},fa={style:{color:"#e6a23c","font-weight":"bold"}},va={style:{color:"#409eff"}},ya={style:{color:"#67c23a"}},ga={key:0,style:{color:"#f56c6c"}},ba={key:1},ha={key:0,style:{color:"#f56c6c"}},wa={key:1},ka={key:0,style:{color:"#67c23a","font-weight":"bold"}},Ca={key:1},xa={key:0,style:{color:"#f56c6c","font-weight":"bold"}},Ea={key:1},$a={key:1,style:{color:"#67c23a"}},Ma={class:"log-content"},Ta={class:"operator"},Ba={class:"action"},Pa={key:1,class:"empty-logs"},Sa={class:"dialog-footer"},Va={class:"payment-info"},Da={key:1,class:"payment-section"},Ia={key:2,class:"payment-section"},Fa={key:3,class:"payment-section"},Na={class:"remark-content"},Ra={class:"dialog-footer"},za={__name:"detail",setup(Aa){const j=he(),R=we(),$=T(!1),n=T({}),B=ke(),P=T(!1),z=T(null),A=T(!1),S=T({remark:""}),I=T(!1),O=T(!1),p=T({}),Q={remark:[{required:!0,message:"请输入备注内容",trigger:"blur"}]},V=async()=>{$.value=!0;try{const r=await Ce(j.params.id);n.value=r.data,n.value.total_commercial=0,n.value.insurance_type==="车险"&&n.value.car_insurance&&n.value.car_insurance.length>0?n.value.total_commercial=n.value.car_insurance.reduce((t,u)=>t+(u.commercial_amount||0),0):n.value.insurance_type==="货运险"&&n.value.cargo_insurance&&n.value.cargo_insurance.length>0&&(n.value.total_commercial=n.value.cargo_insurance.reduce((t,u)=>t+(u.commercial_amount||0),0))}catch{g.error("获取订单详情失败")}$.value=!1},W=()=>{R.back()},F=async()=>{try{let r="",t="下一状态";n.value.status==="待初审"?(r="初审通过",t="待复审"):n.value.status==="待复审"&&(r="复审通过",t="待客户签约"),await N.confirm(`确定要将订单状态从 [${n.value.status}] 更新为 [${t}] 吗？`,"审核确认",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}),$.value=!0,await xe(n.value.id,{audit_note:r}),g.success("审核成功"),V()}catch(r){r!=="cancel"&&g.error("审核失败")}$.value=!1},X=r=>{const{columns:t,data:u}=r,f=[];return t.forEach((c,b)=>{if(b===0){f[b]="合计";return}if(c.property==="total_amount"){const y=u.reduce((x,M)=>x+(M.commercial_amount||0)+(M.compulsory_amount||0)+(M.vehicle_tax_amount||0),0);f[b]=v(y);return}const C=u.map(y=>Number(y[c.property]));if(C.every(y=>isNaN(y)))f[b]="-";else{const y=C.reduce((x,M)=>{const i=Number(M);return isNaN(i)?x:x+i},0);c.property==="commercial_amount"||c.property==="compulsory_amount"||c.property==="vehicle_tax_amount"?f[b]=v(y):f[b]="-"}}),f},Y=r=>{const{columns:t,data:u}=r,f=[];return t.forEach((c,b)=>{if(b===0){f[b]="合计";return}const C=u.map(y=>Number(y[c.property]));if(C.every(y=>isNaN(y)))f[b]="-";else{const y=C.reduce((x,M)=>{const i=Number(M);return isNaN(i)?x:x+i},0);c.property==="commercial_amount"?f[b]=v(y):f[b]="-"}}),f},Z=r=>({待审核:"warning",待复审:"warning",待客户签约:"info",待资方签约:"info",待放款:"warning",已放款:"success",已退保:"danger",已结清:"success",已作废:"danger"})[r]||"info",ee=r=>({create:"primary",update:"success",review:"warning",delete:"danger",info:"info"})[r]||"info",U=()=>{R.push(`/order/insurance/${n.value.id}`)},ae=(r,t)=>{R.push({path:`/order/attachments/${n.value.id}`,query:{ref_id:r||0,type:t||"order"}})},te=async()=>{try{await N.confirm("确定要作废该订单吗？作废后不可恢复！","作废确认",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}),$.value=!0,await Ee(n.value.id),g.success("订单已作废"),V()}catch(r){r!=="cancel"&&g.error("作废失败")}$.value=!1},L=(r,t)=>{if(!r){g.warning(`${t}链接不存在`);return}try{if(typeof window<"u"&&window.open)window.open(r,"_blank","noopener,noreferrer");else throw new Error("window.open不可用")}catch(u){console.error(`${t}失败:`,u);try{const f=document.createElement("a");f.href=r,f.target="_blank",f.rel="noopener noreferrer",f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),g.success(`${t}链接已打开`)}catch(f){console.error("备选方案失败:",f)}}},le=r=>{if(!r){g.warning("签署链接不存在");return}q(r,"签署链接")},q=(r,t)=>{const u=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);navigator.clipboard&&(window.isSecureContext||u)?navigator.clipboard.writeText(r).then(()=>{g.success(`${t}已复制到剪贴板`)}).catch(f=>{console.error("使用 Clipboard API 复制失败:",f),G(r,t)}):G(r,t)},G=(r,t)=>{try{const u=document.createElement("textarea");u.value=r,u.style.position="fixed",u.style.left="-999999px",u.style.top="-999999px",document.body.appendChild(u),u.focus(),u.select();const f=document.execCommand("copy");if(document.body.removeChild(u),f)g.success(`${t}已复制到剪贴板`);else throw new Error("execCommand 复制失败")}catch(u){console.error("复制失败:",u),N.alert(r,`请手动复制${t}`,{confirmButtonText:"确定",type:"info",customClass:"copy-url-dialog"})}},ne=r=>({已签署:"success",未签署:"warning",已作废:"danger"})[r]||"info",oe=r=>({首付:"primary",还款:"success",利息:"warning",本金:"info",退保:"danger"})[r]||"info",re=r=>({微信:"success",支付宝:"primary",银行卡:"warning"})[r]||"info",se=r=>({待收款:"warning",已收款:"success",已逾期:"danger"})[r]||"info",ie=async r=>{try{const{value:t}=await N.prompt(`请输入第${r.period}期的实际收款金额`,"标记收款",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\d+(\.\d{1,2})?$/,inputErrorMessage:"请输入正确的金额格式",inputValue:r.amount.toString()});if(!t){g.warning("请输入收款金额");return}$.value=!0,await Te(r.id,{actual_amount:parseFloat(t),actual_date:new Date().toISOString().split("T")[0]}),g.success("标记收款成功"),V()}catch(t){t!=="cancel"&&g.error("标记收款失败")}$.value=!1},ue=()=>{S.value.remark="",P.value=!0},de=async()=>{z.value&&await z.value.validate(async r=>{if(r){A.value=!0;try{await $e(n.value.id,{remark:S.value.remark}),g.success("添加备注成功"),P.value=!1,V()}catch(t){g.error("添加备注失败："+(t.message||"未知错误"))}A.value=!1}})},ce=async()=>{if(!n.value.id){g.warning("订单信息不存在");return}O.value=!0;try{const r=await Me(n.value.id);p.value=r.data,I.value=!0,g.success("前置款信息生成成功")}catch(r){g.error("生成前置款信息失败："+(r.message||"未知错误"))}O.value=!1},_e=()=>{if(!p.value.batch_no){g.warning("暂无前置款信息可复制");return}const r=`
批次号：${p.value.batch_no}
借款人：${p.value.borrower}
${p.value.vehicle_info}
总放款金额：${v(p.value.total_loan_amount)}

支付服务费：${v(p.value.service_fee)}
户名：${p.value.service_account_name}
账户：${p.value.service_account_no}
开户行：${p.value.service_bank_name}

支付首付款：${v(p.value.total_down_payment)}
${p.value.down_payment_detail}
户名：${p.value.funder_account_name}
账户：${p.value.funder_account_no}
开户行：${p.value.funder_bank_name}

${p.value.remark||""}
  `.trim();q(r,"前置款信息")};return Be(()=>{V()}),(r,t)=>{const u=Ae,f=Pe,c=Oe,b=Ue,C=Le,y=Se,x=qe,M=Ve,i=Ge,D=He,pe=Je,me=Ke,fe=je,ve=Qe,ye=We,ge=Xe,H=De,J=Ye;return m(),h("div",Ze,[d("div",ea,[e(f,{onBack:W,title:n.value.order_no||"订单详情"},{extra:a(()=>[d("div",aa,[e(u,{type:"default",onClick:U},{default:a(()=>t[6]||(t[6]=[s("管理投保单")])),_:1,__:[6]}),e(u,{type:"default",onClick:ue},{default:a(()=>t[7]||(t[7]=[s("添加备注")])),_:1,__:[7]}),n.value.status==="待初审"&&_(B).riskBasicPrivate?(m(),k(u,{key:0,type:"success",onClick:F},{default:a(()=>t[8]||(t[8]=[s("初审通过")])),_:1,__:[8]})):w("",!0),n.value.status==="待复审"&&_(B).riskManagerPrivate?(m(),k(u,{key:1,type:"warning",onClick:F},{default:a(()=>t[9]||(t[9]=[s("复审通过")])),_:1,__:[9]})):w("",!0),n.value.status==="待放款"&&_(B).operationManagerPrivate?(m(),k(u,{key:2,type:"warning",onClick:F},{default:a(()=>t[10]||(t[10]=[s("放款")])),_:1,__:[10]})):w("",!0),e(u,{type:"default",onClick:ce},{default:a(()=>t[11]||(t[11]=[s("生成前置款")])),_:1,__:[11]}),e(u,{type:"default",onClick:t[0]||(t[0]=l=>ae())},{default:a(()=>t[12]||(t[12]=[s("查看附件")])),_:1,__:[12]}),n.value.status!=="已作废"&&(_(B).operationManagerPrivate||_(B).riskManagerPrivate)?(m(),k(u,{key:3,type:"danger",onClick:te},{default:a(()=>t[13]||(t[13]=[s("作废订单")])),_:1,__:[13]})):w("",!0),_(B).superPrivate?(m(),k(u,{key:4,type:"primary",onClick:F},{default:a(()=>t[14]||(t[14]=[s("下一状态（调试用）")])),_:1,__:[14]})):w("",!0)])]),_:1},8,["title"])]),d("div",ta,[e(M,{gutter:20},{default:a(()=>[e(x,{span:18},{default:a(()=>[K((m(),k(y,{class:"info-card"},{default:a(()=>[e(C,{column:2,border:""},{default:a(()=>[e(c,{label:"订单编号"},{default:a(()=>[s(o(n.value.order_no),1)]),_:1}),e(c,{label:"订单状态"},{default:a(()=>[e(b,{type:Z(n.value.status)},{default:a(()=>[s(o(n.value.status),1)]),_:1},8,["type"])]),_:1}),e(c,{label:"保险类型"},{default:a(()=>[s(o(n.value.insurance_type),1)]),_:1}),e(c,{label:"借款主体"},{default:a(()=>{var l;return[s(o(n.value.loan_name||((l=n.value.user)==null?void 0:l.company_name)),1)]}),_:1}),e(c,{label:"业务归属"},{default:a(()=>{var l;return[s(o(n.value.sell_mode==="直销"?"直销":((l=n.value.agent)==null?void 0:l.company_name)||"无"),1)]}),_:1}),e(c,{label:"销售员"},{default:a(()=>[s(o(n.value.seller),1)]),_:1}),e(c,{label:"服务费"},{default:a(()=>[s(o(n.value.service_fee)+"%",1)]),_:1}),e(c,{label:"渠道成本"},{default:a(()=>[s(o(n.value.agent_cost)+"%",1)]),_:1}),e(c,{span:2,label:"金融产品"},{default:a(()=>{var l;return[s(o((l=n.value.product)==null?void 0:l.name),1)]}),_:1}),e(c,{label:"承保机构",span:2},{default:a(()=>{var l;return[s(o((l=n.value.insurer)==null?void 0:l.name),1)]}),_:1})]),_:1}),e(C,{column:2,border:""},{default:a(()=>[e(c,{label:"进件时间"},{default:a(()=>[s(o(_(E)(n.value.created_at)),1)]),_:1}),e(c,{label:"初审时间"},{default:a(()=>[s(o(_(E)(n.value.first_review_time)||"-"),1)]),_:1}),e(c,{label:"复审时间"},{default:a(()=>[s(o(_(E)(n.value.second_review_time)||"-"),1)]),_:1}),e(c,{label:"用户签约时间"},{default:a(()=>[s(o(_(E)(n.value.user_sign_time)||"-"),1)]),_:1}),e(c,{label:"资方签约时间"},{default:a(()=>[s(o(_(E)(n.value.funder_sign_time)||"-"),1)]),_:1}),e(c,{label:"放款时间"},{default:a(()=>[s(o(_(E)(n.value.loan_time)||"-"),1)]),_:1}),e(c,{label:"最后更新时间"},{default:a(()=>[s(o(_(E)(n.value.updated_at)),1)]),_:1})]),_:1})]),_:1})),[[J,$.value]])]),_:1}),e(x,{span:6},{default:a(()=>[e(y,{class:"key-metrics-card"},{default:a(()=>[d("div",la,[d("div",na,[t[15]||(t[15]=d("div",{class:"metric-label"},"总保费",-1)),d("div",oa,o(_(v)(n.value.total_premium)),1)]),d("div",ra,[t[16]||(t[16]=d("div",{class:"metric-label"},"商业险",-1)),d("div",sa,o(_(v)(n.value.total_commercial)),1)]),d("div",ia,[t[17]||(t[17]=d("div",{class:"metric-label"},"首付金额",-1)),d("div",ua,o(_(v)(n.value.down_payment)),1)]),d("div",da,[t[18]||(t[18]=d("div",{class:"metric-label"},"贷款金额",-1)),d("div",ca,o(_(v)(n.value.loan_amount)),1)])])]),_:1})]),_:1})]),_:1})]),n.value.insurance_type==="车险"?(m(),k(y,{key:0,class:"detail-card insurance-card"},{default:a(()=>[e(D,{data:n.value.car_insurance||[],border:"",style:{width:"100%"},"empty-text":"暂无车险投保信息","max-height":"300","show-summary":n.value.car_insurance&&n.value.car_insurance.length>0,"sum-text":"合计","summary-method":X},{default:a(()=>[e(i,{prop:"car_no",label:"车牌号",width:"120",align:"left"}),e(i,{prop:"vin",label:"车架号",width:"180",align:"left"}),e(i,{prop:"insured",label:"被保人",width:"170",align:"left"}),e(i,{prop:"commercial_amount",label:"商业险",width:"110",align:"right"},{default:a(({row:l})=>[s(o(_(v)(l.commercial_amount)),1)]),_:1}),e(i,{prop:"compulsory_amount",label:"交强险",width:"110",align:"right"},{default:a(({row:l})=>[s(o(_(v)(l.compulsory_amount)),1)]),_:1}),e(i,{prop:"vehicle_tax_amount",label:"车船税",width:"110",align:"right"},{default:a(({row:l})=>[s(o(_(v)(l.vehicle_tax_amount)),1)]),_:1}),e(i,{prop:"total_amount",label:"总保费",width:"110",align:"right"},{default:a(({row:l})=>[s(o(_(v)((l.commercial_amount||0)+(l.compulsory_amount||0)+(l.vehicle_tax_amount||0))),1)]),_:1}),e(i,{prop:"start_date",label:"保险起期",width:"100",align:"center"}),e(i,{prop:"end_date",label:"保险止期",width:"100",align:"center"})]),_:1},8,["data","show-summary"]),!n.value.car_insurance||n.value.car_insurance.length===0?(m(),h("div",_a,[e(u,{type:"primary",onClick:U},{default:a(()=>t[19]||(t[19]=[s("录入车险信息")])),_:1,__:[19]})])):w("",!0)]),_:1})):w("",!0),n.value.insurance_type==="货运险"?(m(),k(y,{key:1,class:"detail-card insurance-card"},{default:a(()=>[e(D,{data:n.value.cargo_insurance||[],border:"",style:{width:"100%"},"empty-text":"暂无货运险投保信息","max-height":"300","show-summary":n.value.cargo_insurance&&n.value.cargo_insurance.length>0,"sum-text":"合计","summary-method":Y},{default:a(()=>[e(i,{prop:"track_no",label:"运输编号",width:"200",align:"left"}),e(i,{prop:"insured",label:"被保人",width:"170",align:"left"}),e(i,{prop:"name",label:"货物名称",width:"150",align:"left"}),e(i,{prop:"quantity",label:"货物数量",width:"120",align:"right"}),e(i,{prop:"carrier",label:"承运人",width:"130",align:"left"}),e(i,{prop:"consignee",label:"收货人",width:"130",align:"left"}),e(i,{prop:"commercial_amount",label:"保费",width:"140",align:"right"},{default:a(({row:l})=>[s(o(_(v)(l.commercial_amount)),1)]),_:1}),e(i,{prop:"start_date",label:"保险起期",width:"100",align:"center"}),e(i,{prop:"end_date",label:"保险止期",width:"100",align:"center"})]),_:1},8,["data","show-summary"]),!n.value.cargo_insurance||n.value.cargo_insurance.length===0?(m(),h("div",pa,[e(u,{type:"primary",onClick:U},{default:a(()=>t[20]||(t[20]=[s("录入货运险信息")])),_:1,__:[20]})])):w("",!0)]),_:1})):w("",!0),e(y,{class:"detail-card"},{default:a(()=>[e(D,{data:n.value.contacts||[],border:"",style:{width:"100%"},"empty-text":"暂无合同信息","max-height":"200"},{default:a(()=>[e(i,{prop:"contact_id",label:"合同编号",width:"250"}),e(i,{prop:"sign_status",label:"签署状态",width:"120",align:"center"},{default:a(({row:l})=>[e(b,{type:ne(l.sign_status)},{default:a(()=>[s(o(l.sign_status),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"sign_time",label:"签署时间",width:"170",align:"center"},{default:a(({row:l})=>[s(o(l.sign_time||"-"),1)]),_:1}),e(i,{prop:"created_at",label:"创建时间",width:"170",align:"center"},{default:a(({row:l})=>[s(o(_(E)(l.created_at)),1)]),_:1}),e(i,{label:"操作",width:"300",align:"center",fixed:"right"},{default:a(({row:l})=>[e(u,{type:"primary",size:"small",icon:_(Ie),onClick:()=>L(l.view_pdf_url,"查看PDF"),disabled:!l.view_pdf_url,class:"action-btn"},{default:a(()=>t[21]||(t[21]=[s(" 查看 ")])),_:2,__:[21]},1032,["icon","onClick","disabled"]),e(u,{type:"success",size:"small",icon:_(Fe),onClick:()=>L(l.download_url,"下载PDF"),disabled:!l.download_url,class:"action-btn"},{default:a(()=>t[22]||(t[22]=[s(" 下载 ")])),_:2,__:[22]},1032,["icon","onClick","disabled"]),e(u,{type:"info",size:"small",icon:_(Ne),onClick:()=>le(l.sign_url),disabled:!l.sign_url,class:"action-btn"},{default:a(()=>t[23]||(t[23]=[s(" 签署链接 ")])),_:2,__:[23]},1032,["icon","onClick","disabled"])]),_:1})]),_:1},8,["data"])]),_:1}),e(y,{class:"detail-card"},{default:a(()=>[e(D,{data:n.value.receiveds||[],border:"",style:{width:"100%"},"empty-text":"暂无收款记录","max-height":"200"},{default:a(()=>[e(i,{prop:"trans_no",label:"收款流水号",width:"250"}),e(i,{prop:"rec_type",label:"收款类型",width:"100"},{default:a(({row:l})=>[e(b,{type:oe(l.rec_type)},{default:a(()=>[s(o(l.rec_type),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"amount",label:"收款金额",width:"120"},{default:a(({row:l})=>[d("span",ma,o(_(v)(l.amount)),1)]),_:1}),e(i,{prop:"period",label:"期数",width:"80"},{default:a(({row:l})=>[s(o(l.period||"-"),1)]),_:1}),e(i,{prop:"method",label:"收款方式",width:"100"},{default:a(({row:l})=>[e(b,{type:re(l.method),size:"small"},{default:a(()=>[s(o(l.method),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"date_time",label:"收款时间",width:"160"}),e(i,{prop:"created_at",label:"录入时间",width:"160"},{default:a(({row:l})=>[s(o(_(E)(l.created_at)),1)]),_:1}),e(i,{prop:"remark",label:"备注","min-width":"120"},{default:a(({row:l})=>[s(o(l.remark||"-"),1)]),_:1})]),_:1},8,["data"])]),_:1}),e(y,{class:"detail-card"},{default:a(()=>[e(D,{data:n.value.receivables||[],border:"",style:{width:"100%"},"empty-text":"暂无还款计划","max-height":"200"},{default:a(()=>[e(i,{prop:"period",label:"期数",width:"80",align:"center"}),e(i,{prop:"date",label:"应还日期",width:"120",align:"center"}),e(i,{prop:"amount",label:"应还金额",width:"120",align:"right"},{default:a(({row:l})=>[d("span",fa,o(_(v)(l.amount)),1)]),_:1}),e(i,{prop:"principal_amount",label:"本金",width:"120",align:"right"},{default:a(({row:l})=>[d("span",va,o(_(v)(l.principal_amount)),1)]),_:1}),e(i,{prop:"interest_amount",label:"利息",width:"120",align:"right"},{default:a(({row:l})=>[d("span",ya,o(_(v)(l.interest_amount)),1)]),_:1}),e(i,{prop:"penalty_amount",label:"违约金",width:"100",align:"right"},{default:a(({row:l})=>[l.penalty_amount>0?(m(),h("span",ga,o(_(v)(l.penalty_amount)),1)):(m(),h("span",ba,"-"))]),_:1}),e(i,{prop:"forfeit_amount",label:"滞纳金",width:"100",align:"right"},{default:a(({row:l})=>[l.forfeit_amount>0?(m(),h("span",ha,o(_(v)(l.forfeit_amount)),1)):(m(),h("span",wa,"-"))]),_:1}),e(i,{prop:"actual_amount",label:"实际收款",width:"120",align:"right"},{default:a(({row:l})=>[l.actual_amount>0?(m(),h("span",ka,o(_(v)(l.actual_amount)),1)):(m(),h("span",Ca,"-"))]),_:1}),e(i,{prop:"actual_date",label:"实际收款日期",width:"120",align:"center"},{default:a(({row:l})=>[s(o(l.actual_date||"-"),1)]),_:1}),e(i,{prop:"overdue_days",label:"逾期天数",width:"100",align:"center"},{default:a(({row:l})=>[l.overdue_days>0?(m(),h("span",xa,o(l.overdue_days)+"天",1)):(m(),h("span",Ea,"-"))]),_:1}),e(i,{prop:"status",label:"状态",width:"100",align:"center"},{default:a(({row:l})=>[e(b,{type:se(l.status)},{default:a(()=>[s(o(l.status),1)]),_:2},1032,["type"])]),_:1}),e(i,{label:"操作",width:"120",align:"center",fixed:"right"},{default:a(({row:l})=>[l.status==="待收款"||l.status==="已逾期"?(m(),k(u,{key:0,type:"primary",size:"small",onClick:Oa=>ie(l)},{default:a(()=>t[24]||(t[24]=[s(" 标记收款 ")])),_:2,__:[24]},1032,["onClick"])):(m(),h("span",$a,"已收款"))]),_:1})]),_:1},8,["data"])]),_:1}),e(y,{class:"detail-card"},{default:a(()=>[n.value.logs&&n.value.logs.length>0?(m(),k(me,{key:0},{default:a(()=>[(m(!0),h(Re,null,ze(n.value.logs,l=>(m(),k(pe,{key:l.id,timestamp:_(E)(l.created_at),type:ee(l.action)},{default:a(()=>[d("div",Ma,[d("span",Ta,o(l.admin_name),1),d("span",Ba,o(l.content),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})):(m(),h("div",Pa,[e(fe,{description:"暂无操作日志","image-size":80})]))]),_:1}),e(H,{modelValue:P.value,"onUpdate:modelValue":t[3]||(t[3]=l=>P.value=l),title:"添加备注",width:"500px"},{footer:a(()=>[d("span",Sa,[e(u,{onClick:t[2]||(t[2]=l=>P.value=!1)},{default:a(()=>t[25]||(t[25]=[s("取消")])),_:1,__:[25]}),e(u,{type:"primary",onClick:de,loading:A.value},{default:a(()=>t[26]||(t[26]=[s("确定")])),_:1,__:[26]},8,["loading"])])]),default:a(()=>[e(ge,{ref_key:"remarkFormRef",ref:z,model:S.value,rules:Q,"label-width":"80px"},{default:a(()=>[e(ye,{label:"备注内容",prop:"remark"},{default:a(()=>[e(ve,{modelValue:S.value.remark,"onUpdate:modelValue":t[1]||(t[1]=l=>S.value.remark=l),type:"textarea",rows:4,placeholder:"请输入备注内容",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),t[27]||(t[27]=d("div",{style:{"margin-top":"10px","text-align":"right"}},"添加的备注将显示在日志列表里",-1))]),_:1,__:[27]},8,["modelValue"]),e(H,{modelValue:I.value,"onUpdate:modelValue":t[5]||(t[5]=l=>I.value=l),title:"前置款信息",width:"600px","close-on-click-modal":!1},{footer:a(()=>[d("span",Ra,[e(u,{onClick:t[4]||(t[4]=l=>I.value=!1)},{default:a(()=>t[28]||(t[28]=[s("关闭")])),_:1,__:[28]}),e(u,{type:"primary",onClick:_e},{default:a(()=>t[29]||(t[29]=[s("复制信息")])),_:1,__:[29]})])]),default:a(()=>[K((m(),h("div",Va,[p.value.batch_no?(m(),k(C,{key:0,column:1,border:"",size:"small"},{default:a(()=>[e(c,{label:"批次号"},{default:a(()=>[d("span",null,o(p.value.batch_no),1)]),_:1}),e(c,{label:"借款人"},{default:a(()=>[d("span",null,o(p.value.borrower),1)]),_:1}),e(c,{label:"车辆信息"},{default:a(()=>[d("span",null,o(p.value.vehicle_info),1)]),_:1}),e(c,{label:"总保费"},{default:a(()=>[d("span",null,o(_(v)(p.value.total_premium)),1)]),_:1})]),_:1})):w("",!0),p.value.service_fee?(m(),h("div",Da,[e(C,{column:1,border:"",size:"small"},{default:a(()=>[e(c,{label:"支付服务费"},{default:a(()=>[d("span",null,o(_(v)(p.value.service_fee)),1)]),_:1}),e(c,{label:"收款户名"},{default:a(()=>[d("span",null,o(p.value.service_account_name),1)]),_:1}),e(c,{label:"收款账户"},{default:a(()=>[d("span",null,o(p.value.service_account_no),1)]),_:1}),e(c,{label:"开户行"},{default:a(()=>[d("span",null,o(p.value.service_bank_name),1)]),_:1})]),_:1})])):w("",!0),p.value.total_down_payment?(m(),h("div",Ia,[e(C,{column:1,border:"",size:"small"},{default:a(()=>[e(c,{label:"支付首付款"},{default:a(()=>[d("span",null,o(_(v)(p.value.total_down_payment)),1)]),_:1}),e(c,{label:"明细"},{default:a(()=>[d("span",null,o(p.value.down_payment_detail),1)]),_:1}),e(c,{label:"收款户名"},{default:a(()=>[d("span",null,o(p.value.funder_account_name),1)]),_:1}),e(c,{label:"收款账户"},{default:a(()=>[d("span",null,o(p.value.funder_account_no),1)]),_:1}),e(c,{label:"开户行"},{default:a(()=>[d("span",null,o(p.value.funder_bank_name),1)]),_:1})]),_:1})])):w("",!0),p.value.remark?(m(),h("div",Fa,[d("div",Na,o(p.value.remark),1)])):w("",!0)])),[[J,O.value]])]),_:1},8,["modelValue"])])}}},tt=be(za,[["__scopeId","data-v-e6b5d9e3"]]);export{tt as default};
