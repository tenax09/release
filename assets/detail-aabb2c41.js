import{_ as j,u as q,b as G}from"./index-49cf57c0.js";/* empty css               *//* empty css                         *//* empty css                *//* empty css                             *//* empty css                   *//* empty css                       */import{a as J,v as K,u as x}from"./agent-ebdd6eed.js";import{f as E}from"./format-20468769.js";import{u as O}from"./uuid2url-5d83da04.js";import{r as D,ae as Q,l as c,B,C as m,F as l,G as a,af as W,p as d,E as i,aE as X,ag as Y,ai as Z,O as n,S as p,D as s,u as T,H as ee,I as ae,J as g,K as te,az as le,am as re,aA as ne,ap as oe,aq as se}from"./element-plus-f067b2d4.js";const ue={class:"agent-detail"},ie={class:"page-header"},ce={class:"header-actions"},de={class:"log-content"},_e={class:"operator"},pe={class:"action"},me={__name:"detail",setup(fe){const A=q(),M=G(),b=D(!1),e=D({}),f=async()=>{b.value=!0;try{const r=await J(M.params.id);e.value=r.data}catch(r){console.error("获取渠道详情失败:",r),i.error("获取渠道详情失败")}b.value=!1},I=()=>{A.back()},V=()=>{g.confirm("确认要为该渠道添加认证吗？","提示",{type:"warning"}).then(async()=>{try{await K(e.value.id),i.success("添加认证成功"),f()}catch(r){console.error("添加认证失败:",r),i.error("添加认证失败")}})},z=()=>{if(!e.value.verify_url){i.error("认证链接不存在");return}try{if(typeof window<"u"&&window.open)window.open(e.value.verify_url,"_blank");else{const r=document.createElement("a");r.href=e.value.verify_url,r.target="_blank",r.rel="noopener noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}catch(r){console.error("打开认证链接失败:",r),i.error("无法打开认证链接，请手动复制链接访问")}},L=()=>{if(!e.value.verify_url){i.error("认证链接不存在");return}navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e.value.verify_url).then(()=>{i.success("认证链接已复制到剪贴板")}).catch(r=>{console.error("使用 Clipboard API 复制失败:",r),h(e.value.verify_url)}):h(e.value.verify_url)},h=r=>{try{const t=document.createElement("textarea");t.value=r,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();const u=document.execCommand("copy");if(document.body.removeChild(t),u)i.success("认证链接已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(t){console.error("复制失败:",t),g.alert(e.value.verify_url,"请手动复制认证链接",{confirmButtonText:"确定",type:"info"})}},S=r=>({启用:"success",禁用:"info"})[r]||"info",C=r=>({未认证:"info",管理员资料已提交:"warning",企业基本资料已提交:"warning",已提交待审核:"warning",审核通过:"success",审核不通过:"danger",人工初审通过:"primary"})[r]||"info",N=r=>({create:"primary",update:"success",review:"warning",delete:"danger",audit_pass:"success",audit_reject:"danger",audit_pending:"warning"})[r]||"info",v=r=>{O(r).then(t=>{try{if(typeof window<"u"&&window.open)window.open(t,"_blank");else{const u=document.createElement("a");u.href=t,u.target="_blank",u.rel="noopener noreferrer",document.body.appendChild(u),u.click(),document.body.removeChild(u)}}catch(u){console.error("打开文件失败:",u),i.error("无法打开文件")}}).catch(t=>{console.error("获取文件URL失败:",t),i.error("获取文件URL失败")})},R=()=>{g.confirm("确认要禁用该渠道吗？禁用后渠道将无法正常使用系统。","警告",{type:"warning"}).then(async()=>{try{const r={username:e.value.username,company_name:e.value.company_name,contact_name:e.value.contact_name,contact_phone:e.value.contact_phone,contact_email:e.value.contact_email,seller:e.value.seller,status:"禁用",remark:e.value.remark};await x(e.value.id,r),i.success("渠道已禁用"),f()}catch(r){console.error("禁用渠道失败:",r),i.error("禁用渠道失败")}})},U=()=>{g.confirm("确认要启用该渠道吗？","提示",{type:"warning"}).then(async()=>{try{const r={username:e.value.username,company_name:e.value.company_name,contact_name:e.value.contact_name,contact_phone:e.value.contact_phone,contact_email:e.value.contact_email,seller:e.value.seller,status:"启用",remark:e.value.remark};await x(e.value.id,r),i.success("渠道已启用"),f()}catch(r){console.error("启用渠道失败:",r),i.error("启用渠道失败")}})};return Q(()=>{f()}),(r,t)=>{const u=te,$=X,o=le,k=re,w=ne,y=Y,F=oe,H=se,P=Z;return c(),B("div",ue,[m("div",ie,[l($,{onBack:I,title:e.value.company_name||"渠道详情"},{extra:a(()=>[m("div",ce,[e.value.customer_id?p("",!0):(c(),d(u,{key:0,type:"warning",onClick:V},{default:a(()=>t[4]||(t[4]=[n("实名认证")])),_:1,__:[4]})),e.value.verify_url&&e.value.audit_status==="未认证"?(c(),d(u,{key:1,type:"success",onClick:z},{default:a(()=>t[5]||(t[5]=[n("继续认证")])),_:1,__:[5]})):p("",!0),e.value.verify_url?(c(),d(u,{key:2,type:"info",onClick:L},{default:a(()=>t[6]||(t[6]=[n("复制认证链接")])),_:1,__:[6]})):p("",!0),e.value.status==="启用"?(c(),d(u,{key:3,type:"danger",onClick:R},{default:a(()=>t[7]||(t[7]=[n("禁用")])),_:1,__:[7]})):p("",!0),e.value.status==="禁用"?(c(),d(u,{key:4,type:"success",onClick:U},{default:a(()=>t[8]||(t[8]=[n("启用")])),_:1,__:[8]})):p("",!0)])]),_:1},8,["title"])]),W((c(),d(y,{class:"detail-card"},{default:a(()=>[l(w,{column:3,border:""},{default:a(()=>[l(o,{label:"用户名"},{default:a(()=>[n(s(e.value.username),1)]),_:1}),l(o,{label:"状态"},{default:a(()=>[l(k,{type:S(e.value.status)},{default:a(()=>[n(s(e.value.status),1)]),_:1},8,["type"])]),_:1}),l(o,{label:"企业名称",span:2},{default:a(()=>[n(s(e.value.company_name),1)]),_:1}),l(o,{label:"认证状态"},{default:a(()=>[l(k,{type:C(e.value.audit_status),size:"small"},{default:a(()=>[n(s(e.value.audit_status||"未认证"),1)]),_:1},8,["type"])]),_:1}),l(o,{label:"联系人"},{default:a(()=>[n(s(e.value.contact_name),1)]),_:1}),l(o,{label:"联系电话"},{default:a(()=>[n(s(e.value.contact_phone),1)]),_:1}),l(o,{label:"联系邮箱"},{default:a(()=>[n(s(e.value.contact_email),1)]),_:1}),l(o,{label:"销售员"},{default:a(()=>[n(s(e.value.seller),1)]),_:1}),l(o,{label:"创建时间"},{default:a(()=>[n(s(T(E)(e.value.created_at)),1)]),_:1}),l(o,{label:"备注",span:3},{default:a(()=>[n(s(e.value.remark||"无"),1)]),_:1})]),_:1})]),_:1})),[[P,b.value]]),l(y,{class:"detail-card"},{default:a(()=>[l(w,{column:3,border:""},{default:a(()=>[l(o,{label:"法大大客户ID"},{default:a(()=>[n(s(e.value.customer_id||"未生成"),1)]),_:1}),l(o,{label:"认证方式"},{default:a(()=>[n(s(e.value.verify_type||"未设置"),1)]),_:1}),l(o,{label:"统一社会信用代码"},{default:a(()=>[n(s(e.value.organization||"未填写"),1)]),_:1}),l(o,{label:"法人姓名"},{default:a(()=>[n(s(e.value.legal_name||"未填写"),1)]),_:1}),l(o,{label:"法人身份证号"},{default:a(()=>[n(s(e.value.legal||"未填写"),1)]),_:1}),l(o,{label:"法人手机号"},{default:a(()=>[n(s(e.value.legal_mobile||"未填写"),1)]),_:1}),l(o,{label:"企业邮箱"},{default:a(()=>[n(s(e.value.company_email||"未填写"),1)]),_:1}),l(o,{label:"组织类型"},{default:a(()=>[n(s(e.value.organization_type||"未设置"),1)]),_:1}),l(o,{label:"证件类型"},{default:a(()=>[n(s(e.value.certificates_type||"未设置"),1)]),_:1}),l(o,{label:"审核时间"},{default:a(()=>[n(s(e.value.auditor_time||"未审核"),1)]),_:1}),l(o,{label:"营业执照"},{default:a(()=>[e.value.organization_path?(c(),d(u,{key:0,type:"primary",onClick:t[0]||(t[0]=_=>v(e.value.organization_path))},{default:a(()=>t[9]||(t[9]=[n("查看")])),_:1,__:[9]})):p("",!0)]),_:1}),l(o,{label:"企业信息登记表"},{default:a(()=>[e.value.reg_form_path?(c(),d(u,{key:0,type:"primary",onClick:t[1]||(t[1]=_=>v(e.value.reg_form_path))},{default:a(()=>t[10]||(t[10]=[n("查看")])),_:1,__:[10]})):p("",!0)]),_:1})]),_:1})]),_:1}),l(y,{class:"detail-card"},{default:a(()=>[l(w,{column:3,border:""},{default:a(()=>[l(o,{label:"管理员类型"},{default:a(()=>[n(s(e.value.manager_type||"-"),1)]),_:1}),l(o,{label:"姓名"},{default:a(()=>[n(s(e.value.manager_name||"-"),1)]),_:1}),l(o,{label:"身份证号"},{default:a(()=>[n(s(e.value.manager_id_card||"-"),1)]),_:1}),l(o,{label:"手机号"},{default:a(()=>[n(s(e.value.manager_mobile||"-"),1)]),_:1}),l(o,{label:"身份证正面"},{default:a(()=>[e.value.manager_head_photo_path?(c(),d(u,{key:0,type:"primary",onClick:t[2]||(t[2]=_=>v(e.value.manager_head_photo_path))},{default:a(()=>t[11]||(t[11]=[n("查看")])),_:1,__:[11]})):p("",!0)]),_:1}),l(o,{label:"身份证反面"},{default:a(()=>[e.value.manager_background_path?(c(),d(u,{key:0,type:"primary",onClick:t[3]||(t[3]=_=>v(e.value.manager_background_path))},{default:a(()=>t[12]||(t[12]=[n("查看")])),_:1,__:[12]})):p("",!0)]),_:1}),l(o,{label:"审核时间"},{default:a(()=>[n(s(e.value.manager_auditor_time||"未审核"),1)]),_:1}),l(o,{label:"审核状态"},{default:a(()=>[l(k,{type:C(e.value.manager_audit_status)},{default:a(()=>[n(s(e.value.manager_audit_status||"未审核"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),l(y,{class:"detail-card"},{default:a(()=>[l(H,null,{default:a(()=>[(c(!0),B(ee,null,ae(e.value.logs,_=>(c(),d(F,{key:_.id,timestamp:T(E)(_.created_at),type:N(_.action)},{default:a(()=>[m("div",de,[m("span",_e,s(_.admin_name),1),m("span",pe,s(_.content),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})]),_:1})])}}},Be=j(me,[["__scopeId","data-v-3e304990"]]);export{Be as default};
