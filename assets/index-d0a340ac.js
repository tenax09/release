import{_ as Y,u as Z,a as ee}from"./index-78e7e5a9.js";/* empty css               *//* empty css                      *//* empty css                  *//* empty css                     *//* empty css                        */import{b as te,r as p,ae,l as v,B as le,C as y,F as t,G as l,a1 as K,af as oe,p as V,E as m,a5 as ne,ay as re,K as ie,an as se,aK as de,ai as pe,u as f,aV as ue,Q as ce,aL as _e,O as s,D as u,S as A,J as me,a2 as fe,ax as ge,al as ve,am as ye}from"./element-plus-e0a6c12c.js";import{g as be,d as he}from"./received-3e9f263c.js";import{f as xe}from"./format-20468769.js";import{A as ke,a as we}from"./AttachmentUpload-bcc19096.js";/* empty css                 *//* empty css                   *//* empty css                    */const Ce={class:"received-container"},Ve={class:"filter-container"},Se={style:{color:"#67c23a","font-weight":"bold"}},Ee={class:"pagination"},Ue={__name:"index",setup(ze){const N=Z(),P=ee(),n=te({page:1,pageSize:10,trans_no:"",order_no:"",rec_type:"",method:""}),S=p([]),E=p(0),b=p(!1),h=p(!1),x=p(null),k=p(!1),g=p(null),c=async()=>{b.value=!0;try{const o=await be(n);S.value=o.data.list,E.value=o.data.total}catch(o){console.error("获取收款记录列表失败:",o),m.error("获取收款记录列表失败")}b.value=!1},w=()=>{n.page=1,c()},R=o=>{o.order_id?N.push(`/order/detail/${o.order_id}`):m.warning("该收款记录未关联订单")};function I(o){x.value=o,h.value=!0}function O(o){g.value=o,k.value=!0}function F(){m.success("附件上传成功")}const G=o=>{me.confirm("确认要删除该收款记录吗？","警告",{type:"warning"}).then(async()=>{try{await he(o.id),m.success("删除成功"),c()}catch(a){console.error("删除收款记录失败:",a),m.error("删除失败")}})},Q=o=>{n.pageSize=o,c()},j=o=>{n.page=o,c()},q=o=>({首付:"primary",还款:"success",利息:"warning",本金:"info",退保:"danger"})[o]||"info",J=o=>({微信:"success",支付宝:"primary",银行卡:"warning"})[o]||"info";return ae(()=>{c()}),(o,a)=>{var D,M,B,L,$;const C=fe,U=ne,d=ge,z=re,_=ie,r=ve,T=ye,H=se,W=de,X=pe;return v(),le("div",Ce,[y("div",Ve,[t(U,{modelValue:n.trans_no,"onUpdate:modelValue":a[0]||(a[0]=e=>n.trans_no=e),placeholder:"流水号",style:{width:"200px"},class:"filter-item",onKeyup:K(w,["enter","native"])},{prefix:l(()=>[t(C,null,{default:l(()=>[t(f(ue))]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:n.order_no,"onUpdate:modelValue":a[1]||(a[1]=e=>n.order_no=e),placeholder:"订单号",style:{width:"200px"},class:"filter-item",onKeyup:K(w,["enter","native"])},{prefix:l(()=>[t(C,null,{default:l(()=>[t(f(ce))]),_:1})]),_:1},8,["modelValue"]),t(z,{modelValue:n.rec_type,"onUpdate:modelValue":a[2]||(a[2]=e=>n.rec_type=e),placeholder:"收款类型",clearable:"",class:"filter-item",style:{width:"120px"}},{default:l(()=>[t(d,{label:"首付",value:"首付"}),t(d,{label:"还款",value:"还款"}),t(d,{label:"利息",value:"利息"}),t(d,{label:"本金",value:"本金"}),t(d,{label:"退保",value:"退保"})]),_:1},8,["modelValue"]),t(z,{modelValue:n.method,"onUpdate:modelValue":a[3]||(a[3]=e=>n.method=e),placeholder:"收款方式",clearable:"",class:"filter-item",style:{width:"120px"}},{default:l(()=>[t(d,{label:"微信",value:"微信"}),t(d,{label:"支付宝",value:"支付宝"}),t(d,{label:"银行卡",value:"银行卡"})]),_:1},8,["modelValue"]),t(_,{class:"filter-item",type:"primary",onClick:w},{default:l(()=>[t(C,null,{default:l(()=>[t(f(_e))]),_:1}),a[8]||(a[8]=s(" 搜索 "))]),_:1,__:[8]})]),oe((v(),V(H,{data:S.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:l(()=>[t(r,{prop:"trans_no",label:"流水号",width:"200"}),t(r,{prop:"order_no",label:"订单号",width:"200"},{default:l(({row:e})=>[t(_,{type:"primary",link:"",onClick:i=>R(e),disabled:!e.order_id},{default:l(()=>[s(u(e.order_no),1)]),_:2},1032,["onClick","disabled"])]),_:1}),t(r,{prop:"user.company_name",label:"借款人",width:"250"},{default:l(({row:e})=>{var i;return[y("span",null,u(((i=e.user)==null?void 0:i.company_name)||"-"),1)]}),_:1}),t(r,{prop:"amount",label:"金额",width:"120",align:"center"},{default:l(({row:e})=>{var i;return[y("span",Se,"¥"+u((i=e.amount)==null?void 0:i.toFixed(2)),1)]}),_:1}),t(r,{prop:"rec_type",label:"收款类型",width:"100",align:"center"},{default:l(({row:e})=>[t(T,{type:q(e.rec_type)},{default:l(()=>[s(u(e.rec_type),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"method",label:"收款方式",width:"100",align:"center"},{default:l(({row:e})=>[t(T,{type:J(e.method)},{default:l(()=>[s(u(e.method),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"date_time",label:"收款时间",width:"180"},{default:l(({row:e})=>[s(u(e.date_time||"--"),1)]),_:1}),t(r,{prop:"created_at",label:"创建时间",width:"180"},{default:l(({row:e})=>[s(u(f(xe)(e.created_at)||"--"),1)]),_:1}),t(r,{prop:"remark",label:"备注","min-width":"300"}),t(r,{label:"操作",width:"240",fixed:"right"},{default:l(({row:e})=>[e.id?(v(),V(_,{key:0,type:"info",link:"",onClick:i=>I(e)},{default:l(()=>a[9]||(a[9]=[s(" 查看附件 ")])),_:2,__:[9]},1032,["onClick"])):A("",!0),t(_,{type:"primary",link:"",onClick:i=>O(e)},{default:l(()=>a[10]||(a[10]=[s(" 上传附件 ")])),_:2,__:[10]},1032,["onClick"]),f(P).operationManagerPrivate?(v(),V(_,{key:1,type:"danger",link:"",onClick:i=>G(e)},{default:l(()=>a[11]||(a[11]=[s("删除")])),_:2,__:[11]},1032,["onClick"])):A("",!0)]),_:1})]),_:1},8,["data"])),[[X,b.value]]),y("div",Ee,[t(W,{"current-page":n.page,"onUpdate:currentPage":a[4]||(a[4]=e=>n.page=e),"page-size":n.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>n.pageSize=e),"page-sizes":[10,20,50,100],total:E.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Q,onCurrentChange:j},null,8,["current-page","page-size","total"])]),t(ke,{visible:h.value,"onUpdate:visible":a[6]||(a[6]=e=>h.value=e),title:"查看附件","order-id":((D=x.value)==null?void 0:D.order_id)||0,"ref-id":((M=x.value)==null?void 0:M.id)||0,type:"received","allow-delete":!0},null,8,["visible","order-id","ref-id"]),t(we,{visible:k.value,"onUpdate:visible":a[7]||(a[7]=e=>k.value=e),title:`上传附件 - ${((B=g.value)==null?void 0:B.trans_no)||""}`,"order-id":((L=g.value)==null?void 0:L.order_id)||0,"ref-id":(($=g.value)==null?void 0:$.id)||0,type:"received",onSuccess:F},null,8,["visible","title","order-id","ref-id"])])}}},Fe=Y(Ue,[["__scopeId","data-v-2f2a2dc3"]]);export{Fe as default};
