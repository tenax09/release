import{_ as Y,u as Z,a as ee}from"./index-778cf4f8.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                        *//* empty css                    */import{b as te,r as d,ae,l as v,B as le,C,F as t,G as o,a1 as A,af as oe,p as V,E as m,a5 as ne,ay as re,K as ie,an as se,aK as de,ai as pe,u as f,aV as ue,Q as ce,aL as _e,O as i,D as u,S as K,J as me,a2 as fe,ax as ge,al as ve,am as ye}from"./element-plus-b8725afa.js";import{g as be,d as he}from"./received-f1436739.js";import{f as xe}from"./format-20468769.js";import{A as ke}from"./AttachmentUpload-e20a8e18.js";import{A as we}from"./AttachmentList-bde5d145.js";/* empty css                   *//* empty css                    *//* empty css                 */const Ce={class:"received-container"},Ve={class:"filter-container"},Se={style:{color:"#67c23a","font-weight":"bold"}},Ee={class:"pagination"},Ue={__name:"index",setup(ze){const N=Z(),P=ee(),n=te({page:1,pageSize:10,trans_no:"",order_no:"",rec_type:"",method:""}),S=d([]),E=d(0),y=d(!1),b=d(!1),h=d(null),x=d(!1),g=d(null),c=async()=>{y.value=!0;try{const l=await be(n);S.value=l.data.list,E.value=l.data.total}catch(l){console.error("获取收款记录列表失败:",l),m.error("获取收款记录列表失败")}y.value=!1},k=()=>{n.page=1,c()},R=l=>{l.order_id?N.push(`/order/detail/${l.order_id}`):m.warning("该收款记录未关联订单")};function I(l){h.value=l,b.value=!0}function O(l){g.value=l,x.value=!0}function F(){m.success("附件上传成功")}const G=l=>{me.confirm("确认要删除该收款记录吗？","警告",{type:"warning"}).then(async()=>{try{await he(l.id),m.success("删除成功"),c()}catch(a){console.error("删除收款记录失败:",a),m.error("删除失败")}})},Q=l=>{n.pageSize=l,c()},j=l=>{n.page=l,c()},q=l=>({首付:"primary",还款:"success",利息:"warning",本金:"info",退保:"danger"})[l]||"info",J=l=>({微信:"success",支付宝:"primary",银行卡:"warning"})[l]||"info";return ae(()=>{c()}),(l,a)=>{var D,M,B,L,$;const w=fe,U=ne,s=ge,z=re,_=ie,r=ve,T=ye,H=se,W=de,X=pe;return v(),le("div",Ce,[C("div",Ve,[t(U,{modelValue:n.trans_no,"onUpdate:modelValue":a[0]||(a[0]=e=>n.trans_no=e),placeholder:"流水号",style:{width:"200px"},class:"filter-item",onKeyup:A(k,["enter","native"])},{prefix:o(()=>[t(w,null,{default:o(()=>[t(f(ue))]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:n.order_no,"onUpdate:modelValue":a[1]||(a[1]=e=>n.order_no=e),placeholder:"订单号",style:{width:"200px"},class:"filter-item",onKeyup:A(k,["enter","native"])},{prefix:o(()=>[t(w,null,{default:o(()=>[t(f(ce))]),_:1})]),_:1},8,["modelValue"]),t(z,{modelValue:n.rec_type,"onUpdate:modelValue":a[2]||(a[2]=e=>n.rec_type=e),placeholder:"收款类型",clearable:"",class:"filter-item",style:{width:"120px"}},{default:o(()=>[t(s,{label:"首付",value:"首付"}),t(s,{label:"还款",value:"还款"}),t(s,{label:"利息",value:"利息"}),t(s,{label:"本金",value:"本金"}),t(s,{label:"退保",value:"退保"})]),_:1},8,["modelValue"]),t(z,{modelValue:n.method,"onUpdate:modelValue":a[3]||(a[3]=e=>n.method=e),placeholder:"收款方式",clearable:"",class:"filter-item",style:{width:"120px"}},{default:o(()=>[t(s,{label:"微信",value:"微信"}),t(s,{label:"支付宝",value:"支付宝"}),t(s,{label:"银行卡",value:"银行卡"})]),_:1},8,["modelValue"]),t(_,{class:"filter-item",type:"primary",onClick:k},{default:o(()=>[t(w,null,{default:o(()=>[t(f(_e))]),_:1}),a[8]||(a[8]=i(" 搜索 "))]),_:1,__:[8]})]),oe((v(),V(H,{data:S.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:o(()=>[t(r,{prop:"trans_no",label:"流水号",width:"200"}),t(r,{prop:"order_no",label:"订单号",width:"200"},{default:o(({row:e})=>[t(_,{type:"primary",link:"",onClick:p=>R(e),disabled:!e.order_id},{default:o(()=>[i(u(e.order_no),1)]),_:2},1032,["onClick","disabled"])]),_:1}),t(r,{prop:"user_name",label:"借款人",width:"250"}),t(r,{prop:"amount",label:"金额",width:"120",align:"center"},{default:o(({row:e})=>{var p;return[C("span",Se,"¥"+u((p=e.amount)==null?void 0:p.toFixed(2)),1)]}),_:1}),t(r,{prop:"rec_type",label:"收款类型",width:"100",align:"center"},{default:o(({row:e})=>[t(T,{type:q(e.rec_type)},{default:o(()=>[i(u(e.rec_type),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"method",label:"收款方式",width:"100",align:"center"},{default:o(({row:e})=>[t(T,{type:J(e.method)},{default:o(()=>[i(u(e.method),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"date_time",label:"收款时间",width:"180"},{default:o(({row:e})=>[i(u(e.date_time||"--"),1)]),_:1}),t(r,{prop:"created_at",label:"创建时间",width:"180"},{default:o(({row:e})=>[i(u(f(xe)(e.created_at)||"--"),1)]),_:1}),t(r,{prop:"remark",label:"备注","min-width":"300"}),t(r,{label:"操作",width:"240",fixed:"right"},{default:o(({row:e})=>[e.id?(v(),V(_,{key:0,type:"info",link:"",onClick:p=>I(e)},{default:o(()=>a[9]||(a[9]=[i(" 查看附件 ")])),_:2,__:[9]},1032,["onClick"])):K("",!0),t(_,{type:"primary",link:"",onClick:p=>O(e)},{default:o(()=>a[10]||(a[10]=[i(" 上传附件 ")])),_:2,__:[10]},1032,["onClick"]),f(P).operationManagerPrivate?(v(),V(_,{key:1,type:"danger",link:"",onClick:p=>G(e)},{default:o(()=>a[11]||(a[11]=[i("删除")])),_:2,__:[11]},1032,["onClick"])):K("",!0)]),_:1})]),_:1},8,["data"])),[[X,y.value]]),C("div",Ee,[t(W,{"current-page":n.page,"onUpdate:currentPage":a[4]||(a[4]=e=>n.page=e),"page-size":n.pageSize,"onUpdate:pageSize":a[5]||(a[5]=e=>n.pageSize=e),"page-sizes":[10,20,50,100],total:E.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Q,onCurrentChange:j},null,8,["current-page","page-size","total"])]),t(we,{visible:b.value,"onUpdate:visible":a[6]||(a[6]=e=>b.value=e),title:"查看附件","order-id":((D=h.value)==null?void 0:D.order_id)||0,"ref-id":((M=h.value)==null?void 0:M.id)||0,type:"received","allow-delete":!0},null,8,["visible","order-id","ref-id"]),t(ke,{visible:x.value,"onUpdate:visible":a[7]||(a[7]=e=>x.value=e),title:`上传附件 - ${((B=g.value)==null?void 0:B.trans_no)||""}`,"order-id":((L=g.value)==null?void 0:L.order_id)||0,"ref-id":(($=g.value)==null?void 0:$.id)||0,type:"received",onSuccess:F},null,8,["visible","title","order-id","ref-id"])])}}},je=Y(Ue,[["__scopeId","data-v-d48b3f48"]]);export{je as default};
