import{r as fa,_ as ca,u as va,b as ga,a as ya}from"./index-565bf4a8.js";/* empty css                   *//* empty css                   *//* empty css                    *//* empty css                 *//* empty css                       *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                       *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                    *//* empty css                *//* empty css                             *//* empty css                       */import{r as c,j as ba,b as S,ae as wa,l as m,B as A,C as f,F as a,G as t,af as ie,p as v,E as u,aE as ka,ag as Va,M as Ca,ai as xa,u as b,O as r,S as g,D as i,H as de,I as pe,aQ as ke,aw as Ra,aR as Ia,J as Z,K as Da,az as Ea,am as Fa,aA as Ua,al as za,an as Ma,ax as Pa,ay as Ba,a6 as $a,ao as Sa,aS as Aa,aT as Ta,a5 as Na,ah as Ya,aG as qa,aH as La,a7 as ja,aB as Oa,a2 as Ga,aC as Ha,aD as Ja}from"./element-plus-b8725afa.js";import{a as Ka,b as Qa,r as T,v as ha,e as Wa,f as Xa,h as Za,i as et}from"./user-043a88cf.js";import{g as at}from"./agent-870bb391.js";import{g as tt}from"./product-25c30a23.js";import{g as lt}from"./insurer-b38c0419.js";import{f as ee}from"./format-20468769.js";import{L as ot}from"./LogList-b2ee5057.js";/* empty css                      *//* empty css                 *//* empty css                         */import"./log-e1adffa7.js";function nt(_e){const H=new FormData;return H.append("image",_e),fa({url:"/api/admin/ocr/biz-license",method:"post",data:H,headers:{"Content-Type":"multipart/form-data"}})}const rt={class:"user-detail"},st={class:"page-header"},ut={class:"header-actions"},it={class:"dialog-footer"},dt={class:"review-content"},pt={class:"dialog-footer"},_t={class:"review-content"},mt={class:"dialog-footer"},ft={class:"review-content"},ct={class:"dialog-footer"},vt={class:"upload-section"},gt={class:"upload-area"},yt={key:0,class:"ocr-loading"},bt={key:1,class:"ocr-result"},wt={class:"result-content"},kt={class:"dialog-footer"},Vt={class:"dialog-footer"},Ct={__name:"detail",setup(_e){const H=va(),me=ga(),C=ya(),ae=c(!1),n=c({}),te=c([]),fe=c([]),J=c([]),E=c(!1),F=c(!1),U=c(!1),N=c(!1),Y=c(!1),q=c(!1),L=c(!1),le=c(null),Ve=ba(()=>L.value?"编辑用户配置":"添加用户配置"),oe=c(),Ce=c(),xe=c(),Re=c(),ne=c(),re=c(),_=S({product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0}),R=S({audit_note:""}),I=S({audit_note:""}),z=S({audit_note:""}),k=S({company_name:"",organization:""}),j=S({insurer_id:void 0}),K=c(!1),M=c(null),Ie=c(),De={product_id:[{required:!0,message:"请选择产品",trigger:"change"}],sell_mode:[{required:!0,message:"请选择销售模式",trigger:"change"}],agent_id:[{required:!1,message:"请选择渠道商",trigger:"change"}],seller:[{required:!1,message:"请输入销售员姓名",trigger:"blur"}],insurance_type:[{required:!1,message:"请选择主要险种",trigger:"change"}],overdue_date:[{required:!1,message:"请选择过期时间",trigger:"change"}]},se={audit_note:[{required:!1,message:"请输入审核备注",trigger:"blur"}]},Ee={company_name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],organization:[{required:!1,message:"请输入统一社会信用代码",trigger:"blur"}]},Fe={insurer_id:[{required:!0,message:"请选择保险公司",trigger:"change"}]},w=async()=>{ae.value=!0;try{const l=await Ka(me.params.id);n.value=l.data}catch(l){console.error("获取用户详情失败:",l),u.error("获取用户详情失败")}ae.value=!1},Ue=async()=>{try{const l=await at({page:1,page_size:1e3});te.value=l.data.list}catch(l){console.error("获取渠道商列表失败:",l)}},ze=async()=>{try{const l=await tt({page:1,page_size:1e3});fe.value=l.data.list}catch(l){console.error("获取产品列表失败:",l)}},Me=async()=>{try{const l=await lt({page:1,page_size:1e3});J.value=l.data.list}catch(l){console.error("获取保险公司列表失败:",l)}},Pe=l=>{if(!l){_.seller="";return}const e=te.value.find(s=>s.id===l);e&&(_.seller=e.seller||e.contact_name||e.company_name||"")},Be=()=>{H.back()},$e=()=>{L.value=!1,le.value=null,E.value=!0,Object.assign(_,{product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0})},Se=l=>{L.value=!0,le.value=l.id,Object.assign(_,{product_id:l.product_id,sell_mode:l.sell_mode,agent_id:l.agent_id||void 0,seller:l.seller||"",insurance_type:l.insurance_type||"",agent_cost:l.agent_cost||void 0,service_fee:l.service_fee||void 0,overdue_date:l.overdue_date?new Date(l.overdue_date):void 0}),E.value=!0},Ae=l=>{Z.confirm("确认要删除该配置吗？","提示",{type:"warning"}).then(async()=>{try{await Qa(l.id),u.success("删除配置成功"),w()}catch(e){console.error("删除配置失败:",e),u.error("删除配置失败")}})},Te=()=>{Y.value=!0,k.company_name="",k.organization="",K.value=!1,M.value=null},Ne=()=>{q.value=!0,j.insurer_id=void 0},Ye=()=>{F.value=!0,R.audit_note=""},qe=()=>{U.value=!0,I.audit_note=""},Le=()=>{N.value=!0,z.audit_note=""},je=()=>{Z.confirm("确认要停用该用户吗？","提示",{type:"warning"}).then(async()=>{await T(n.value.id,{status:"已停用"}),u.success("用户已停用"),w()})},Oe=()=>{Z.confirm("确认要为该用户添加认证吗？","提示",{type:"warning"}).then(async()=>{try{await ha(n.value.id),u.success("添加认证成功"),w()}catch(l){console.error("添加认证失败:",l),u.error("添加认证失败")}})},Ge=()=>{if(!n.value.verify_url){u.error("认证链接不存在");return}try{if(typeof window<"u"&&window.open)window.open(n.value.verify_url,"_blank");else{const l=document.createElement("a");l.href=n.value.verify_url,l.target="_blank",l.rel="noopener noreferrer",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}catch(l){console.error("打开认证链接失败:",l),u.error("无法打开认证链接，请手动复制链接访问")}},He=()=>{if(!n.value.verify_url){u.error("认证链接不存在");return}navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(n.value.verify_url).then(()=>{u.success("认证链接已复制到剪贴板")}).catch(l=>{console.error("使用 Clipboard API 复制失败:",l),ce(n.value.verify_url)}):ce(n.value.verify_url)},ce=l=>{try{const e=document.createElement("textarea");e.value=l,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");if(document.body.removeChild(e),s)u.success("认证链接已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(e){console.error("复制失败:",e),Z.alert(n.value.verify_url,"请手动复制认证链接",{confirmButtonText:"确定",type:"info"})}},Je=async()=>{try{await T(n.value.id,{status:"待终审",audit_note:R.audit_note||"初审通过"}),u.success("初审通过，用户进入终审阶段"),F.value=!1,w()}catch(l){console.error("初审操作失败:",l),u.error("初审操作失败")}},Ke=async()=>{if(!R.audit_note.trim()){u.warning("打回修改时必须填写原因");return}try{await T(n.value.id,{status:"待初审",audit_note:R.audit_note}),u.success("已打回修改"),F.value=!1,w()}catch(l){console.error("初审操作失败:",l),u.error("初审操作失败")}},Qe=async()=>{try{await T(n.value.id,{status:"审核通过",audit_note:I.audit_note||"终审通过"}),u.success("审核通过，用户可正常使用系统"),U.value=!1,w()}catch(l){console.error("终审操作失败:",l),u.error("终审操作失败")}},he=async()=>{if(!I.audit_note.trim()){u.warning("退回初审时必须填写原因");return}try{await T(n.value.id,{status:"待初审",audit_note:I.audit_note}),u.success("已退回初审"),U.value=!1,w()}catch(l){console.error("终审操作失败:",l),u.error("终审操作失败")}},We=async()=>{if(!z.audit_note.trim()){u.warning("重置状态时必须填写原因");return}try{await T(n.value.id,{status:"待初审",audit_note:z.audit_note}),u.success("状态已重置为待初审"),N.value=!1,w()}catch(l){console.error("重置状态失败:",l),u.error("重置状态失败")}},Q=l=>{window.open(`/api/admin/fadada/download-url?uuid=${l}`,"_blank")},Xe=async()=>{oe.value&&await oe.value.validate(async l=>{if(l)try{const e={..._,overdue_date:_.overdue_date?ee(_.overdue_date,"YYYY-MM-DD"):null};_.sell_mode==="直销"&&(e.agent_id=null,e.agent_cost=0),L.value?(await Wa(le.value,e),u.success("配置更新成功")):(await Xa(n.value.id,e),u.success("配置添加成功")),E.value=!1,w()}catch(e){console.error("配置操作失败:",e),u.error("配置操作失败")}})},Ze=async()=>{ne.value&&await ne.value.validate(async l=>{var e,s;if(l)try{await Za(n.value.id,{company_name:k.company_name,organization:k.organization}),u.success("添加被保险人成功"),Y.value=!1,w()}catch(p){console.error("添加被保险人失败:",p),u.error(((s=(e=p.response)==null?void 0:e.data)==null?void 0:s.message)||"添加被保险人失败")}})},ea=async()=>{re.value&&await re.value.validate(async l=>{var e,s;if(l)try{await et(n.value.id,{insurer_id:j.insurer_id}),u.success("添加保险公司成功"),q.value=!1,w()}catch(p){console.error("添加保险公司失败:",p),u.error(((s=(e=p.response)==null?void 0:e.data)==null?void 0:s.message)||"添加保险公司失败")}})},aa=l=>({待初审:"warning",待终审:"primary",审核通过:"success",已停用:"info"})[l]||"info",ve=l=>({未认证:"info",管理员资料已提交:"warning",企业基本资料已提交:"warning",已提交待审核:"warning","审核通过（认证完成）":"success",审核不通过:"danger",人工初审通过:"primary"})[l]||"info",ta=l=>!l||!J.value.length?"":l.split(",").map(p=>parseInt(p.trim())).filter(p=>!isNaN(p)).map(p=>{const d=J.value.find(O=>O.id===p);return d?d.name:""}).filter(p=>p).join("、"),la=l=>{if(!l)return"";let e=l.name||"";if(l.account_no&&l.account_no.length>=4){const s=l.account_no.slice(-4);e+=` (${s})`}return e},oa=l=>!l||l.trim()===""?[]:l.split(";").map(e=>{const s=e.split(",");return{company_name:s[0]||"",organization:s[1]||""}}).filter(e=>e.company_name.trim()!==""||e.organization.trim()!==""),na=l=>{const e=oa(l||"");return e.length===0?"":e.map(s=>s.company_name).join("、")},ra=l=>{const e=l.raw;if(!["image/jpeg","image/jpg","image/png","image/bmp"].includes(e.type)){u.error("只支持 JPG、PNG、BMP 格式的图片");return}const p=5*1024*1024;if(e.size>p){u.error("图片大小不能超过 5MB");return}sa(e)},sa=async l=>{var e,s;K.value=!0,M.value=null;try{const p=await nt(l);p.code===0&&p.data?(M.value=p.data,p.data.name&&(k.company_name=p.data.name),p.data.reg_num&&(k.organization=p.data.reg_num),u.success("营业执照识别成功，信息已自动填入")):u.error(p.message||"识别失败")}catch(p){console.error("OCR识别失败:",p),u.error(((s=(e=p.response)==null?void 0:e.data)==null?void 0:s.message)||"识别服务暂时不可用，请稍后重试")}finally{K.value=!1}};return wa(()=>{w(),Ue(),ze(),Me()}),(l,e)=>{const s=Da,p=ka,d=Ea,O=Fa,ue=Ua,G=Va,V=za,ua=Ma,x=Pa,h=Ba,y=$a,D=Sa,ge=Aa,ia=Ta,P=Na,ye=Ya,be=qa,da=La,B=ja,$=Ca,W=Oa,we=Ga,pa=Ha,_a=Ja,ma=xa;return m(),A("div",rt,[f("div",st,[a(p,{onBack:Be,title:n.value.company_name||"用户详情"},{extra:t(()=>[f("div",ut,[b(C).operationManagerPrivate?(m(),v(s,{key:0,type:"success",onClick:$e},{default:t(()=>e[30]||(e[30]=[r("配置产品")])),_:1,__:[30]})):g("",!0),b(C).operationBasicPrivate?(m(),v(s,{key:1,type:"default",onClick:Te},{default:t(()=>e[31]||(e[31]=[r("添加被保险人")])),_:1,__:[31]})):g("",!0),b(C).operationBasicPrivate?(m(),v(s,{key:2,type:"default",onClick:Ne},{default:t(()=>e[32]||(e[32]=[r("添加保险公司")])),_:1,__:[32]})):g("",!0),n.value.status==="待初审"&&b(C).riskBasicPrivate?(m(),v(s,{key:3,type:"primary",onClick:Ye},{default:t(()=>e[33]||(e[33]=[r("初审通过")])),_:1,__:[33]})):g("",!0),n.value.status==="待终审"&&b(C).riskManagerPrivate?(m(),v(s,{key:4,type:"warning",onClick:qe},{default:t(()=>e[34]||(e[34]=[r("终审通过")])),_:1,__:[34]})):g("",!0),n.value.status==="审核通过"||n.value.status==="已停用"&&b(C).operationManagerPrivate?(m(),v(s,{key:5,type:"info",onClick:Le},{default:t(()=>e[35]||(e[35]=[r("重置状态")])),_:1,__:[35]})):g("",!0),n.value.status==="审核通过"&&b(C).operationManagerPrivate?(m(),v(s,{key:6,type:"danger",onClick:je},{default:t(()=>e[36]||(e[36]=[r("停用")])),_:1,__:[36]})):g("",!0),n.value.customer_id?g("",!0):(m(),v(s,{key:7,type:"warning",onClick:Oe},{default:t(()=>e[37]||(e[37]=[r("实名认证")])),_:1,__:[37]})),n.value.verify_url&&n.value.audit_status==="未认证"?(m(),v(s,{key:8,type:"success",onClick:Ge},{default:t(()=>e[38]||(e[38]=[r("继续认证")])),_:1,__:[38]})):g("",!0),n.value.verify_url?(m(),v(s,{key:9,type:"info",onClick:He},{default:t(()=>e[39]||(e[39]=[r("复制认证链接")])),_:1,__:[39]})):g("",!0)])]),_:1},8,["title"])]),ie((m(),v(G,{class:"detail-card"},{default:t(()=>[a(ue,{column:3,border:""},{default:t(()=>[a(d,{label:"企业名称",span:2},{default:t(()=>[r(i(n.value.company_name),1)]),_:1}),a(d,{label:"用户名"},{default:t(()=>[r(i(n.value.username),1)]),_:1}),a(d,{label:"用户状态"},{default:t(()=>[a(O,{type:aa(n.value.status)},{default:t(()=>[r(i(n.value.status),1)]),_:1},8,["type"])]),_:1}),a(d,{label:"认证状态"},{default:t(()=>[a(O,{type:ve(n.value.audit_status),size:"small"},{default:t(()=>[r(i(n.value.audit_status||"未认证"),1)]),_:1},8,["type"])]),_:1}),a(d,{label:"联系人"},{default:t(()=>[r(i(n.value.contact_name),1)]),_:1}),a(d,{label:"联系电话"},{default:t(()=>[r(i(n.value.contact_phone),1)]),_:1}),a(d,{label:"联系邮箱"},{default:t(()=>[r(i(n.value.contact_email),1)]),_:1}),a(d,{label:"创建时间"},{default:t(()=>[r(i(b(ee)(n.value.created_at)),1)]),_:1}),a(d,{label:"备注",span:3},{default:t(()=>[r(i(n.value.remark||"无"),1)]),_:1}),a(d,{span:3,label:"关联保险公司"},{default:t(()=>[r(i(ta(n.value.insurer_ids)||"未设置"),1)]),_:1}),a(d,{span:3,label:"被保人"},{default:t(()=>[r(i(na(n.value.insureds)||"未设置"),1)]),_:1})]),_:1})]),_:1})),[[ma,ae.value]]),a(G,{class:"detail-card"},{default:t(()=>[a(ua,{data:n.value.configs||[],border:"",style:{width:"100%"},"empty-text":"暂无配置信息","max-height":"300"},{default:t(()=>[a(V,{prop:"product.name",label:"产品",width:"360"}),a(V,{prop:"agent.company_name",label:"渠道商",width:"220"},{default:t(({row:o})=>{var X;return[r(i(o.sell_mode==="直销"?"直销":((X=o.agent)==null?void 0:X.company_name)||"-"),1)]}),_:1}),a(V,{prop:"insurance_type",label:"险种",width:"90",align:"center"}),a(V,{prop:"seller",label:"销售员",width:"80",align:"center"}),a(V,{prop:"service_fee",label:"服务费",width:"80",align:"center"},{default:t(({row:o})=>[r(i(o.service_fee)+"% ",1)]),_:1}),a(V,{prop:"agent_cost",label:"渠道费",width:"80",align:"center"},{default:t(({row:o})=>[r(i(o.agent_cost)+"% ",1)]),_:1}),a(V,{prop:"overdue_date",label:"过期时间",width:"110",align:"center"}),a(V,{prop:"created_at",label:"创建时间",width:"180",align:"center"},{default:t(({row:o})=>[r(i(b(ee)(o.created_at)),1)]),_:1}),a(V,{prop:"updated_at",label:"更新时间",width:"180",align:"center"},{default:t(({row:o})=>[r(i(b(ee)(o.updated_at)),1)]),_:1}),b(C).operationManagerPrivate?(m(),v(V,{key:0,label:"操作",width:"150",fixed:"right",align:"center"},{default:t(({row:o})=>[a(s,{type:"primary",size:"small",onClick:X=>Se(o)},{default:t(()=>e[40]||(e[40]=[r("编辑")])),_:2,__:[40]},1032,["onClick"]),a(s,{type:"danger",size:"small",onClick:X=>Ae(o)},{default:t(()=>e[41]||(e[41]=[r("删除")])),_:2,__:[41]},1032,["onClick"])]),_:1})):g("",!0)]),_:1},8,["data"])]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(ue,{column:3,border:""},{default:t(()=>[a(d,{label:"法大大客户ID"},{default:t(()=>[r(i(n.value.customer_id||"未生成"),1)]),_:1}),a(d,{label:"认证方式"},{default:t(()=>[r(i(n.value.verify_type||"未设置"),1)]),_:1}),a(d,{label:"统一社会信用代码"},{default:t(()=>[r(i(n.value.organization||"未填写"),1)]),_:1}),a(d,{label:"法人姓名"},{default:t(()=>[r(i(n.value.legal_name||"未填写"),1)]),_:1}),a(d,{label:"法人身份证号"},{default:t(()=>[r(i(n.value.legal||"未填写"),1)]),_:1}),a(d,{label:"法人手机号"},{default:t(()=>[r(i(n.value.legal_mobile||"未填写"),1)]),_:1}),a(d,{label:"企业邮箱"},{default:t(()=>[r(i(n.value.company_email||"未填写"),1)]),_:1}),a(d,{label:"组织类型"},{default:t(()=>[r(i(n.value.organization_type||"未设置"),1)]),_:1}),a(d,{label:"证件类型"},{default:t(()=>[r(i(n.value.certificates_type||"未设置"),1)]),_:1}),a(d,{label:"审核时间"},{default:t(()=>[r(i(n.value.auditor_time||"未审核"),1)]),_:1}),a(d,{label:"营业执照"},{default:t(()=>[n.value.organization_path?(m(),v(s,{key:0,type:"primary",onClick:e[0]||(e[0]=o=>Q(n.value.organization_path))},{default:t(()=>e[42]||(e[42]=[r("查看")])),_:1,__:[42]})):g("",!0)]),_:1}),a(d,{label:"企业信息登记表"},{default:t(()=>[n.value.reg_form_path?(m(),v(s,{key:0,type:"primary",onClick:e[1]||(e[1]=o=>Q(n.value.reg_form_path))},{default:t(()=>e[43]||(e[43]=[r("查看")])),_:1,__:[43]})):g("",!0)]),_:1})]),_:1})]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(ue,{column:3,border:""},{default:t(()=>[a(d,{label:"管理员类型"},{default:t(()=>[r(i(n.value.manager_type||"-"),1)]),_:1}),a(d,{label:"姓名"},{default:t(()=>[r(i(n.value.manager_name||"-"),1)]),_:1}),a(d,{label:"身份证号"},{default:t(()=>[r(i(n.value.manager_id_card||"-"),1)]),_:1}),a(d,{label:"手机号"},{default:t(()=>[r(i(n.value.manager_mobile||"-"),1)]),_:1}),a(d,{label:"身份证正面"},{default:t(()=>[n.value.manager_head_photo_path?(m(),v(s,{key:0,type:"primary",onClick:e[2]||(e[2]=o=>Q(n.value.manager_head_photo_path))},{default:t(()=>e[44]||(e[44]=[r("查看")])),_:1,__:[44]})):g("",!0)]),_:1}),a(d,{label:"身份证反面"},{default:t(()=>[n.value.manager_background_path?(m(),v(s,{key:0,type:"primary",onClick:e[3]||(e[3]=o=>Q(n.value.manager_background_path))},{default:t(()=>e[45]||(e[45]=[r("查看")])),_:1,__:[45]})):g("",!0)]),_:1}),a(d,{label:"审核时间"},{default:t(()=>[r(i(n.value.manager_auditor_time||"未审核"),1)]),_:1}),a(d,{label:"审核状态"},{default:t(()=>[a(O,{type:ve(n.value.manager_audit_status)},{default:t(()=>[r(i(n.value.manager_audit_status||"未审核"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),a(G,{class:"detail-card"},{default:t(()=>[a(ot,{"reference-id":b(me).params.id,"reference-type":l.user,logs:n.value.logs||[],"show-filter":!1,"show-pagination":!1,"auto-load":!1},null,8,["reference-id","reference-type","logs"])]),_:1}),a($,{title:Ve.value,modelValue:E.value,"onUpdate:modelValue":e[13]||(e[13]=o=>E.value=o),width:"700px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",it,[a(s,{onClick:e[12]||(e[12]=o=>E.value=!1)},{default:t(()=>e[50]||(e[50]=[r("取 消")])),_:1,__:[50]}),a(s,{type:"primary",onClick:Xe},{default:t(()=>[r(i(L.value?"更新":"确定"),1)]),_:1})])]),default:t(()=>[a(B,{ref_key:"configFormRef",ref:oe,model:_,rules:De,"label-width":"120px"},{default:t(()=>[a(ye,{gutter:20},{default:t(()=>[a(D,{span:24},{default:t(()=>[a(y,{label:"产品",prop:"product_id"},{default:t(()=>[a(h,{modelValue:_.product_id,"onUpdate:modelValue":e[4]||(e[4]=o=>_.product_id=o),placeholder:"请选择产品",style:{width:"100%"},filterable:""},{default:t(()=>[(m(!0),A(de,null,pe(fe.value,o=>(m(),v(x,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(D,{span:24},{default:t(()=>[a(y,{label:"销售模式",prop:"sell_mode"},{default:t(()=>[a(ia,{modelValue:_.sell_mode,"onUpdate:modelValue":e[5]||(e[5]=o=>_.sell_mode=o)},{default:t(()=>[a(ge,{value:"直销"},{default:t(()=>e[46]||(e[46]=[r("直销")])),_:1,__:[46]}),a(ge,{value:"渠道"},{default:t(()=>e[47]||(e[47]=[r("渠道")])),_:1,__:[47]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),ie(a(D,{span:24},{default:t(()=>[a(y,{label:"业务归属",prop:"agent_id"},{default:t(()=>[a(h,{modelValue:_.agent_id,"onUpdate:modelValue":e[6]||(e[6]=o=>_.agent_id=o),placeholder:"请选择业务归属",style:{width:"100%"},filterable:"",onChange:Pe},{default:t(()=>[(m(!0),A(de,null,pe(te.value,o=>(m(),v(x,{key:o.id,label:o.company_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},512),[[ke,_.sell_mode==="渠道"]]),a(D,{span:12},{default:t(()=>[a(y,{label:"销售员",prop:"seller"},{default:t(()=>[a(P,{modelValue:_.seller,"onUpdate:modelValue":e[7]||(e[7]=o=>_.seller=o),placeholder:"请输入销售员姓名"},null,8,["modelValue"])]),_:1})]),_:1}),a(D,{span:12},{default:t(()=>[a(y,{label:"主要险种",prop:"insurance_type"},{default:t(()=>[a(h,{modelValue:_.insurance_type,"onUpdate:modelValue":e[8]||(e[8]=o=>_.insurance_type=o),placeholder:"请选择主要险种",style:{width:"100%"}},{default:t(()=>[a(x,{label:"车险",value:"车险"}),a(x,{label:"货运险",value:"货运险"}),a(x,{label:"船舶险",value:"船舶险"}),a(x,{label:"财产险",value:"财产险"}),a(x,{label:"工程险",value:"工程险"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(ye,{gutter:20},{default:t(()=>[a(D,{span:_.sell_mode==="直销"?24:12},{default:t(()=>[a(y,{label:"服务费",prop:"service_fee"},{default:t(()=>[a(be,{modelValue:_.service_fee,"onUpdate:modelValue":e[9]||(e[9]=o=>_.service_fee=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:t(()=>e[48]||(e[48]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},8,["span"]),ie(a(D,{span:12},{default:t(()=>[a(y,{label:"渠道成本",prop:"agent_cost"},{default:t(()=>[a(be,{modelValue:_.agent_cost,"onUpdate:modelValue":e[10]||(e[10]=o=>_.agent_cost=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:t(()=>e[49]||(e[49]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},512),[[ke,_.sell_mode==="渠道"]])]),_:1}),a(y,{label:"过期时间",prop:"overdue_date"},{default:t(()=>[a(da,{modelValue:_.overdue_date,"onUpdate:modelValue":e[11]||(e[11]=o=>_.overdue_date=o),type:"date",placeholder:"请选择过期时间",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),a($,{title:"初审",modelValue:F.value,"onUpdate:modelValue":e[16]||(e[16]=o=>F.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",pt,[a(s,{onClick:e[15]||(e[15]=o=>F.value=!1)},{default:t(()=>e[52]||(e[52]=[r("取 消")])),_:1,__:[52]}),a(s,{type:"success",onClick:Je},{default:t(()=>e[53]||(e[53]=[r("通过初审")])),_:1,__:[53]}),a(s,{type:"danger",onClick:Ke},{default:t(()=>e[54]||(e[54]=[r("打回修改")])),_:1,__:[54]})])]),default:t(()=>[f("div",dt,[a(W,{title:`当前状态：${n.value.status}`,type:"info",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[51]||(e[51]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 请审核用户的基本信息和认证资料，确认无误后可以通过初审进入终审阶段。 ",-1))]),a(B,{ref_key:"initialReviewFormRef",ref:Ce,model:R,rules:se,"label-width":"100px"},{default:t(()=>[a(y,{label:"审核备注",prop:"audit_note"},{default:t(()=>[a(P,{modelValue:R.audit_note,"onUpdate:modelValue":e[14]||(e[14]=o=>R.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a($,{title:"终审",modelValue:U.value,"onUpdate:modelValue":e[19]||(e[19]=o=>U.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",mt,[a(s,{onClick:e[18]||(e[18]=o=>U.value=!1)},{default:t(()=>e[56]||(e[56]=[r("取 消")])),_:1,__:[56]}),a(s,{type:"success",onClick:Qe},{default:t(()=>e[57]||(e[57]=[r("审核通过")])),_:1,__:[57]}),a(s,{type:"warning",onClick:he},{default:t(()=>e[58]||(e[58]=[r("退回初审")])),_:1,__:[58]})])]),default:t(()=>[f("div",_t,[a(W,{title:`当前状态：${n.value.status}`,type:"warning",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[55]||(e[55]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户已通过初审，请进行最终审核确认。通过后用户即可正常使用系统。 ",-1))]),a(B,{ref_key:"finalReviewFormRef",ref:xe,model:I,rules:se,"label-width":"100px"},{default:t(()=>[a(y,{label:"审核备注",prop:"audit_note"},{default:t(()=>[a(P,{modelValue:I.audit_note,"onUpdate:modelValue":e[17]||(e[17]=o=>I.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a($,{title:"重置用户状态",modelValue:N.value,"onUpdate:modelValue":e[22]||(e[22]=o=>N.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",ct,[a(s,{onClick:e[21]||(e[21]=o=>N.value=!1)},{default:t(()=>e[60]||(e[60]=[r("取 消")])),_:1,__:[60]}),a(s,{type:"danger",onClick:We},{default:t(()=>e[61]||(e[61]=[r("重置到待初审")])),_:1,__:[61]})])]),default:t(()=>[f("div",ft,[a(W,{title:`当前状态：${n.value.status}`,type:"success",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[59]||(e[59]=f("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户当前已通过审核，如需重新审核可以将状态重置到初审阶段。 ",-1))]),a(B,{ref_key:"resetStatusFormRef",ref:Re,model:z,rules:se,"label-width":"100px"},{default:t(()=>[a(y,{label:"重置原因",prop:"audit_note"},{default:t(()=>[a(P,{modelValue:z.audit_note,"onUpdate:modelValue":e[20]||(e[20]=o=>z.audit_note=o),type:"textarea",rows:4,placeholder:"请输入重置原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a($,{title:"添加被保险人",modelValue:Y.value,"onUpdate:modelValue":e[26]||(e[26]=o=>Y.value=o),width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",kt,[a(s,{onClick:e[25]||(e[25]=o=>Y.value=!1)},{default:t(()=>e[68]||(e[68]=[r("取 消")])),_:1,__:[68]}),a(s,{type:"primary",onClick:Ze},{default:t(()=>e[69]||(e[69]=[r("确 定")])),_:1,__:[69]})])]),default:t(()=>[a(B,{ref_key:"addInsuredFormRef",ref:ne,model:k,rules:Ee,"label-width":"140px"},{default:t(()=>[a(y,{label:"营业执照识别"},{default:t(()=>[f("div",vt,[a(pa,{ref_key:"uploadRef",ref:Ie,"file-list":[],"auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":ra,drag:""},{default:t(()=>[f("div",gt,[a(we,{class:"upload-icon"},{default:t(()=>[a(b(Ra))]),_:1}),e[62]||(e[62]=f("div",{class:"upload-text"},"点击或拖拽上传营业执照图片",-1)),e[63]||(e[63]=f("div",{class:"upload-tip"},"支持 JPG、PNG、BMP 格式，文件大小不超过 5MB",-1))])]),_:1},512),K.value?(m(),A("div",yt,[a(we,{class:"is-loading"},{default:t(()=>[a(b(Ia))]),_:1}),e[64]||(e[64]=f("span",null,"正在识别营业执照...",-1))])):g("",!0),M.value?(m(),A("div",bt,[a(W,{title:"识别成功，信息已自动填入",type:"success",closable:!1,style:{"margin-bottom":"10px"}},{default:t(()=>[f("div",wt,[f("p",null,[e[65]||(e[65]=f("strong",null,"公司名称：",-1)),r(i(M.value.name||"未识别"),1)]),f("p",null,[e[66]||(e[66]=f("strong",null,"信用代码：",-1)),r(i(M.value.reg_num||"未识别"),1)])])]),_:1})])):g("",!0)])]),_:1}),a(_a,null,{default:t(()=>e[67]||(e[67]=[r("或手动输入")])),_:1,__:[67]}),a(y,{label:"公司名称",prop:"company_name"},{default:t(()=>[a(P,{modelValue:k.company_name,"onUpdate:modelValue":e[23]||(e[23]=o=>k.company_name=o),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),a(y,{label:"统一社会信用代码",prop:"organization"},{default:t(()=>[a(P,{modelValue:k.organization,"onUpdate:modelValue":e[24]||(e[24]=o=>k.organization=o),placeholder:"请输入统一社会信用代码（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a($,{title:"添加保险公司",modelValue:q.value,"onUpdate:modelValue":e[29]||(e[29]=o=>q.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:t(()=>[f("span",Vt,[a(s,{onClick:e[28]||(e[28]=o=>q.value=!1)},{default:t(()=>e[70]||(e[70]=[r("取 消")])),_:1,__:[70]}),a(s,{type:"primary",onClick:ea},{default:t(()=>e[71]||(e[71]=[r("确 定")])),_:1,__:[71]})])]),default:t(()=>[a(B,{ref_key:"addInsurerFormRef",ref:re,model:j,rules:Fe,"label-width":"120px"},{default:t(()=>[a(y,{label:"保险公司",prop:"insurer_id"},{default:t(()=>[a(h,{modelValue:j.insurer_id,"onUpdate:modelValue":e[27]||(e[27]=o=>j.insurer_id=o),placeholder:"请选择保险公司",style:{width:"100%"},filterable:""},{default:t(()=>[(m(!0),A(de,null,pe(J.value,o=>(m(),v(x,{key:o.id,label:la(o),value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Xt=ca(Ct,[["__scopeId","data-v-653b8959"]]);export{Xt as default};
