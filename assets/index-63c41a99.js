import{_ as ke,u as ye}from"./index-7ec644a6.js";/* empty css                   *//* empty css               *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                 *//* empty css                             *//* empty css                      *//* empty css                        *//* empty css                    */import{r as d,b as H,ae as we,l as E,B as z,C as o,F as a,G as t,a1 as Ve,af as Ce,p as J,n as Q,a5 as xe,K as he,an as Ee,aK as $e,M as Be,ai as Ue,u as x,aL as W,O as s,as as De,D as f,S as X,aU as Le,at as Te,H as Ie,I as ze,E as $,J as Se,a2 as Fe,al as Re,am as Ne,az as Pe,aA as Ke,aB as Me,ag as Oe,a6 as je,ao as qe,ax as Ae,ay as Ge,ah as He,a7 as Je}from"./element-plus-b8725afa.js";import{g as Qe,c as We,u as Xe,d as Ye}from"./insurer-0240b87f.js";import{g as Ze}from"./caxt-6a781c6a.js";import{f as Y}from"./format-20468769.js";const ea={class:"insurance-container"},aa={class:"filter-container"},ta={class:"pagination"},la={class:"detail-container"},na={class:"detail-section"},oa={class:"detail-section"},sa={class:"dialog-footer"},ra={key:0,class:"smart-recognition"},ia={class:"card-header"},ua={key:0,class:"example-content"},da={class:"recognition-content"},ca={class:"recognition-actions"},ma={class:"dialog-footer"},pa={__name:"index",setup(_a){ye();const k=d(null),O=d([]),j=d(0),S=d(!0),y=d(!1),L=d(""),F=d(""),T=d(!1),_=d({}),w=d(""),B=d(!1),U=d([]),D=d([]),R=d(!1),N=d(""),g=H({page:1,limit:20,keyword:""}),r=H({id:void 0,name:"",bank_code:"",bank_name:"",account_no:"",remark:"",status:"启用"}),Z={name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],bank_code:[{required:!0,message:"银行编码不能为空",trigger:"change"}],bank_name:[{required:!0,message:"请选择银行",trigger:"change"}],account_no:[{required:!0,message:"请输入银行账号",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},ee=async()=>{try{const{data:n}=await Ze();U.value=n||[],D.value=n||[]}catch(n){console.error("获取银行编码列表失败:",n)}},ae=n=>{n!==""?(R.value=!0,setTimeout(()=>{D.value=U.value.filter(e=>e.name.toLowerCase().includes(n.toLowerCase())||e.code.toLowerCase().includes(n.toLowerCase())),R.value=!1},200)):D.value=U.value},V=async()=>{S.value=!0;try{const{data:n}=await Qe(g);O.value=n.list,j.value=n.total}catch(n){console.error("获取保险公司列表失败:",n)}S.value=!1},q=()=>{g.page=1,V()},te=n=>{g.limit=n,V()},le=n=>{g.page=n,V()},ne=()=>{Object.assign(r,{id:void 0,name:"",bank_code:"",bank_name:"",account_no:"",remark:"",status:"启用"}),w.value="",B.value=!1,D.value=U.value,N.value=""},oe=()=>{ne(),L.value="create",F.value="新增保险公司",y.value=!0,Q(()=>{k.value&&k.value.clearValidate()})},se=n=>{Object.assign(r,n),L.value="update",F.value="编辑保险公司",y.value=!0,Q(()=>{k.value&&k.value.clearValidate()})},re=n=>{_.value={...n},T.value=!0},ie=()=>{if(!w.value.trim()){$.warning("请输入要识别的文本");return}const e=w.value.trim().split(`
`).map(u=>u.trim()).filter(u=>u);let i={name:"",account_no:"",bank_name:""};e.forEach(u=>{const b=u.replace(/\s+/g," ").trim(),I=[/(?:保险公司名称|公司名称|名称|保险公司|公司|机构名称)[:：=\s]\s*(.+)/i,/^(.+(?:保险|财险|人寿|平安|太平洋|中国人民|中华联合|大地|阳光|华泰|永安|安盛天平|国寿|泰康|新华|友邦).+公司.*?)$/i],P=[/(?:保险公司账号|银行账号|账号|账户|帐号|卡号)[:：=\s]\s*(.+)/i,/^(\d{10,25})$/i],K=[/(?:开户行|开户银行|银行|开户行名称|银行名称)[:：=\s]\s*(.+)/i,/^(.+(?:银行|农商|信用社|邮储).+?)$/i];for(const c of I){const m=b.match(c);if(m&&m[1]&&!i.name){const p=m[1].trim();if(p.length>3&&!p.match(/^\d+$/)){i.name=p;break}}}for(const c of P){const m=b.match(c);if(m&&m[1]&&!i.account_no){const p=m[1].trim();if(p.match(/^\d{10,25}$/)){i.account_no=p;break}}}for(const c of K){const m=b.match(c);if(m&&m[1]&&!i.bank_name){const p=m[1].trim();if(p.length>3&&!p.match(/^\d+$/)){i.bank_name=p;break}}}}),i.name&&(r.name=i.name),i.account_no&&(r.account_no=i.account_no),i.bank_name&&(r.bank_name=i.bank_name);const v=[i.name,i.account_no,i.bank_name].filter(u=>u).length;v>0?$.success(`成功识别 ${v} 个字段`):$.warning("未能识别到有效信息，请检查文本格式")},ue=()=>{w.value=""},de=n=>{if(n){const e=U.value.find(i=>i.name===n);e&&(r.bank_code=e.code)}else r.bank_code=""},ce=async()=>{k.value&&await k.value.validate(async n=>{if(n)try{await We(r),y.value=!1,$({type:"success",message:"创建成功"}),V()}catch(e){console.error("创建保险公司失败:",e)}})},me=async()=>{k.value&&await k.value.validate(async n=>{if(n)try{await Xe(r.id,r),y.value=!1,$({type:"success",message:"更新成功"}),V()}catch(e){console.error("更新保险公司失败:",e)}})},pe=async n=>{try{await Se.confirm("确认删除该保险公司?","提示",{type:"warning"}),await Ye(n.id),$({type:"success",message:"删除成功!"}),V()}catch(e){console.error("删除保险公司失败:",e)}};return we(()=>{V(),ee()}),(n,e)=>{const i=Fe,v=xe,u=he,b=Re,I=Ne,P=Ee,K=$e,c=Pe,m=Ke,p=Be,_e=Me,fe=Oe,C=je,h=qe,M=Ae,A=Ge,ge=He,ve=Je,be=Ue;return E(),z("div",ea,[o("div",aa,[a(v,{modelValue:g.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>g.keyword=l),placeholder:"公司名称/银行账号",style:{width:"450px !important"},class:"filter-item search-input",onKeyup:Ve(q,["enter"])},{prefix:t(()=>[a(i,null,{default:t(()=>[a(x(W))]),_:1})]),_:1},8,["modelValue"]),a(u,{class:"filter-item",type:"primary",onClick:q,style:{"margin-left":"10px"}},{default:t(()=>[a(i,null,{default:t(()=>[a(x(W))]),_:1}),e[17]||(e[17]=s(" 搜索 "))]),_:1,__:[17]}),a(u,{class:"filter-item",type:"primary",onClick:oe,style:{"margin-left":"10px"}},{default:t(()=>[a(i,null,{default:t(()=>[a(x(De))]),_:1}),e[18]||(e[18]=s(" 新增保险公司 "))]),_:1,__:[18]})]),Ce((E(),J(P,{data:O.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:t(()=>[a(b,{label:"公司名称",prop:"name",align:"left","min-width":"200"}),a(b,{label:"银行编码",prop:"bank_code",align:"left",width:"120"}),a(b,{label:"银行账号",prop:"account_no",align:"left",width:"200"}),a(b,{label:"开户行",prop:"bank_name",align:"left","min-width":"200"}),a(b,{label:"状态",prop:"status",align:"center",width:"100"},{default:t(({row:l})=>[a(I,{type:l.status==="启用"?"success":"info"},{default:t(()=>[s(f(l.status),1)]),_:2},1032,["type"])]),_:1}),a(b,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:t(({row:l})=>[a(u,{type:"primary",link:"",onClick:G=>re(l)},{default:t(()=>e[19]||(e[19]=[s("详情")])),_:2,__:[19]},1032,["onClick"]),a(u,{type:"primary",link:"",onClick:G=>se(l)},{default:t(()=>e[20]||(e[20]=[s("编辑")])),_:2,__:[20]},1032,["onClick"]),a(u,{type:"danger",link:"",onClick:G=>pe(l)},{default:t(()=>e[21]||(e[21]=[s("删除")])),_:2,__:[21]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[be,S.value]]),o("div",ta,[a(K,{"current-page":g.page,"onUpdate:currentPage":e[1]||(e[1]=l=>g.page=l),"page-size":g.limit,"onUpdate:pageSize":e[2]||(e[2]=l=>g.limit=l),"page-sizes":[10,20,50,100],total:j.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:te,onCurrentChange:le},null,8,["current-page","page-size","total"])]),a(p,{modelValue:T.value,"onUpdate:modelValue":e[4]||(e[4]=l=>T.value=l),title:"保险公司详情",width:"800px","close-on-click-modal":!1,draggable:"",class:"custom-dialog"},{footer:t(()=>[o("div",sa,[a(u,{onClick:e[3]||(e[3]=l=>T.value=!1)},{default:t(()=>e[22]||(e[22]=[s("关 闭")])),_:1,__:[22]})])]),default:t(()=>[o("div",la,[o("div",na,[a(m,{column:1,border:""},{default:t(()=>[a(c,{label:"公司名称"},{default:t(()=>[s(f(_.value.name),1)]),_:1}),a(c,{label:"银行编码"},{default:t(()=>[s(f(_.value.bank_code),1)]),_:1}),a(c,{label:"开户行"},{default:t(()=>[s(f(_.value.bank_name)+f(_.value.bank_code),1)]),_:1}),a(c,{label:"银行账号",span:2},{default:t(()=>[s(f(_.value.account_no),1)]),_:1}),a(c,{label:"状态"},{default:t(()=>[a(I,{type:_.value.status==="启用"?"success":"info"},{default:t(()=>[s(f(_.value.status),1)]),_:1},8,["type"])]),_:1})]),_:1})]),o("div",oa,[a(m,{column:1,border:""},{default:t(()=>[a(c,{label:"备注"},{default:t(()=>[s(f(_.value.remark||"-"),1)]),_:1}),a(c,{label:"创建时间"},{default:t(()=>[s(f(x(Y)(_.value.created_at)),1)]),_:1}),a(c,{label:"更新时间"},{default:t(()=>[s(f(x(Y)(_.value.updated_at)),1)]),_:1})]),_:1})])])]),_:1},8,["modelValue"]),a(p,{modelValue:y.value,"onUpdate:modelValue":e[16]||(e[16]=l=>y.value=l),title:F.value,width:"700px","close-on-click-modal":!1,draggable:"",class:"custom-dialog"},{footer:t(()=>[o("div",ma,[a(u,{onClick:e[14]||(e[14]=l=>y.value=!1)},{default:t(()=>e[27]||(e[27]=[s("取 消")])),_:1,__:[27]}),a(u,{type:"primary",onClick:e[15]||(e[15]=l=>L.value==="create"?ce():me())},{default:t(()=>e[28]||(e[28]=[s(" 确 定 ")])),_:1,__:[28]})])]),default:t(()=>[L.value==="create"?(E(),z("div",ra,[a(fe,null,{header:t(()=>[o("div",ia,[e[23]||(e[23]=o("span",null,"智能识别",-1)),a(u,{type:"text",onClick:e[5]||(e[5]=l=>B.value=!B.value)},{default:t(()=>[s(f(B.value?"隐藏示例":"查看示例"),1)]),_:1})])]),default:t(()=>[B.value?(E(),z("div",ua,[a(_e,{title:"使用说明",type:"info",closable:!1,"show-icon":""},{default:t(()=>e[24]||(e[24]=[o("div",{class:"example-text"},[o("p",null,'将包含保险公司信息的文本粘贴到下方文本框，点击"智能识别"即可自动填充表单。'),o("p",null,[o("strong",null,"支持格式示例：")]),o("div",{class:"example-block"},[o("strong",null,"格式一："),o("br"),s(" 保险公司账号: 44501001040020093"),o("br"),s(" 保险公司名称: 永安财产保险股份有限公司佛山中心支公司"),o("br"),s(" 开户行: 中国农业银行股份有限公司南海分行"),o("br"),o("br"),o("strong",null,"格式二："),o("br"),s(" 公司名称：中国平安财产保险股份有限公司"),o("br"),s(" 银行账号：123456789012345678"),o("br"),s(" 开户行：中国工商银行股份有限公司北京分行"),o("br"),o("br"),o("strong",null,"格式三（自动识别）："),o("br"),s(" 太平洋财产保险股份有限公司广州分公司"),o("br"),s(" 98765432101234567890"),o("br"),s(" 招商银行股份有限公司深圳分行 ")])],-1)])),_:1,__:[24]})])):X("",!0),o("div",da,[a(v,{modelValue:w.value,"onUpdate:modelValue":e[6]||(e[6]=l=>w.value=l),type:"textarea",rows:4,placeholder:"请将包含保险公司信息的文本粘贴到这里...",maxlength:"1000","show-word-limit":""},null,8,["modelValue"]),o("div",ca,[a(u,{type:"primary",onClick:ie,disabled:!w.value.trim()},{default:t(()=>[a(i,null,{default:t(()=>[a(x(Le))]),_:1}),e[25]||(e[25]=s(" 智能识别 "))]),_:1,__:[25]},8,["disabled"]),a(u,{onClick:ue},{default:t(()=>[a(i,null,{default:t(()=>[a(x(Te))]),_:1}),e[26]||(e[26]=s(" 清空 "))]),_:1,__:[26]})])])]),_:1})])):X("",!0),a(ve,{ref_key:"dataFormRef",ref:k,model:r,rules:Z,"label-position":"right","label-width":"120px",class:"form-container"},{default:t(()=>[a(ge,{gutter:20},{default:t(()=>[a(h,{span:24},{default:t(()=>[a(C,{label:"公司名称",prop:"name"},{default:t(()=>[a(v,{modelValue:r.name,"onUpdate:modelValue":e[7]||(e[7]=l=>r.name=l),placeholder:"请输入公司名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(h,{span:12},{default:t(()=>[a(C,{label:"银行名称搜索"},{default:t(()=>[a(A,{modelValue:N.value,"onUpdate:modelValue":e[8]||(e[8]=l=>N.value=l),placeholder:"请输入银行名称搜索",clearable:"",filterable:"",remote:"","remote-method":ae,loading:R.value,onChange:de},{default:t(()=>[(E(!0),z(Ie,null,ze(D.value,l=>(E(),J(M,{key:l.code,label:`${l.name} (${l.code})`,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1}),a(h,{span:12},{default:t(()=>[a(C,{label:"银行编码",prop:"bank_code"},{default:t(()=>[a(v,{modelValue:r.bank_code,"onUpdate:modelValue":e[9]||(e[9]=l=>r.bank_code=l),placeholder:"银行编码",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),a(h,{span:24},{default:t(()=>[a(C,{label:"开户行",prop:"bank_name"},{default:t(()=>[a(v,{modelValue:r.bank_name,"onUpdate:modelValue":e[10]||(e[10]=l=>r.bank_name=l),placeholder:"请输入开户行",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(h,{span:24},{default:t(()=>[a(C,{label:"银行账号",prop:"account_no"},{default:t(()=>[a(v,{modelValue:r.account_no,"onUpdate:modelValue":e[11]||(e[11]=l=>r.account_no=l),placeholder:"请输入银行账号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(h,{span:12},{default:t(()=>[a(C,{label:"状态",prop:"status"},{default:t(()=>[a(A,{modelValue:r.status,"onUpdate:modelValue":e[12]||(e[12]=l=>r.status=l),placeholder:"请选择状态",clearable:""},{default:t(()=>[a(M,{label:"启用",value:"启用"}),a(M,{label:"禁用",value:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(C,{label:"备注",prop:"remark"},{default:t(()=>[a(v,{modelValue:r.remark,"onUpdate:modelValue":e[13]||(e[13]=l=>r.remark=l),type:"textarea",rows:3,placeholder:"请输入备注信息",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},La=ke(pa,[["__scopeId","data-v-397d1dbe"]]);export{La as default};
