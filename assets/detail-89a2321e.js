import{_ as U,u as $,b as P}from"./index-d036b99c.js";/* empty css                   *//* empty css                *//* empty css                             *//* empty css               *//* empty css                   *//* empty css                       */import{a as F,v as G,u as x}from"./agent-637c3e44.js";import{f as H}from"./format-20468769.js";import{u as J}from"./uuid2url-6c3b910f.js";import{L as K}from"./LogList-d4f568af.js";import{r as E,ae as O,l as c,B as j,C as D,F as l,G as a,af as q,p as d,E as i,aE as Q,ag as W,ai as X,O as r,S as _,D as u,u as B,J as v,K as Y,az as Z,am as ee,aA as ae}from"./element-plus-b8725afa.js";/* empty css                      *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                         */import"./log-539583be.js";const te={class:"agent-detail"},le={class:"page-header"},re={class:"header-actions"},oe={__name:"detail",setup(ne){const A=$(),w=P(),y=E(!1),e=E({}),p=async()=>{y.value=!0;try{const o=await F(w.params.id);e.value=o.data}catch(o){console.error("获取渠道详情失败:",o),i.error("获取渠道详情失败")}y.value=!1},M=()=>{A.back()},T=()=>{v.confirm("确认要为该渠道添加认证吗？","提示",{type:"warning"}).then(async()=>{try{await G(e.value.id),i.success("添加认证成功"),p()}catch(o){console.error("添加认证失败:",o),i.error("添加认证失败")}})},V=()=>{if(!e.value.verify_url){i.error("认证链接不存在");return}try{if(typeof window<"u"&&window.open)window.open(e.value.verify_url,"_blank");else{const o=document.createElement("a");o.href=e.value.verify_url,o.target="_blank",o.rel="noopener noreferrer",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}catch(o){console.error("打开认证链接失败:",o),i.error("无法打开认证链接，请手动复制链接访问")}},z=()=>{if(!e.value.verify_url){i.error("认证链接不存在");return}navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e.value.verify_url).then(()=>{i.success("认证链接已复制到剪贴板")}).catch(o=>{console.error("使用 Clipboard API 复制失败:",o),h(e.value.verify_url)}):h(e.value.verify_url)},h=o=>{try{const t=document.createElement("textarea");t.value=o,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();const s=document.execCommand("copy");if(document.body.removeChild(t),s)i.success("认证链接已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(t){console.error("复制失败:",t),v.alert(e.value.verify_url,"请手动复制认证链接",{confirmButtonText:"确定",type:"info"})}},I=o=>({启用:"success",禁用:"info"})[o]||"info",C=o=>({未认证:"info",管理员资料已提交:"warning",企业基本资料已提交:"warning",已提交待审核:"warning",审核通过:"success",审核不通过:"danger",人工初审通过:"primary"})[o]||"info",m=o=>{J(o).then(t=>{try{if(typeof window<"u"&&window.open)window.open(t,"_blank");else{const s=document.createElement("a");s.href=t,s.target="_blank",s.rel="noopener noreferrer",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}catch(s){console.error("打开文件失败:",s),i.error("无法打开文件")}}).catch(t=>{console.error("获取文件URL失败:",t),i.error("获取文件URL失败")})},L=()=>{v.confirm("确认要禁用该渠道吗？禁用后渠道将无法正常使用系统。","警告",{type:"warning"}).then(async()=>{try{const o={username:e.value.username,company_name:e.value.company_name,contact_name:e.value.contact_name,contact_phone:e.value.contact_phone,contact_email:e.value.contact_email,seller:e.value.seller,status:"禁用",remark:e.value.remark};await x(e.value.id,o),i.success("渠道已禁用"),p()}catch(o){console.error("禁用渠道失败:",o),i.error("禁用渠道失败")}})},S=()=>{v.confirm("确认要启用该渠道吗？","提示",{type:"warning"}).then(async()=>{try{const o={username:e.value.username,company_name:e.value.company_name,contact_name:e.value.contact_name,contact_phone:e.value.contact_phone,contact_email:e.value.contact_email,seller:e.value.seller,status:"启用",remark:e.value.remark};await x(e.value.id,o),i.success("渠道已启用"),p()}catch(o){console.error("启用渠道失败:",o),i.error("启用渠道失败")}})};return O(()=>{p()}),(o,t)=>{const s=Y,N=Q,n=Z,g=ee,b=ae,f=W,R=X;return c(),j("div",te,[D("div",le,[l(N,{onBack:M,title:e.value.company_name||"渠道详情"},{extra:a(()=>[D("div",re,[e.value.customer_id?_("",!0):(c(),d(s,{key:0,type:"warning",onClick:T},{default:a(()=>t[4]||(t[4]=[r("实名认证")])),_:1,__:[4]})),e.value.verify_url&&e.value.audit_status==="未认证"?(c(),d(s,{key:1,type:"success",onClick:V},{default:a(()=>t[5]||(t[5]=[r("继续认证")])),_:1,__:[5]})):_("",!0),e.value.verify_url?(c(),d(s,{key:2,type:"info",onClick:z},{default:a(()=>t[6]||(t[6]=[r("复制认证链接")])),_:1,__:[6]})):_("",!0),e.value.status==="启用"?(c(),d(s,{key:3,type:"danger",onClick:L},{default:a(()=>t[7]||(t[7]=[r("禁用")])),_:1,__:[7]})):_("",!0),e.value.status==="禁用"?(c(),d(s,{key:4,type:"success",onClick:S},{default:a(()=>t[8]||(t[8]=[r("启用")])),_:1,__:[8]})):_("",!0)])]),_:1},8,["title"])]),q((c(),d(f,{class:"detail-card"},{default:a(()=>[l(b,{column:3,border:""},{default:a(()=>[l(n,{label:"用户名"},{default:a(()=>[r(u(e.value.username),1)]),_:1}),l(n,{label:"状态"},{default:a(()=>[l(g,{type:I(e.value.status)},{default:a(()=>[r(u(e.value.status),1)]),_:1},8,["type"])]),_:1}),l(n,{label:"企业名称",span:2},{default:a(()=>[r(u(e.value.company_name),1)]),_:1}),l(n,{label:"认证状态"},{default:a(()=>[l(g,{type:C(e.value.audit_status),size:"small"},{default:a(()=>[r(u(e.value.audit_status||"未认证"),1)]),_:1},8,["type"])]),_:1}),l(n,{label:"联系人"},{default:a(()=>[r(u(e.value.contact_name),1)]),_:1}),l(n,{label:"联系电话"},{default:a(()=>[r(u(e.value.contact_phone),1)]),_:1}),l(n,{label:"联系邮箱"},{default:a(()=>[r(u(e.value.contact_email),1)]),_:1}),l(n,{label:"销售员"},{default:a(()=>[r(u(e.value.seller),1)]),_:1}),l(n,{label:"创建时间"},{default:a(()=>[r(u(B(H)(e.value.created_at)),1)]),_:1}),l(n,{label:"备注",span:3},{default:a(()=>[r(u(e.value.remark||"无"),1)]),_:1})]),_:1})]),_:1})),[[R,y.value]]),l(f,{class:"detail-card"},{default:a(()=>[l(b,{column:3,border:""},{default:a(()=>[l(n,{label:"法大大客户ID"},{default:a(()=>[r(u(e.value.customer_id||"未生成"),1)]),_:1}),l(n,{label:"认证方式"},{default:a(()=>[r(u(e.value.verify_type||"未设置"),1)]),_:1}),l(n,{label:"统一社会信用代码"},{default:a(()=>[r(u(e.value.organization||"未填写"),1)]),_:1}),l(n,{label:"法人姓名"},{default:a(()=>[r(u(e.value.legal_name||"未填写"),1)]),_:1}),l(n,{label:"法人身份证号"},{default:a(()=>[r(u(e.value.legal||"未填写"),1)]),_:1}),l(n,{label:"法人手机号"},{default:a(()=>[r(u(e.value.legal_mobile||"未填写"),1)]),_:1}),l(n,{label:"企业邮箱"},{default:a(()=>[r(u(e.value.company_email||"未填写"),1)]),_:1}),l(n,{label:"组织类型"},{default:a(()=>[r(u(e.value.organization_type||"未设置"),1)]),_:1}),l(n,{label:"证件类型"},{default:a(()=>[r(u(e.value.certificates_type||"未设置"),1)]),_:1}),l(n,{label:"审核时间"},{default:a(()=>[r(u(e.value.auditor_time||"未审核"),1)]),_:1}),l(n,{label:"营业执照"},{default:a(()=>[e.value.organization_path?(c(),d(s,{key:0,type:"primary",onClick:t[0]||(t[0]=k=>m(e.value.organization_path))},{default:a(()=>t[9]||(t[9]=[r("查看")])),_:1,__:[9]})):_("",!0)]),_:1}),l(n,{label:"企业信息登记表"},{default:a(()=>[e.value.reg_form_path?(c(),d(s,{key:0,type:"primary",onClick:t[1]||(t[1]=k=>m(e.value.reg_form_path))},{default:a(()=>t[10]||(t[10]=[r("查看")])),_:1,__:[10]})):_("",!0)]),_:1})]),_:1})]),_:1}),l(f,{class:"detail-card"},{default:a(()=>[l(b,{column:3,border:""},{default:a(()=>[l(n,{label:"管理员类型"},{default:a(()=>[r(u(e.value.manager_type||"-"),1)]),_:1}),l(n,{label:"姓名"},{default:a(()=>[r(u(e.value.manager_name||"-"),1)]),_:1}),l(n,{label:"身份证号"},{default:a(()=>[r(u(e.value.manager_id_card||"-"),1)]),_:1}),l(n,{label:"手机号"},{default:a(()=>[r(u(e.value.manager_mobile||"-"),1)]),_:1}),l(n,{label:"身份证正面"},{default:a(()=>[e.value.manager_head_photo_path?(c(),d(s,{key:0,type:"primary",onClick:t[2]||(t[2]=k=>m(e.value.manager_head_photo_path))},{default:a(()=>t[11]||(t[11]=[r("查看")])),_:1,__:[11]})):_("",!0)]),_:1}),l(n,{label:"身份证反面"},{default:a(()=>[e.value.manager_background_path?(c(),d(s,{key:0,type:"primary",onClick:t[3]||(t[3]=k=>m(e.value.manager_background_path))},{default:a(()=>t[12]||(t[12]=[r("查看")])),_:1,__:[12]})):_("",!0)]),_:1}),l(n,{label:"审核时间"},{default:a(()=>[r(u(e.value.manager_auditor_time||"未审核"),1)]),_:1}),l(n,{label:"审核状态"},{default:a(()=>[l(g,{type:C(e.value.manager_audit_status)},{default:a(()=>[r(u(e.value.manager_audit_status||"未审核"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),l(f,{class:"detail-card"},{default:a(()=>[l(K,{"reference-id":B(w).params.id,"reference-type":o.agent,logs:e.value.logs||[],"show-filter":!1,"show-pagination":!1,"auto-load":!1},null,8,["reference-id","reference-type","logs"])]),_:1})])}}},Ee=U(oe,[["__scopeId","data-v-524c187e"]]);export{Ee as default};
