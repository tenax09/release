import{_ as K,u as N,b as Q}from"./index-36afcd41.js";/* empty css               *//* empty css                      *//* empty css                  *//* empty css                     *//* empty css                        */import{r as b,b as j,w as G,ae as J,l as S,B as Z,C as d,F as e,G as n,a1 as q,af as H,p as W,E as _,a5 as X,ay as Y,K as ee,an as te,aQ as ae,ai as le,u as p,aR as z,O as c,as as ne,av as oe,D as g,Z as se,a2 as re,ax as ie,al as de,am as ue,J as pe}from"./element-plus-3147ea74.js";import{k as ce}from"./order-9d4a81ad.js";import{f as me}from"./format-20468769.js";const _e={class:"order-list"},ge={class:"filter-container"},fe={class:"table-container"},ye={class:"pagination"},be={__name:"index",setup(ve){const v=N(),w=Q(),h=b([]),x=b(0),f=b(!0),o=j({page:1,page_size:20,keyword:"",status:""}),C={OrderAll:"",OrderFirstReview:"待初审",OrderSecondReview:"待复审",OrderFunderSign:"待资方签约",OrderCustomerSign:"待客户签约",OrderPendingLoan:"待放款",OrderLoaned:"已放款",OrderRefunded:"已退保",OrderCompleted:"已结清",OrderCancelled:"已作废"},k=()=>{const a=w.name;C.hasOwnProperty(a)&&(o.status=C[a])},u=async()=>{f.value=!0;try{const{data:a}=await ce(o);h.value=a.list,x.value=a.total}catch(a){console.error("获取订单列表失败:",a),_.error("获取订单列表失败")}f.value=!1},y=()=>{o.page=1,u()},E=a=>a==null?"-":"¥"+parseFloat(a).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}),B=()=>{v.push("/order/create")},M=()=>{window.open(`/api/admin/orders/export?status=${o.status}&keyword=${o.keyword}`,"_blank")},R=a=>{v.push(`/order/detail/${a.id}`)},V=a=>({待初审:"warning",待复审:"warning",待客户签约:"primary",待资方签约:"primary",待放款:"warning",已放款:"success",已退保:"danger",已结清:"success",已作废:"info"})[a]||"info",P=a=>{o.page_size=a,u()},T=a=>{o.page=a,u()},F=a=>{if(!a){_.warning("订单号不存在");return}const t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);navigator.clipboard&&(window.isSecureContext||t)?navigator.clipboard.writeText(a).then(()=>{_.success("订单号已复制到剪贴板")}).catch(r=>{console.error("使用 Clipboard API 复制失败:",r),O(a)}):O(a)},O=a=>{try{const t=document.createElement("textarea");t.value=a,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();const r=document.execCommand("copy");if(document.body.removeChild(t),r)_.success("订单号已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(t){console.error("复制失败:",t),pe.alert(a,"请手动复制订单号",{confirmButtonText:"确定",type:"info"})}};return G(()=>w.name,()=>{k(),o.page=1,u()},{immediate:!0}),J(()=>{k(),u()}),(a,t)=>{const r=re,L=X,s=ie,D=Y,m=ee,i=de,A=ue,I=te,U=ae,$=le;return S(),Z("div",_e,[d("div",ge,[e(L,{modelValue:o.keyword,"onUpdate:modelValue":t[0]||(t[0]=l=>o.keyword=l),placeholder:"订单号/保险类型",style:{width:"450px !important"},class:"filter-item search-input",onKeyup:q(y,["enter","native"])},{prefix:n(()=>[e(r,null,{default:n(()=>[e(p(z))]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:o.status,"onUpdate:modelValue":t[1]||(t[1]=l=>o.status=l),placeholder:"选择状态",style:{width:"150px","margin-left":"10px !important"},class:"filter-item",clearable:"",onChange:y},{default:n(()=>[e(s,{label:"全部",value:""}),e(s,{label:"待初审",value:"待初审"}),e(s,{label:"待复审",value:"待复审"}),e(s,{label:"待客户签约",value:"待客户签约"}),e(s,{label:"待资方签约",value:"待资方签约"}),e(s,{label:"待放款",value:"待放款"}),e(s,{label:"已放款",value:"已放款"}),e(s,{label:"已退保",value:"已退保"}),e(s,{label:"已结清",value:"已结清"})]),_:1},8,["modelValue"]),e(m,{class:"filter-item",type:"primary",onClick:y,style:{"margin-left":"10px !important"}},{default:n(()=>[e(r,null,{default:n(()=>[e(p(z))]),_:1}),t[4]||(t[4]=c(" 搜索 "))]),_:1,__:[4]}),e(m,{class:"filter-item",type:"primary",onClick:B,style:{"margin-left":"10px !important"}},{default:n(()=>[e(r,null,{default:n(()=>[e(p(ne))]),_:1}),t[5]||(t[5]=c(" 新建订单 "))]),_:1,__:[5]}),e(m,{class:"filter-item",type:"success",onClick:M,style:{"margin-left":"10px !important"}},{default:n(()=>[e(r,null,{default:n(()=>[e(p(oe))]),_:1}),t[6]||(t[6]=c(" 导出Excel "))]),_:1,__:[6]})]),d("div",fe,[H((S(),W(I,{data:h.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%",cursor:"pointer"},onRowClick:R},{default:n(()=>[e(i,{label:"订单号",prop:"order_no",align:"left","min-width":"150"}),e(i,{label:"险种",prop:"insurance_type",align:"center","min-width":"100"}),e(i,{label:"借款人",prop:"loan_name",align:"left","min-width":"200"}),e(i,{label:"总保费",prop:"total_premium",align:"center",width:"120"},{default:n(({row:l})=>[d("span",null,g(l.total_premium?E(l.total_premium):"-"),1)]),_:1}),e(i,{label:"贷款金额",prop:"loan_amount",align:"center",width:"120"},{default:n(({row:l})=>[d("span",null,g(l.loan_amount?E(l.loan_amount):"-"),1)]),_:1}),e(i,{label:"进件时间",prop:"created_at",align:"center",width:"180"},{default:n(({row:l})=>[d("span",null,g(l.created_at?p(me)(l.created_at):"-"),1)]),_:1}),e(i,{label:"状态",prop:"status",align:"center",width:"120"},{default:n(({row:l})=>[e(A,{type:V(l.status)},{default:n(()=>[c(g(l.status),1)]),_:2},1032,["type"])]),_:1}),e(i,{label:"操作",align:"center",width:"120",fixed:"right"},{default:n(({row:l})=>[e(m,{type:"primary",link:"",size:"small",onClick:se(we=>F(l.order_no),["stop"]),class:"copy-btn"},{default:n(()=>t[7]||(t[7]=[c(" 复制订单号 ")])),_:2,__:[7]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,f.value]])]),d("div",ye,[e(U,{"current-page":o.page,"onUpdate:currentPage":t[2]||(t[2]=l=>o.page=l),"page-size":o.page_size,"onUpdate:pageSize":t[3]||(t[3]=l=>o.page_size=l),"page-sizes":[10,20,50,100],total:x.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:P,onCurrentChange:T},null,8,["current-page","page-size","total"])])])}}},Me=K(be,[["__scopeId","data-v-2d9172f9"]]);export{Me as default};
