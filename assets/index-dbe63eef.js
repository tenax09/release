import{_ as ce,u as me}from"./index-78e7e5a9.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css               *//* empty css                *//* empty css                 *//* empty css                             *//* empty css                      *//* empty css                        */import{r as p,b as N,ae as pe,l as z,B as L,C as n,F as a,G as t,a1 as _e,af as fe,p as ge,n as O,a5 as ve,K as be,an as ke,aK as ye,M as xe,ai as we,u as V,aL as j,O as o,as as Ve,D as k,S as A,aU as Ce,at as he,E as C,J as Ee,a2 as De,al as $e,am as Ue,az as Te,aA as ze,aB as Ie,ag as Be,a6 as Fe,ao as Se,ah as Le,ax as Re,ay as Pe,a7 as qe}from"./element-plus-e0a6c12c.js";import{g as Ke,c as Me,u as Ne,d as Oe}from"./insurer-244f2c9f.js";import{f as G}from"./format-20468769.js";const je={class:"insurance-container"},Ae={class:"filter-container"},Ge={class:"pagination"},Je={class:"detail-container"},Qe={class:"detail-section"},He={class:"detail-section"},We={class:"dialog-footer"},Xe={key:0,class:"smart-recognition"},Ye={class:"card-header"},Ze={key:0,class:"example-content"},ea={class:"recognition-content"},aa={class:"recognition-actions"},ta={class:"dialog-footer"},la={__name:"index",setup(na){me();const f=p(null),R=p([]),P=p(0),I=p(!0),y=p(!1),D=p(""),B=p(""),$=p(!1),g=p({}),x=p(""),h=p(!1),_=N({page:1,limit:20,keyword:""}),i=N({id:void 0,name:"",bank_name:"",account_no:"",remark:"",status:"启用"}),J={name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],bank_name:[{required:!0,message:"请输入开户行",trigger:"blur"}],account_no:[{required:!0,message:"请输入银行账号",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},w=async()=>{I.value=!0;try{const{data:r}=await Ke(_);R.value=r.list,P.value=r.total}catch(r){console.error("获取保险公司列表失败:",r)}I.value=!1},q=()=>{_.page=1,w()},Q=r=>{_.limit=r,w()},H=r=>{_.page=r,w()},W=()=>{Object.assign(i,{id:void 0,name:"",bank_name:"",account_no:"",remark:"",status:"启用"}),x.value="",h.value=!1},X=()=>{W(),D.value="create",B.value="新增保险公司",y.value=!0,O(()=>{f.value&&f.value.clearValidate()})},Y=r=>{Object.assign(i,r),D.value="update",B.value="编辑保险公司",y.value=!0,O(()=>{f.value&&f.value.clearValidate()})},Z=r=>{g.value={...r},$.value=!0},ee=()=>{if(!x.value.trim()){C.warning("请输入要识别的文本");return}const e=x.value.trim().split(`
`).map(u=>u.trim()).filter(u=>u);let s={name:"",account_no:"",bank_name:""};e.forEach(u=>{const b=u.replace(/\s+/g," ").trim(),U=[/(?:保险公司名称|公司名称|名称|保险公司|公司|机构名称)[:：=\s]\s*(.+)/i,/^(.+(?:保险|财险|人寿|平安|太平洋|中国人民|中华联合|大地|阳光|华泰|永安|安盛天平|国寿|泰康|新华|友邦).+公司.*?)$/i],F=[/(?:保险公司账号|银行账号|账号|账户|帐号|卡号)[:：=\s]\s*(.+)/i,/^(\d{10,25})$/i],S=[/(?:保险公司开户行|开户行|开户银行|银行|开户行名称|银行名称)[:：=\s]\s*(.+)/i,/^(.+(?:银行|农商|信用社|邮储).+?)$/i];for(const c of U){const d=b.match(c);if(d&&d[1]&&!s.name){const m=d[1].trim();if(m.length>3&&!m.match(/^\d+$/)){s.name=m;break}}}for(const c of F){const d=b.match(c);if(d&&d[1]&&!s.account_no){const m=d[1].trim();if(m.match(/^\d{10,25}$/)){s.account_no=m;break}}}for(const c of S){const d=b.match(c);if(d&&d[1]&&!s.bank_name){const m=d[1].trim();if(m.length>3&&!m.match(/^\d+$/)){s.bank_name=m;break}}}}),s.name&&(i.name=s.name),s.account_no&&(i.account_no=s.account_no),s.bank_name&&(i.bank_name=s.bank_name);const v=[s.name,s.account_no,s.bank_name].filter(u=>u).length;v>0?C.success(`成功识别 ${v} 个字段`):C.warning("未能识别到有效信息，请检查文本格式")},ae=()=>{x.value=""},te=async()=>{f.value&&await f.value.validate(async r=>{if(r)try{await Me(i),y.value=!1,C({type:"success",message:"创建成功"}),w()}catch(e){console.error("创建保险公司失败:",e)}})},le=async()=>{f.value&&await f.value.validate(async r=>{if(r)try{await Ne(i.id,i),y.value=!1,C({type:"success",message:"更新成功"}),w()}catch(e){console.error("更新保险公司失败:",e)}})},ne=async r=>{try{await Ee.confirm("确认删除该保险公司?","提示",{type:"warning"}),await Oe(r.id),C({type:"success",message:"删除成功!"}),w()}catch(e){console.error("删除保险公司失败:",e)}};return pe(()=>{w()}),(r,e)=>{const s=De,v=ve,u=be,b=$e,U=Ue,F=ke,S=ye,c=Te,d=ze,m=xe,oe=Ie,se=Be,E=Fe,T=Se,re=Le,K=Re,ie=Pe,ue=qe,de=we;return z(),L("div",je,[n("div",Ae,[a(v,{modelValue:_.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>_.keyword=l),placeholder:"公司名称/银行账号",style:{width:"450px !important"},class:"filter-item search-input",onKeyup:_e(q,["enter"])},{prefix:t(()=>[a(s,null,{default:t(()=>[a(V(j))]),_:1})]),_:1},8,["modelValue"]),a(u,{class:"filter-item",type:"primary",onClick:q,style:{"margin-left":"10px"}},{default:t(()=>[a(s,null,{default:t(()=>[a(V(j))]),_:1}),e[15]||(e[15]=o(" 搜索 "))]),_:1,__:[15]}),a(u,{class:"filter-item",type:"primary",onClick:X,style:{"margin-left":"10px"}},{default:t(()=>[a(s,null,{default:t(()=>[a(V(Ve))]),_:1}),e[16]||(e[16]=o(" 新增保险公司 "))]),_:1,__:[16]})]),fe((z(),ge(F,{data:R.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:t(()=>[a(b,{label:"公司名称",prop:"name",align:"left","min-width":"200"}),a(b,{label:"银行账号",prop:"account_no",align:"left",width:"200"}),a(b,{label:"开户行",prop:"bank_name",align:"left","min-width":"200"}),a(b,{label:"状态",prop:"status",align:"center",width:"100"},{default:t(({row:l})=>[a(U,{type:l.status==="启用"?"success":"info"},{default:t(()=>[o(k(l.status),1)]),_:2},1032,["type"])]),_:1}),a(b,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:t(({row:l})=>[a(u,{type:"primary",link:"",onClick:M=>Z(l)},{default:t(()=>e[17]||(e[17]=[o("详情")])),_:2,__:[17]},1032,["onClick"]),a(u,{type:"primary",link:"",onClick:M=>Y(l)},{default:t(()=>e[18]||(e[18]=[o("编辑")])),_:2,__:[18]},1032,["onClick"]),a(u,{type:"danger",link:"",onClick:M=>ne(l)},{default:t(()=>e[19]||(e[19]=[o("删除")])),_:2,__:[19]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[de,I.value]]),n("div",Ge,[a(S,{"current-page":_.page,"onUpdate:currentPage":e[1]||(e[1]=l=>_.page=l),"page-size":_.limit,"onUpdate:pageSize":e[2]||(e[2]=l=>_.limit=l),"page-sizes":[10,20,50,100],total:P.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Q,onCurrentChange:H},null,8,["current-page","page-size","total"])]),a(m,{modelValue:$.value,"onUpdate:modelValue":e[4]||(e[4]=l=>$.value=l),title:"保险公司详情",width:"800px","close-on-click-modal":!1,draggable:"",class:"custom-dialog"},{footer:t(()=>[n("div",We,[a(u,{onClick:e[3]||(e[3]=l=>$.value=!1)},{default:t(()=>e[20]||(e[20]=[o("关 闭")])),_:1,__:[20]})])]),default:t(()=>[n("div",Je,[n("div",Qe,[a(d,{column:1,border:""},{default:t(()=>[a(c,{label:"公司名称"},{default:t(()=>[o(k(g.value.name),1)]),_:1}),a(c,{label:"开户行"},{default:t(()=>[o(k(g.value.bank_name),1)]),_:1}),a(c,{label:"银行账号",span:2},{default:t(()=>[o(k(g.value.account_no),1)]),_:1}),a(c,{label:"状态"},{default:t(()=>[a(U,{type:g.value.status==="启用"?"success":"info"},{default:t(()=>[o(k(g.value.status),1)]),_:1},8,["type"])]),_:1})]),_:1})]),n("div",He,[a(d,{column:1,border:""},{default:t(()=>[a(c,{label:"备注"},{default:t(()=>[o(k(g.value.remark||"-"),1)]),_:1}),a(c,{label:"创建时间"},{default:t(()=>[o(k(V(G)(g.value.created_at)),1)]),_:1}),a(c,{label:"更新时间"},{default:t(()=>[o(k(V(G)(g.value.updated_at)),1)]),_:1})]),_:1})])])]),_:1},8,["modelValue"]),a(m,{modelValue:y.value,"onUpdate:modelValue":e[14]||(e[14]=l=>y.value=l),title:B.value,width:"700px","close-on-click-modal":!1,draggable:"",class:"custom-dialog"},{footer:t(()=>[n("div",ta,[a(u,{onClick:e[12]||(e[12]=l=>y.value=!1)},{default:t(()=>e[25]||(e[25]=[o("取 消")])),_:1,__:[25]}),a(u,{type:"primary",onClick:e[13]||(e[13]=l=>D.value==="create"?te():le())},{default:t(()=>e[26]||(e[26]=[o(" 确 定 ")])),_:1,__:[26]})])]),default:t(()=>[D.value==="create"?(z(),L("div",Xe,[a(se,null,{header:t(()=>[n("div",Ye,[e[21]||(e[21]=n("span",null,"智能识别",-1)),a(u,{type:"text",onClick:e[5]||(e[5]=l=>h.value=!h.value)},{default:t(()=>[o(k(h.value?"隐藏示例":"查看示例"),1)]),_:1})])]),default:t(()=>[h.value?(z(),L("div",Ze,[a(oe,{title:"使用说明",type:"info",closable:!1,"show-icon":""},{default:t(()=>e[22]||(e[22]=[n("div",{class:"example-text"},[n("p",null,'将包含保险公司信息的文本粘贴到下方文本框，点击"智能识别"即可自动填充表单。'),n("p",null,[n("strong",null,"支持格式示例：")]),n("div",{class:"example-block"},[n("strong",null,"格式一："),n("br"),o(" 保险公司账号: 44501001040020093"),n("br"),o(" 保险公司名称: 永安财产保险股份有限公司佛山中心支公司"),n("br"),o(" 保险公司开户行: 中国农业银行股份有限公司南海分行"),n("br"),n("br"),n("strong",null,"格式二："),n("br"),o(" 公司名称：中国平安财产保险股份有限公司"),n("br"),o(" 银行账号：123456789012345678"),n("br"),o(" 开户行：中国工商银行股份有限公司北京分行"),n("br"),n("br"),n("strong",null,"格式三（自动识别）："),n("br"),o(" 太平洋财产保险股份有限公司广州分公司"),n("br"),o(" 98765432101234567890"),n("br"),o(" 招商银行股份有限公司深圳分行 ")])],-1)])),_:1,__:[22]})])):A("",!0),n("div",ea,[a(v,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=l=>x.value=l),type:"textarea",rows:4,placeholder:"请将包含保险公司信息的文本粘贴到这里...",maxlength:"1000","show-word-limit":""},null,8,["modelValue"]),n("div",aa,[a(u,{type:"primary",onClick:ee,disabled:!x.value.trim()},{default:t(()=>[a(s,null,{default:t(()=>[a(V(Ce))]),_:1}),e[23]||(e[23]=o(" 智能识别 "))]),_:1,__:[23]},8,["disabled"]),a(u,{onClick:ae},{default:t(()=>[a(s,null,{default:t(()=>[a(V(he))]),_:1}),e[24]||(e[24]=o(" 清空 "))]),_:1,__:[24]})])])]),_:1})])):A("",!0),a(ue,{ref_key:"dataFormRef",ref:f,model:i,rules:J,"label-position":"right","label-width":"120px",class:"form-container"},{default:t(()=>[a(re,{gutter:20},{default:t(()=>[a(T,{span:24},{default:t(()=>[a(E,{label:"公司名称",prop:"name"},{default:t(()=>[a(v,{modelValue:i.name,"onUpdate:modelValue":e[7]||(e[7]=l=>i.name=l),placeholder:"请输入公司名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(T,{span:24},{default:t(()=>[a(E,{label:"开户行",prop:"bank_name"},{default:t(()=>[a(v,{modelValue:i.bank_name,"onUpdate:modelValue":e[8]||(e[8]=l=>i.bank_name=l),placeholder:"请输入开户行",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),a(T,{span:24},{default:t(()=>[a(E,{label:"银行账号",prop:"account_no"},{default:t(()=>[a(v,{modelValue:i.account_no,"onUpdate:modelValue":e[9]||(e[9]=l=>i.account_no=l),placeholder:"请输入银行账号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(T,{span:12},{default:t(()=>[a(E,{label:"状态",prop:"status"},{default:t(()=>[a(ie,{modelValue:i.status,"onUpdate:modelValue":e[10]||(e[10]=l=>i.status=l),placeholder:"请选择状态",clearable:""},{default:t(()=>[a(K,{label:"启用",value:"启用"}),a(K,{label:"禁用",value:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(E,{label:"备注",prop:"remark"},{default:t(()=>[a(v,{modelValue:i.remark,"onUpdate:modelValue":e[11]||(e[11]=l=>i.remark=l),type:"textarea",rows:3,placeholder:"请输入备注信息",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ba=ce(la,[["__scopeId","data-v-5188ca91"]]);export{ba as default};
