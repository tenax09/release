import{_ as J,g as Q,c as H,d as W,e as X}from"./index-977e0fd9.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                      *//* empty css                        */import{b as S,r as p,ae as Y,l as h,B as Z,C as r,F as l,G as t,a1 as ee,af as le,p as B,a5 as ae,K as te,an as oe,aS as se,M as ne,ai as re,u as v,V as ie,aT as de,O as d,as as ue,D as x,S as me,J as pe,E as k,a2 as ge,al as ce,am as _e,a6 as fe,ax as ve,ay as be,a7 as we}from"./element-plus-eb4b90a0.js";import{f as ye}from"./format-20468769.js";const Ve={class:"admin-container"},he={class:"filter-container"},xe={class:"pagination"},ke={class:"form-section"},Ce={class:"form-content"},Ee={class:"form-section"},ze={class:"form-content"},Ue={class:"dialog-footer"},qe={__name:"index",setup(Se){const n=S({page:1,page_size:10,keyword:""}),C=p([]),E=p(0),b=p(!1),g=p(!1),w=p(""),_=p(""),y=p(),o=S({id:void 0,username:"",name:"",mobile:"",email:"",role:"",status:"启用",password:""}),D={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},f=async()=>{b.value=!0;try{const s=await Q(n);C.value=s.data.list,E.value=s.data.total}catch(s){console.error("获取管理员列表失败:",s)}b.value=!1},z=()=>{n.page=1,f()},T=s=>s||"未设置",I=()=>{w.value="新增员工",_.value="create",g.value=!0,Object.assign(o,{id:void 0,username:"",name:"",mobile:"",email:"",role:"",status:"启用",password:""})},N=s=>{w.value="修改员工",_.value="update",g.value=!0,Object.assign(o,s)},P=s=>{pe.confirm("确认要重置该员工的密码吗？","警告",{type:"warning"}).then(async()=>{try{await H(s.id),k.success("密码重置成功")}catch(e){console.error("重置密码失败:",e)}})},A=async()=>{y.value&&await y.value.validate(async s=>{if(s)try{_.value==="update"?(await W(o.id,o),k.success("修改成功")):(await X(o),k.success("新增成功")),g.value=!1,f()}catch(e){console.error("提交表单失败:",e)}})},F=s=>{n.page_size=s,f()},L=s=>{n.page=s,f()};return Y(()=>{f()}),(s,e)=>{const V=ge,u=ae,c=te,i=ce,U=_e,M=oe,O=se,m=fe,q=ve,R=be,j=we,K=ne,$=re;return h(),Z("div",Ve,[r("div",he,[l(u,{modelValue:n.keyword,"onUpdate:modelValue":e[0]||(e[0]=a=>n.keyword=a),placeholder:"用户名/姓名",style:{width:"200px"},class:"filter-item",onKeyup:ee(z,["enter","native"])},{prefix:t(()=>[l(V,null,{default:t(()=>[l(v(ie))]),_:1})]),_:1},8,["modelValue"]),l(c,{class:"filter-item",type:"primary",onClick:z},{default:t(()=>[l(V,null,{default:t(()=>[l(v(de))]),_:1}),e[12]||(e[12]=d(" 搜索 "))]),_:1,__:[12]}),l(c,{class:"filter-item",type:"primary",onClick:I},{default:t(()=>[l(V,null,{default:t(()=>[l(v(ue))]),_:1}),e[13]||(e[13]=d(" 新增员工 "))]),_:1,__:[13]})]),le((h(),B(M,{data:C.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:t(()=>[l(i,{label:"ID",prop:"id",align:"center",width:"80"}),l(i,{label:"用户名",prop:"username",align:"center","min-width":"120"}),l(i,{label:"姓名",prop:"name",align:"center","min-width":"120"}),l(i,{label:"手机号",prop:"mobile",align:"center",width:"120"}),l(i,{label:"邮箱",prop:"email",align:"center",width:"180"}),l(i,{label:"角色",prop:"role",align:"center",width:"120"},{default:t(({row:a})=>[l(U,null,{default:t(()=>[d(x(T(a.role)),1)]),_:2},1024)]),_:1}),l(i,{label:"状态",prop:"status",align:"center",width:"100"},{default:t(({row:a})=>[l(U,{type:a.status==="启用"?"success":"danger"},{default:t(()=>[d(x(a.status),1)]),_:2},1032,["type"])]),_:1}),l(i,{label:"创建时间",prop:"created_at",align:"center",width:"180"},{default:t(({row:a})=>[d(x(v(ye)(a.created_at)),1)]),_:1}),l(i,{label:"操作",align:"center",width:"150",fixed:"right"},{default:t(({row:a})=>[l(c,{type:"primary",link:"",onClick:G=>N(a)},{default:t(()=>e[14]||(e[14]=[d("编辑")])),_:2,__:[14]},1032,["onClick"]),l(c,{type:"success",link:"",onClick:G=>P(a)},{default:t(()=>e[15]||(e[15]=[d("重置密码")])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,b.value]]),r("div",xe,[l(O,{"current-page":n.page,"onUpdate:currentPage":e[1]||(e[1]=a=>n.page=a),"page-size":n.page_size,"onUpdate:pageSize":e[2]||(e[2]=a=>n.page_size=a),"page-sizes":[10,20,50,100],total:E.value,background:!0,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:L},null,8,["current-page","page-size","total"])]),l(K,{title:w.value,modelValue:g.value,"onUpdate:modelValue":e[11]||(e[11]=a=>g.value=a),width:"800px","append-to-body":"",draggable:"","destroy-on-close":"","close-on-click-modal":!1},{footer:t(()=>[r("div",Ue,[l(c,{onClick:e[10]||(e[10]=a=>g.value=!1)},{default:t(()=>e[19]||(e[19]=[d("取 消")])),_:1,__:[19]}),l(c,{type:"primary",onClick:A},{default:t(()=>e[20]||(e[20]=[d("确 定")])),_:1,__:[20]})])]),default:t(()=>[l(j,{ref_key:"formRef",ref:y,model:o,rules:D,"label-width":"100px",class:"dialog-form"},{default:t(()=>[r("div",ke,[e[16]||(e[16]=r("div",{class:"section-title"},"基本信息",-1)),r("div",Ce,[l(m,{label:"用户名",prop:"username"},{default:t(()=>[l(u,{modelValue:o.username,"onUpdate:modelValue":e[3]||(e[3]=a=>o.username=a),disabled:_.value==="update",placeholder:"请输入用户名",maxlength:"20","show-word-limit":""},null,8,["modelValue","disabled"])]),_:1}),l(m,{label:"姓名",prop:"name"},{default:t(()=>[l(u,{modelValue:o.name,"onUpdate:modelValue":e[4]||(e[4]=a=>o.name=a),placeholder:"请输入姓名",maxlength:"20","show-word-limit":""},null,8,["modelValue"])]),_:1}),l(m,{label:"手机号",prop:"mobile"},{default:t(()=>[l(u,{modelValue:o.mobile,"onUpdate:modelValue":e[5]||(e[5]=a=>o.mobile=a),placeholder:"请输入手机号",maxlength:"11"},null,8,["modelValue"])]),_:1}),l(m,{label:"邮箱",prop:"email"},{default:t(()=>[l(u,{modelValue:o.email,"onUpdate:modelValue":e[6]||(e[6]=a=>o.email=a),placeholder:"请输入邮箱",maxlength:"50"},null,8,["modelValue"])]),_:1})])]),r("div",Ee,[e[18]||(e[18]=r("div",{class:"section-title"},"其他信息",-1)),r("div",ze,[l(m,{label:"角色",prop:"role",class:"full-width"},{default:t(()=>[l(u,{modelValue:o.role,"onUpdate:modelValue":e[7]||(e[7]=a=>o.role=a),placeholder:"请输入角色名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"]),e[17]||(e[17]=r("div",{class:"form-tip"}," 常用角色：运营 运营主管 风控 风控主管 财务 超级管理员 ",-1))]),_:1,__:[17]}),l(m,{label:"状态",prop:"status"},{default:t(()=>[l(R,{modelValue:o.status,"onUpdate:modelValue":e[8]||(e[8]=a=>o.status=a),placeholder:"请选择状态",style:{width:"100%"}},{default:t(()=>[l(q,{label:"启用",value:"启用"}),l(q,{label:"禁用",value:"禁用"})]),_:1},8,["modelValue"])]),_:1}),_.value==="create"?(h(),B(m,{key:0,label:"密码",prop:"password"},{default:t(()=>[l(u,{modelValue:o.password,"onUpdate:modelValue":e[9]||(e[9]=a=>o.password=a),type:"password",placeholder:"请输入密码",maxlength:"20","show-password":""},null,8,["modelValue"])]),_:1})):me("",!0)])])]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},Le=J(qe,[["__scopeId","data-v-7782916c"]]);export{Le as default};
