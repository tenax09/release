import{r as F,_ as X}from"./index-49cf57c0.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                      *//* empty css                        */import{r as d,ae as Z,l as g,B as K,C as U,F as a,G as o,a1 as ee,af as ae,p as z,E as _,a5 as le,K as te,an as oe,aM as ne,M as de,ai as re,u as D,Q as ie,aN as se,O as b,as as ue,H as L,I as O,J as me,a2 as pe,al as _e,ax as fe,ay as ve,a6 as ce,a7 as ge}from"./element-plus-f067b2d4.js";import{g as he,a as we}from"./template-2391263c.js";function ye(f){return F({url:"/api/admin/dictionaries",method:"get",params:f})}function be(f){return F({url:"/api/admin/dictionaries",method:"post",data:f})}function Ve(f){return F({url:`/api/admin/dictionaries/${f}`,method:"delete"})}const ke={class:"dictionary-container"},xe={class:"filter-container"},Ce={class:"pagination-container"},Ee={class:"dialog-footer"},Ke={__name:"index",setup(f){const h=d(!1),T=d([]),r=d({keyword:"",page:1,page_size:20}),q=d(0),w=d(!1),V=d(!1),k=d(null),t=d({template_id:"",template_name:"",sheet_name:"",show_name:"",field_name:"",fadada_key:"",fadada_field:""}),I={template_id:[{required:!0,message:"请选择模板",trigger:"change"}],template_name:[{required:!0,message:"模板名称不能为空",trigger:"blur"}],sheet_name:[{required:!0,message:"请选择表名",trigger:"change"}],show_name:[{required:!0,message:"请输入显示名称",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}],field_name:[{required:!0,message:"请输入字段名",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}],fadada_key:[{required:!0,message:"请选择法大大KEY",trigger:"change"}]},x=d([]),m=d([]),C=d(!1),M=async()=>{try{const n=await he();x.value=n.data}catch{_.error("获取模板列表失败")}},S=async n=>{if(!n){m.value=[];return}C.value=!0;try{const e=await we(n);m.value=e.data||[]}catch(e){console.error("获取法大大模板字段失败:",e),_.error("获取法大大模板字段失败"),m.value=[]}C.value=!1},v=async()=>{h.value=!0;try{const n=await ye(r.value);T.value=n.data.list,q.value=n.data.total}catch{_.error("获取列表失败")}h.value=!1},B=()=>{v()},Y=()=>{t.value={template_id:"",template_name:"",sheet_name:"",show_name:"",field_name:"",fadada_key:"",fadada_field:""},m.value=[],M(),w.value=!0},N=n=>{const e=x.value.find(p=>p.id===n);e?(t.value.template_id=e.template_id,t.value.template_name=e.template_name,S(e.template_id)):(t.value.template_id="",t.value.template_name="",m.value=[]),t.value.fadada_key="",t.value.fadada_field=""},R=n=>{if(!n){t.value.fadada_field="";return}const e=m.value.find(p=>p.name===n);e?t.value.fadada_field=e.key:t.value.fadada_field=""},$=async()=>{k.value&&await k.value.validate(async n=>{if(n){V.value=!0;try{await be(t.value),_.success("创建成功"),w.value=!1,v()}catch{_.error("创建失败")}V.value=!1}})},P=async n=>{try{await me.confirm("确定要删除该字典吗？","提示",{type:"warning"}),h.value=!0,await Ve(n.id),_.success("删除成功"),v()}catch(e){e!=="cancel"&&_.error("删除失败")}h.value=!1},G=n=>{r.value.page_size=n,v()},H=n=>{r.value.page=n,v()};return Z(()=>{v()}),(n,e)=>{const p=pe,c=le,y=te,i=_e,J=oe,Q=ne,s=fe,E=ve,u=ce,j=ge,A=de,W=re;return g(),K("div",ke,[U("div",xe,[a(c,{modelValue:r.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.keyword=l),placeholder:"字典名称/模板编号",style:{width:"200px"},class:"filter-item",onKeyup:ee(B,["enter"])},{prefix:o(()=>[a(p,null,{default:o(()=>[a(D(ie))]),_:1})]),_:1},8,["modelValue"]),a(y,{class:"filter-item",type:"primary",onClick:B},{default:o(()=>[a(p,null,{default:o(()=>[a(D(se))]),_:1}),e[13]||(e[13]=b(" 搜索 "))]),_:1,__:[13]}),a(y,{class:"filter-item",type:"primary",onClick:Y},{default:o(()=>[a(p,null,{default:o(()=>[a(D(ue))]),_:1}),e[14]||(e[14]=b(" 新建字典 "))]),_:1,__:[14]})]),ae((g(),z(J,{data:T.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:o(()=>[a(i,{prop:"id",label:"ID",width:"80"}),a(i,{prop:"template_id",label:"模板编号","min-width":"120","show-overflow-tooltip":""}),a(i,{prop:"template_name",label:"模板名称","min-width":"150","show-overflow-tooltip":""}),a(i,{prop:"sheet_name",label:"表名","min-width":"120","show-overflow-tooltip":""}),a(i,{prop:"show_name",label:"显示名称","min-width":"150","show-overflow-tooltip":""}),a(i,{prop:"field_name",label:"字段名","min-width":"120","show-overflow-tooltip":""}),a(i,{prop:"fadada_key",label:"法大大KEY","min-width":"120","show-overflow-tooltip":""}),a(i,{prop:"fadada_field",label:"法大大字段","min-width":"120","show-overflow-tooltip":""}),a(i,{label:"操作",width:"100",fixed:"right"},{default:o(({row:l})=>[a(y,{type:"danger",link:"",onClick:Ue=>P(l)},{default:o(()=>e[15]||(e[15]=[b("删除")])),_:2,__:[15]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[W,h.value]]),U("div",Ce,[a(Q,{"current-page":r.value.page,"onUpdate:currentPage":e[1]||(e[1]=l=>r.value.page=l),"page-size":r.value.page_size,"onUpdate:pageSize":e[2]||(e[2]=l=>r.value.page_size=l),"page-sizes":[10,20,50,100],total:q.value,layout:"total, sizes, prev, pager, next",onSizeChange:G,onCurrentChange:H},null,8,["current-page","page-size","total"])]),a(A,{modelValue:w.value,"onUpdate:modelValue":e[12]||(e[12]=l=>w.value=l),title:"新建字典",width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:o(()=>[U("div",Ee,[a(y,{onClick:e[11]||(e[11]=l=>w.value=!1)},{default:o(()=>e[16]||(e[16]=[b("取 消")])),_:1,__:[16]}),a(y,{type:"primary",onClick:$,loading:V.value},{default:o(()=>e[17]||(e[17]=[b("确 定")])),_:1,__:[17]},8,["loading"])])]),default:o(()=>[a(j,{ref_key:"createFormRef",ref:k,model:t.value,rules:I,"label-width":"100px"},{default:o(()=>[a(u,{label:"选择模板",prop:"template_id"},{default:o(()=>[a(E,{modelValue:t.value.template_id,"onUpdate:modelValue":e[3]||(e[3]=l=>t.value.template_id=l),placeholder:"请选择模板",onChange:N,style:{width:"100%"}},{default:o(()=>[(g(!0),K(L,null,O(x.value,l=>(g(),z(s,{key:l.id,label:l.template_name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"模板编号",prop:"template_id"},{default:o(()=>[a(c,{modelValue:t.value.template_id,"onUpdate:modelValue":e[4]||(e[4]=l=>t.value.template_id=l),placeholder:"请输入模板编号",maxlength:"50","show-word-limit":"",disabled:""},null,8,["modelValue"])]),_:1}),a(u,{label:"模板名称",prop:"template_name"},{default:o(()=>[a(c,{modelValue:t.value.template_name,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.template_name=l),placeholder:"请输入模板名称",maxlength:"200","show-word-limit":"",disabled:""},null,8,["modelValue"])]),_:1}),a(u,{label:"表名",prop:"sheet_name"},{default:o(()=>[a(E,{modelValue:t.value.sheet_name,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.sheet_name=l),placeholder:"请选择表名",style:{width:"100%"}},{default:o(()=>[a(s,{label:"订单表 (order)",value:"order"}),a(s,{label:"用户表 (user)",value:"user"}),a(s,{label:"资方表 (funder)",value:"funder"}),a(s,{label:"产品表 (product)",value:"product"}),a(s,{label:"保险公司表 (insurer)",value:"insurer"}),a(s,{label:"其他 (-)",value:"-"})]),_:1},8,["modelValue"])]),_:1}),a(u,{label:"显示名称",prop:"show_name"},{default:o(()=>[a(c,{modelValue:t.value.show_name,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.show_name=l),placeholder:"请输入显示名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(u,{label:"字段名",prop:"field_name"},{default:o(()=>[a(c,{modelValue:t.value.field_name,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.field_name=l),placeholder:"请输入字段名",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),a(u,{label:"法大大KEY",prop:"fadada_key"},{default:o(()=>[a(E,{modelValue:t.value.fadada_key,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.fadada_key=l),placeholder:"请选择法大大KEY",style:{width:"100%"},filterable:"",loading:C.value,onChange:R},{default:o(()=>[(g(!0),K(L,null,O(m.value,l=>(g(),z(s,{key:l.key,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1}),a(u,{label:"法大大字段"},{default:o(()=>[a(c,{modelValue:t.value.fadada_field,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.fadada_field=l),placeholder:"选择法大大KEY后自动填充",readonly:"",style:{"background-color":"#f5f7fa"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Ie=X(Ke,[["__scopeId","data-v-d1155d49"]]);export{Ie as default};
