import{_ as K}from"./index-31409f0b.js";/* empty css               *//* empty css                        *//* empty css                     */import{r as i,ae as L,l as x,B as N,C as V,F as t,G as a,a1 as $,af as q,p as S,E as s,a5 as G,K as J,an as O,M as P,ai as Q,u as f,Q as W,aR as j,O as d,as as z,D as A,J as H,a2 as X,al as Y,a6 as Z,a7 as ee}from"./element-plus-3147ea74.js";import{g as te,p as ae,c as le,d as oe}from"./template-93036933.js";import{f as re}from"./format-20468769.js";const se={class:"template-container"},ne={class:"filter-container"},ie={class:"dialog-footer"},de={__name:"list",setup(me){const u=i(!1),b=i([]),v=i({keyword:""}),p=i(!1),w=i(!1),g=i(null),r=i({template_name:"",template_id:""}),C={template_name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{max:200,message:"长度不能超过200个字符",trigger:"blur"}],template_id:[{required:!0,message:"请输入模板编号",trigger:"blur"},{max:50,message:"长度不能超过50个字符",trigger:"blur"}]},c=async()=>{u.value=!0;try{const o=await te(v.value);b.value=o.data}catch{s.error("获取列表失败")}u.value=!1},h=()=>{c()},E=()=>{r.value={template_name:"",template_id:""},p.value=!0},D=async o=>{try{const e=await ae(o.id),n=window.open("","_blank");n?(n.document.write(e.data),n.document.close(),s.success("正在打开预览页面")):s.warning("请允许打开新窗口")}catch(e){console.error("预览失败:",e),s.error("预览失败")}},B=async()=>{g.value&&await g.value.validate(async o=>{if(o){w.value=!0;try{const e={template_name:r.value.template_name,template_id:r.value.template_id};await le(e),s.success("创建成功"),p.value=!1,c()}catch{s.error("创建失败")}w.value=!1}})},F=async o=>{try{await H.confirm("确定要删除该模板吗？","提示",{type:"warning"}),u.value=!0,await oe(o.id),s.success("删除成功"),c()}catch(e){e!=="cancel"&&s.error("删除失败")}u.value=!1};return L(()=>{c()}),(o,e)=>{const n=X,y=G,m=J,_=Y,T=O,k=Z,I=ee,M=P,R=Q;return x(),N("div",se,[V("div",ne,[t(y,{modelValue:v.value.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>v.value.keyword=l),placeholder:"模板名称/编号",style:{width:"200px"},class:"filter-item",onKeyup:$(h,["enter"])},{prefix:a(()=>[t(n,null,{default:a(()=>[t(f(W))]),_:1})]),_:1},8,["modelValue"]),t(m,{class:"filter-item",type:"primary",onClick:h},{default:a(()=>[t(n,null,{default:a(()=>[t(f(j))]),_:1}),e[5]||(e[5]=d(" 搜索 "))]),_:1,__:[5]}),t(m,{class:"filter-item",type:"primary",onClick:E},{default:a(()=>[t(n,null,{default:a(()=>[t(f(z))]),_:1}),e[6]||(e[6]=d(" 新建模板 "))]),_:1,__:[6]})]),q((x(),S(T,{data:b.value,border:"",fit:"","highlight-current-row":"",style:{width:"100%"}},{default:a(()=>[t(_,{prop:"id",label:"ID",width:"80"}),t(_,{prop:"template_name",label:"模板名称","min-width":"200","show-overflow-tooltip":""}),t(_,{prop:"template_id",label:"模板编号","min-width":"150","show-overflow-tooltip":""}),t(_,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:l})=>[d(A(f(re)(l.created_at)),1)]),_:1}),t(_,{label:"操作",width:"150",fixed:"right"},{default:a(({row:l})=>[t(m,{type:"primary",link:"",onClick:U=>D(l)},{default:a(()=>e[7]||(e[7]=[d("预览")])),_:2,__:[7]},1032,["onClick"]),t(m,{type:"danger",link:"",onClick:U=>F(l)},{default:a(()=>e[8]||(e[8]=[d("删除")])),_:2,__:[8]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,u.value]]),t(M,{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=l=>p.value=l),title:"新建模板",width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[V("div",ie,[t(m,{onClick:e[3]||(e[3]=l=>p.value=!1)},{default:a(()=>e[9]||(e[9]=[d("取 消")])),_:1,__:[9]}),t(m,{type:"primary",onClick:B,loading:w.value},{default:a(()=>e[10]||(e[10]=[d("确 定")])),_:1,__:[10]},8,["loading"])])]),default:a(()=>[t(I,{ref_key:"createFormRef",ref:g,model:r.value,rules:C,"label-width":"100px"},{default:a(()=>[t(k,{label:"模板名称",prop:"template_name"},{default:a(()=>[t(y,{modelValue:r.value.template_name,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value.template_name=l),placeholder:"请输入模板名称",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(k,{label:"模板编号",prop:"template_id"},{default:a(()=>[t(y,{modelValue:r.value.template_id,"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.template_id=l),placeholder:"请输入模板编号",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ge=K(de,[["__scopeId","data-v-ac42f701"]]);export{ge as default};
