import{r as ga,_ as ya,u as ba,b as wa,a as ka}from"./index-36afcd41.js";/* empty css               *//* empty css                   *//* empty css                    *//* empty css                 *//* empty css                       *//* empty css                     *//* empty css                        *//* empty css               *//* empty css                       *//* empty css                  *//* empty css                         *//* empty css                        *//* empty css                *//* empty css                             *//* empty css                       */import{r as c,j as Va,b as A,ae as Ca,l as f,B as D,C as m,F as t,G as a,af as de,p as v,E as i,aE as xa,ag as Ra,M as Ia,ai as Ea,u as k,O as r,S as g,D as u,H as h,I as ee,aU as we,aw as Da,aV as Fa,J as ae,K as Ua,az as za,am as Ma,aA as Pa,al as Ba,an as Ta,ap as $a,aq as Aa,ax as Sa,ay as qa,a6 as Na,ao as Ya,aW as ja,aX as La,a5 as Oa,ah as Ga,aO as Ja,aP as Ha,a7 as Ka,aB as Wa,a2 as Xa,aC as Qa,aD as Za}from"./element-plus-3147ea74.js";import{a as ha,b as et,r as S,v as at,e as tt,f as lt,h as ot,i as nt}from"./user-17a5748b.js";import{g as rt}from"./agent-a36ca60f.js";import{g as st}from"./product-4c55ff99.js";import{g as it}from"./insurer-03de07b5.js";import{f as _e}from"./format-20468769.js";import{u as ut}from"./uuid2url-fe9c9b11.js";function dt(pe){const J=new FormData;return J.append("image",pe),ga({url:"/api/admin/ocr/biz-license",method:"post",data:J,headers:{"Content-Type":"multipart/form-data"}})}const _t={class:"user-detail"},pt={class:"page-header"},mt={class:"header-actions"},ft={class:"log-content"},ct={class:"operator"},vt={class:"action"},gt={class:"dialog-footer"},yt={class:"review-content"},bt={class:"dialog-footer"},wt={class:"review-content"},kt={class:"dialog-footer"},Vt={class:"review-content"},Ct={class:"dialog-footer"},xt={class:"upload-section"},Rt={class:"upload-area"},It={key:0,class:"ocr-loading"},Et={key:1,class:"ocr-result"},Dt={class:"result-content"},Ft={class:"dialog-footer"},Ut={class:"dialog-footer"},zt={__name:"detail",setup(pe){const J=ba(),ke=wa(),x=ka(),te=c(!1),n=c({}),le=c([]),me=c([]),H=c([]),F=c(!1),U=c(!1),z=c(!1),q=c(!1),N=c(!1),Y=c(!1),j=c(!1),oe=c(null),Ve=Va(()=>j.value?"编辑用户配置":"添加用户配置"),ne=c(),Ce=c(),xe=c(),Re=c(),re=c(),se=c(),p=A({product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0}),R=A({audit_note:""}),I=A({audit_note:""}),M=A({audit_note:""}),w=A({company_name:"",organization:""}),L=A({insurer_id:void 0}),K=c(!1),P=c(null),Ie=c(),Ee={product_id:[{required:!0,message:"请选择产品",trigger:"change"}],sell_mode:[{required:!0,message:"请选择销售模式",trigger:"change"}],agent_id:[{required:!1,message:"请选择渠道商",trigger:"change"}],seller:[{required:!1,message:"请输入销售员姓名",trigger:"blur"}],insurance_type:[{required:!1,message:"请选择主要险种",trigger:"change"}],overdue_date:[{required:!1,message:"请选择过期时间",trigger:"change"}]},ie={audit_note:[{required:!1,message:"请输入审核备注",trigger:"blur"}]},De={company_name:[{required:!0,message:"请输入公司名称",trigger:"blur"}],organization:[{required:!1,message:"请输入统一社会信用代码",trigger:"blur"}]},Fe={insurer_id:[{required:!0,message:"请选择保险公司",trigger:"change"}]},b=async()=>{te.value=!0;try{const l=await ha(ke.params.id);n.value=l.data}catch(l){console.error("获取用户详情失败:",l),i.error("获取用户详情失败")}te.value=!1},Ue=async()=>{try{const l=await rt({page:1,page_size:1e3});le.value=l.data.list}catch(l){console.error("获取渠道商列表失败:",l)}},ze=async()=>{try{const l=await st({page:1,page_size:1e3});me.value=l.data.list}catch(l){console.error("获取产品列表失败:",l)}},Me=async()=>{try{const l=await it({page:1,page_size:1e3});H.value=l.data.list}catch(l){console.error("获取保险公司列表失败:",l)}},Pe=l=>{if(!l){p.seller="";return}const e=le.value.find(s=>s.id===l);e&&(p.seller=e.seller||e.contact_name||e.company_name||"")},Be=()=>{J.back()},Te=()=>{j.value=!1,oe.value=null,F.value=!0,Object.assign(p,{product_id:void 0,sell_mode:"渠道",agent_id:void 0,seller:"",insurance_type:"",agent_cost:void 0,service_fee:void 0,overdue_date:void 0})},$e=l=>{j.value=!0,oe.value=l.id,Object.assign(p,{product_id:l.product_id,sell_mode:l.sell_mode,agent_id:l.agent_id||void 0,seller:l.seller||"",insurance_type:l.insurance_type||"",agent_cost:l.agent_cost||void 0,service_fee:l.service_fee||void 0,overdue_date:l.overdue_date?new Date(l.overdue_date):void 0}),F.value=!0},Ae=l=>{ae.confirm("确认要删除该配置吗？","提示",{type:"warning"}).then(async()=>{try{await et(l.id),i.success("删除配置成功"),b()}catch(e){console.error("删除配置失败:",e),i.error("删除配置失败")}})},Se=()=>{N.value=!0,w.company_name="",w.organization="",K.value=!1,P.value=null},qe=()=>{Y.value=!0,L.insurer_id=void 0},Ne=()=>{U.value=!0,R.audit_note=""},Ye=()=>{z.value=!0,I.audit_note=""},je=()=>{q.value=!0,M.audit_note=""},Le=()=>{ae.confirm("确认要停用该用户吗？","提示",{type:"warning"}).then(async()=>{await S(n.value.id,{status:"已停用"}),i.success("用户已停用"),b()})},Oe=()=>{ae.confirm("确认要为该用户添加认证吗？","提示",{type:"warning"}).then(async()=>{try{await at(n.value.id),i.success("添加认证成功"),b()}catch(l){console.error("添加认证失败:",l),i.error("添加认证失败")}})},Ge=()=>{if(!n.value.verify_url){i.error("认证链接不存在");return}try{if(typeof window<"u"&&window.open)window.open(n.value.verify_url,"_blank");else{const l=document.createElement("a");l.href=n.value.verify_url,l.target="_blank",l.rel="noopener noreferrer",document.body.appendChild(l),l.click(),document.body.removeChild(l)}}catch(l){console.error("打开认证链接失败:",l),i.error("无法打开认证链接，请手动复制链接访问")}},Je=()=>{if(!n.value.verify_url){i.error("认证链接不存在");return}navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(n.value.verify_url).then(()=>{i.success("认证链接已复制到剪贴板")}).catch(l=>{console.error("使用 Clipboard API 复制失败:",l),fe(n.value.verify_url)}):fe(n.value.verify_url)},fe=l=>{try{const e=document.createElement("textarea");e.value=l,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");if(document.body.removeChild(e),s)i.success("认证链接已复制到剪贴板");else throw new Error("execCommand 复制失败")}catch(e){console.error("复制失败:",e),ae.alert(n.value.verify_url,"请手动复制认证链接",{confirmButtonText:"确定",type:"info"})}},He=async()=>{try{await S(n.value.id,{status:"待终审",audit_note:R.audit_note||"初审通过"}),i.success("初审通过，用户进入终审阶段"),U.value=!1,b()}catch(l){console.error("初审操作失败:",l),i.error("初审操作失败")}},Ke=async()=>{if(!R.audit_note.trim()){i.warning("打回修改时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:R.audit_note}),i.success("已打回修改"),U.value=!1,b()}catch(l){console.error("初审操作失败:",l),i.error("初审操作失败")}},We=async()=>{try{await S(n.value.id,{status:"审核通过",audit_note:I.audit_note||"终审通过"}),i.success("审核通过，用户可正常使用系统"),z.value=!1,b()}catch(l){console.error("终审操作失败:",l),i.error("终审操作失败")}},Xe=async()=>{if(!I.audit_note.trim()){i.warning("退回初审时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:I.audit_note}),i.success("已退回初审"),z.value=!1,b()}catch(l){console.error("终审操作失败:",l),i.error("终审操作失败")}},Qe=async()=>{if(!M.audit_note.trim()){i.warning("重置状态时必须填写原因");return}try{await S(n.value.id,{status:"待初审",audit_note:M.audit_note}),i.success("状态已重置为待初审"),q.value=!1,b()}catch(l){console.error("重置状态失败:",l),i.error("重置状态失败")}},W=l=>{ut(l).then(e=>{window.open(e,"_blank")})},Ze=async()=>{ne.value&&await ne.value.validate(async l=>{if(l)try{const e={...p,overdue_date:p.overdue_date?_e(p.overdue_date,"YYYY-MM-DD"):null};p.sell_mode==="直销"&&(e.agent_id=null,e.agent_cost=0),j.value?(await tt(oe.value,e),i.success("配置更新成功")):(await lt(n.value.id,e),i.success("配置添加成功")),F.value=!1,b()}catch(e){console.error("配置操作失败:",e),i.error("配置操作失败")}})},he=async()=>{re.value&&await re.value.validate(async l=>{var e,s;if(l)try{await ot(n.value.id,{company_name:w.company_name,organization:w.organization}),i.success("添加被保险人成功"),N.value=!1,b()}catch(_){console.error("添加被保险人失败:",_),i.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"添加被保险人失败")}})},ea=async()=>{se.value&&await se.value.validate(async l=>{var e,s;if(l)try{await nt(n.value.id,{insurer_id:L.insurer_id}),i.success("添加保险公司成功"),Y.value=!1,b()}catch(_){console.error("添加保险公司失败:",_),i.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"添加保险公司失败")}})},aa=l=>({待初审:"warning",待终审:"primary",审核通过:"success",已停用:"info"})[l]||"info",ce=l=>({未认证:"info",管理员资料已提交:"warning",企业基本资料已提交:"warning",已提交待审核:"warning",审核通过:"success",审核不通过:"danger",人工初审通过:"primary"})[l]||"info",ta=l=>({create:"primary",update:"success",review:"warning",delete:"danger",audit_pass:"success",audit_reject:"danger",audit_pending:"warning",initial_review:"primary",final_review:"warning",reset_status:"info",update_config:"info"})[l]||"info",la=l=>!l||!H.value.length?"":l.split(",").map(_=>parseInt(_.trim())).filter(_=>!isNaN(_)).map(_=>{const d=H.value.find(O=>O.id===_);return d?d.name:""}).filter(_=>_).join("、"),oa=l=>{if(!l)return"";let e=l.name||"";if(l.account_no&&l.account_no.length>=4){const s=l.account_no.slice(-4);e+=` (${s})`}return e},na=l=>!l||l.trim()===""?[]:l.split(";").map(e=>{const s=e.split(",");return{company_name:s[0]||"",organization:s[1]||""}}).filter(e=>e.company_name.trim()!==""||e.organization.trim()!==""),ra=l=>{const e=na(l||"");return e.length===0?"":e.map(s=>s.company_name).join("、")},sa=l=>{const e=l.raw;if(!["image/jpeg","image/jpg","image/png","image/bmp"].includes(e.type)){i.error("只支持 JPG、PNG、BMP 格式的图片");return}const _=5*1024*1024;if(e.size>_){i.error("图片大小不能超过 5MB");return}ia(e)},ia=async l=>{var e,s;K.value=!0,P.value=null;try{const _=await dt(l);_.code===0&&_.data?(P.value=_.data,_.data.name&&(w.company_name=_.data.name),_.data.reg_num&&(w.organization=_.data.reg_num),i.success("营业执照识别成功，信息已自动填入")):i.error(_.message||"识别失败")}catch(_){console.error("OCR识别失败:",_),i.error(((s=(e=_.response)==null?void 0:e.data)==null?void 0:s.message)||"识别服务暂时不可用，请稍后重试")}finally{K.value=!1}};return Ca(()=>{b(),Ue(),ze(),Me()}),(l,e)=>{const s=Ua,_=xa,d=za,O=Ma,ue=Pa,G=Ra,V=Ba,ua=Ta,da=$a,_a=Aa,C=Sa,X=qa,y=Na,E=Ya,ve=ja,pa=La,B=Oa,ge=Ga,ye=Ja,ma=Ha,T=Ka,$=Ia,Q=Wa,be=Xa,fa=Qa,ca=Za,va=Ea;return f(),D("div",_t,[m("div",pt,[t(_,{onBack:Be,title:n.value.company_name||"用户详情"},{extra:a(()=>[m("div",mt,[k(x).operationManagerPrivate?(f(),v(s,{key:0,type:"success",onClick:Te},{default:a(()=>e[30]||(e[30]=[r("配置产品")])),_:1,__:[30]})):g("",!0),k(x).operationBasicPrivate?(f(),v(s,{key:1,type:"default",onClick:Se},{default:a(()=>e[31]||(e[31]=[r("添加被保险人")])),_:1,__:[31]})):g("",!0),k(x).operationBasicPrivate?(f(),v(s,{key:2,type:"default",onClick:qe},{default:a(()=>e[32]||(e[32]=[r("添加保险公司")])),_:1,__:[32]})):g("",!0),n.value.status==="待初审"&&k(x).riskBasicPrivate?(f(),v(s,{key:3,type:"primary",onClick:Ne},{default:a(()=>e[33]||(e[33]=[r("初审通过")])),_:1,__:[33]})):g("",!0),n.value.status==="待终审"&&k(x).riskManagerPrivate?(f(),v(s,{key:4,type:"warning",onClick:Ye},{default:a(()=>e[34]||(e[34]=[r("终审通过")])),_:1,__:[34]})):g("",!0),n.value.status==="审核通过"||n.value.status==="已停用"&&k(x).operationManagerPrivate?(f(),v(s,{key:5,type:"info",onClick:je},{default:a(()=>e[35]||(e[35]=[r("重置状态")])),_:1,__:[35]})):g("",!0),n.value.status==="审核通过"&&k(x).operationManagerPrivate?(f(),v(s,{key:6,type:"danger",onClick:Le},{default:a(()=>e[36]||(e[36]=[r("停用")])),_:1,__:[36]})):g("",!0),n.value.customer_id?g("",!0):(f(),v(s,{key:7,type:"warning",onClick:Oe},{default:a(()=>e[37]||(e[37]=[r("实名认证")])),_:1,__:[37]})),n.value.verify_url&&n.value.audit_status==="未认证"?(f(),v(s,{key:8,type:"success",onClick:Ge},{default:a(()=>e[38]||(e[38]=[r("继续认证")])),_:1,__:[38]})):g("",!0),n.value.verify_url?(f(),v(s,{key:9,type:"info",onClick:Je},{default:a(()=>e[39]||(e[39]=[r("复制认证链接")])),_:1,__:[39]})):g("",!0)])]),_:1},8,["title"])]),de((f(),v(G,{class:"detail-card"},{default:a(()=>[t(ue,{column:3,border:""},{default:a(()=>[t(d,{label:"企业名称",span:2},{default:a(()=>[r(u(n.value.company_name),1)]),_:1}),t(d,{label:"用户名"},{default:a(()=>[r(u(n.value.username),1)]),_:1}),t(d,{label:"用户状态"},{default:a(()=>[t(O,{type:aa(n.value.status)},{default:a(()=>[r(u(n.value.status),1)]),_:1},8,["type"])]),_:1}),t(d,{label:"认证状态"},{default:a(()=>[t(O,{type:ce(n.value.audit_status),size:"small"},{default:a(()=>[r(u(n.value.audit_status||"未认证"),1)]),_:1},8,["type"])]),_:1}),t(d,{label:"联系人"},{default:a(()=>[r(u(n.value.contact_name),1)]),_:1}),t(d,{label:"联系电话"},{default:a(()=>[r(u(n.value.contact_phone),1)]),_:1}),t(d,{label:"联系邮箱"},{default:a(()=>[r(u(n.value.contact_email),1)]),_:1}),t(d,{label:"创建时间"},{default:a(()=>[r(u(k(_e)(n.value.created_at)),1)]),_:1}),t(d,{label:"备注",span:3},{default:a(()=>[r(u(n.value.remark||"无"),1)]),_:1}),t(d,{span:3,label:"关联保险公司"},{default:a(()=>[r(u(la(n.value.insurer_ids)||"未设置"),1)]),_:1}),t(d,{span:3,label:"被保人"},{default:a(()=>[r(u(ra(n.value.insureds)||"未设置"),1)]),_:1})]),_:1})]),_:1})),[[va,te.value]]),t(G,{class:"detail-card"},{default:a(()=>[t(ua,{data:n.value.configs||[],border:"",style:{width:"100%"},"empty-text":"暂无配置信息","max-height":"300"},{default:a(()=>[t(V,{prop:"product.name",label:"产品",width:"360"}),t(V,{prop:"agent.company_name",label:"渠道商",width:"220"},{default:a(({row:o})=>{var Z;return[r(u(o.sell_mode==="直销"?"直销":((Z=o.agent)==null?void 0:Z.company_name)||"-"),1)]}),_:1}),t(V,{prop:"insurance_type",label:"险种",width:"90",align:"center"}),t(V,{prop:"seller",label:"销售员",width:"80",align:"center"}),t(V,{prop:"service_fee",label:"服务费",width:"80",align:"center"},{default:a(({row:o})=>[r(u(o.service_fee)+"% ",1)]),_:1}),t(V,{prop:"agent_cost",label:"渠道费",width:"80",align:"center"},{default:a(({row:o})=>[r(u(o.agent_cost)+"% ",1)]),_:1}),t(V,{prop:"overdue_date",label:"过期时间",width:"110"}),t(V,{label:"操作",width:"150",align:"center"},{default:a(({row:o})=>[t(s,{type:"primary",size:"small",onClick:Z=>$e(o)},{default:a(()=>e[40]||(e[40]=[r("编辑")])),_:2,__:[40]},1032,["onClick"]),t(s,{type:"danger",size:"small",onClick:Z=>Ae(o)},{default:a(()=>e[41]||(e[41]=[r("删除")])),_:2,__:[41]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(G,{class:"detail-card"},{default:a(()=>[t(ue,{column:3,border:""},{default:a(()=>[t(d,{label:"法大大客户ID"},{default:a(()=>[r(u(n.value.customer_id||"未生成"),1)]),_:1}),t(d,{label:"认证方式"},{default:a(()=>[r(u(n.value.verify_type||"未设置"),1)]),_:1}),t(d,{label:"统一社会信用代码"},{default:a(()=>[r(u(n.value.organization||"未填写"),1)]),_:1}),t(d,{label:"法人姓名"},{default:a(()=>[r(u(n.value.legal_name||"未填写"),1)]),_:1}),t(d,{label:"法人身份证号"},{default:a(()=>[r(u(n.value.legal||"未填写"),1)]),_:1}),t(d,{label:"法人手机号"},{default:a(()=>[r(u(n.value.legal_mobile||"未填写"),1)]),_:1}),t(d,{label:"企业邮箱"},{default:a(()=>[r(u(n.value.company_email||"未填写"),1)]),_:1}),t(d,{label:"组织类型"},{default:a(()=>[r(u(n.value.organization_type||"未设置"),1)]),_:1}),t(d,{label:"证件类型"},{default:a(()=>[r(u(n.value.certificates_type||"未设置"),1)]),_:1}),t(d,{label:"审核时间"},{default:a(()=>[r(u(n.value.auditor_time||"未审核"),1)]),_:1}),t(d,{label:"营业执照"},{default:a(()=>[n.value.organization_path?(f(),v(s,{key:0,type:"primary",onClick:e[0]||(e[0]=o=>W(n.value.organization_path))},{default:a(()=>e[42]||(e[42]=[r("查看")])),_:1,__:[42]})):g("",!0)]),_:1}),t(d,{label:"企业信息登记表"},{default:a(()=>[n.value.reg_form_path?(f(),v(s,{key:0,type:"primary",onClick:e[1]||(e[1]=o=>W(n.value.reg_form_path))},{default:a(()=>e[43]||(e[43]=[r("查看")])),_:1,__:[43]})):g("",!0)]),_:1})]),_:1})]),_:1}),t(G,{class:"detail-card"},{default:a(()=>[t(ue,{column:3,border:""},{default:a(()=>[t(d,{label:"管理员类型"},{default:a(()=>[r(u(n.value.manager_type||"-"),1)]),_:1}),t(d,{label:"姓名"},{default:a(()=>[r(u(n.value.manager_name||"-"),1)]),_:1}),t(d,{label:"身份证号"},{default:a(()=>[r(u(n.value.manager_id_card||"-"),1)]),_:1}),t(d,{label:"手机号"},{default:a(()=>[r(u(n.value.manager_mobile||"-"),1)]),_:1}),t(d,{label:"身份证正面"},{default:a(()=>[n.value.manager_head_photo_path?(f(),v(s,{key:0,type:"primary",onClick:e[2]||(e[2]=o=>W(n.value.manager_head_photo_path))},{default:a(()=>e[44]||(e[44]=[r("查看")])),_:1,__:[44]})):g("",!0)]),_:1}),t(d,{label:"身份证反面"},{default:a(()=>[n.value.manager_background_path?(f(),v(s,{key:0,type:"primary",onClick:e[3]||(e[3]=o=>W(n.value.manager_background_path))},{default:a(()=>e[45]||(e[45]=[r("查看")])),_:1,__:[45]})):g("",!0)]),_:1}),t(d,{label:"审核时间"},{default:a(()=>[r(u(n.value.manager_auditor_time||"未审核"),1)]),_:1}),t(d,{label:"审核状态"},{default:a(()=>[t(O,{type:ce(n.value.manager_audit_status)},{default:a(()=>[r(u(n.value.manager_audit_status||"未审核"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),t(G,{class:"detail-card"},{default:a(()=>[t(_a,null,{default:a(()=>[(f(!0),D(h,null,ee(n.value.logs,o=>(f(),v(da,{key:o.id,timestamp:k(_e)(o.created_at),type:ta(o.action)},{default:a(()=>[m("div",ft,[m("span",ct,u(o.admin_name),1),m("span",vt,u(o.content),1)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})]),_:1}),t($,{title:Ve.value,modelValue:F.value,"onUpdate:modelValue":e[13]||(e[13]=o=>F.value=o),width:"700px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",gt,[t(s,{onClick:e[12]||(e[12]=o=>F.value=!1)},{default:a(()=>e[50]||(e[50]=[r("取 消")])),_:1,__:[50]}),t(s,{type:"primary",onClick:Ze},{default:a(()=>[r(u(j.value?"更新":"确定"),1)]),_:1})])]),default:a(()=>[t(T,{ref_key:"configFormRef",ref:ne,model:p,rules:Ee,"label-width":"120px"},{default:a(()=>[t(ge,{gutter:20},{default:a(()=>[t(E,{span:24},{default:a(()=>[t(y,{label:"产品",prop:"product_id"},{default:a(()=>[t(X,{modelValue:p.product_id,"onUpdate:modelValue":e[4]||(e[4]=o=>p.product_id=o),placeholder:"请选择产品",style:{width:"100%"},filterable:""},{default:a(()=>[(f(!0),D(h,null,ee(me.value,o=>(f(),v(C,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(E,{span:24},{default:a(()=>[t(y,{label:"销售模式",prop:"sell_mode"},{default:a(()=>[t(pa,{modelValue:p.sell_mode,"onUpdate:modelValue":e[5]||(e[5]=o=>p.sell_mode=o)},{default:a(()=>[t(ve,{value:"直销"},{default:a(()=>e[46]||(e[46]=[r("直销")])),_:1,__:[46]}),t(ve,{value:"渠道"},{default:a(()=>e[47]||(e[47]=[r("渠道")])),_:1,__:[47]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),de(t(E,{span:24},{default:a(()=>[t(y,{label:"业务归属",prop:"agent_id"},{default:a(()=>[t(X,{modelValue:p.agent_id,"onUpdate:modelValue":e[6]||(e[6]=o=>p.agent_id=o),placeholder:"请选择业务归属",style:{width:"100%"},filterable:"",onChange:Pe},{default:a(()=>[(f(!0),D(h,null,ee(le.value,o=>(f(),v(C,{key:o.id,label:o.company_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},512),[[we,p.sell_mode==="渠道"]]),t(E,{span:12},{default:a(()=>[t(y,{label:"销售员",prop:"seller"},{default:a(()=>[t(B,{modelValue:p.seller,"onUpdate:modelValue":e[7]||(e[7]=o=>p.seller=o),placeholder:"请输入销售员姓名"},null,8,["modelValue"])]),_:1})]),_:1}),t(E,{span:12},{default:a(()=>[t(y,{label:"主要险种",prop:"insurance_type"},{default:a(()=>[t(X,{modelValue:p.insurance_type,"onUpdate:modelValue":e[8]||(e[8]=o=>p.insurance_type=o),placeholder:"请选择主要险种",style:{width:"100%"}},{default:a(()=>[t(C,{label:"车险",value:"车险"}),t(C,{label:"货运险",value:"货运险"}),t(C,{label:"船舶险",value:"船舶险"}),t(C,{label:"财产险",value:"财产险"}),t(C,{label:"工程险",value:"工程险"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(ge,{gutter:20},{default:a(()=>[t(E,{span:p.sell_mode==="直销"?24:12},{default:a(()=>[t(y,{label:"服务费",prop:"service_fee"},{default:a(()=>[t(ye,{modelValue:p.service_fee,"onUpdate:modelValue":e[9]||(e[9]=o=>p.service_fee=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:a(()=>e[48]||(e[48]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},8,["span"]),de(t(E,{span:12},{default:a(()=>[t(y,{label:"渠道成本",prop:"agent_cost"},{default:a(()=>[t(ye,{modelValue:p.agent_cost,"onUpdate:modelValue":e[10]||(e[10]=o=>p.agent_cost=o),precision:2,step:.1,min:0,max:100,"controls-position":l.right,style:{width:"100%"}},{suffix:a(()=>e[49]||(e[49]=[r("%")])),_:1},8,["modelValue","controls-position"])]),_:1})]),_:1},512),[[we,p.sell_mode==="渠道"]])]),_:1}),t(y,{label:"过期时间",prop:"overdue_date"},{default:a(()=>[t(ma,{modelValue:p.overdue_date,"onUpdate:modelValue":e[11]||(e[11]=o=>p.overdue_date=o),type:"date",placeholder:"请选择过期时间",style:{width:"100%"},format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),t($,{title:"初审",modelValue:U.value,"onUpdate:modelValue":e[16]||(e[16]=o=>U.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",bt,[t(s,{onClick:e[15]||(e[15]=o=>U.value=!1)},{default:a(()=>e[52]||(e[52]=[r("取 消")])),_:1,__:[52]}),t(s,{type:"success",onClick:He},{default:a(()=>e[53]||(e[53]=[r("通过初审")])),_:1,__:[53]}),t(s,{type:"danger",onClick:Ke},{default:a(()=>e[54]||(e[54]=[r("打回修改")])),_:1,__:[54]})])]),default:a(()=>[m("div",yt,[t(Q,{title:`当前状态：${n.value.status}`,type:"info",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[51]||(e[51]=m("p",{style:{"margin-bottom":"20px",color:"#666"}}," 请审核用户的基本信息和认证资料，确认无误后可以通过初审进入终审阶段。 ",-1))]),t(T,{ref_key:"initialReviewFormRef",ref:Ce,model:R,rules:ie,"label-width":"100px"},{default:a(()=>[t(y,{label:"审核备注",prop:"audit_note"},{default:a(()=>[t(B,{modelValue:R.audit_note,"onUpdate:modelValue":e[14]||(e[14]=o=>R.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t($,{title:"终审",modelValue:z.value,"onUpdate:modelValue":e[19]||(e[19]=o=>z.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",kt,[t(s,{onClick:e[18]||(e[18]=o=>z.value=!1)},{default:a(()=>e[56]||(e[56]=[r("取 消")])),_:1,__:[56]}),t(s,{type:"success",onClick:We},{default:a(()=>e[57]||(e[57]=[r("审核通过")])),_:1,__:[57]}),t(s,{type:"warning",onClick:Xe},{default:a(()=>e[58]||(e[58]=[r("退回初审")])),_:1,__:[58]})])]),default:a(()=>[m("div",wt,[t(Q,{title:`当前状态：${n.value.status}`,type:"warning",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[55]||(e[55]=m("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户已通过初审，请进行最终审核确认。通过后用户即可正常使用系统。 ",-1))]),t(T,{ref_key:"finalReviewFormRef",ref:xe,model:I,rules:ie,"label-width":"100px"},{default:a(()=>[t(y,{label:"审核备注",prop:"audit_note"},{default:a(()=>[t(B,{modelValue:I.audit_note,"onUpdate:modelValue":e[17]||(e[17]=o=>I.audit_note=o),type:"textarea",rows:4,placeholder:"请输入审核备注（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t($,{title:"重置用户状态",modelValue:q.value,"onUpdate:modelValue":e[22]||(e[22]=o=>q.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",Ct,[t(s,{onClick:e[21]||(e[21]=o=>q.value=!1)},{default:a(()=>e[60]||(e[60]=[r("取 消")])),_:1,__:[60]}),t(s,{type:"danger",onClick:Qe},{default:a(()=>e[61]||(e[61]=[r("重置到待初审")])),_:1,__:[61]})])]),default:a(()=>[m("div",Vt,[t(Q,{title:`当前状态：${n.value.status}`,type:"success",closable:!1,style:{"margin-bottom":"20px"}},null,8,["title"]),e[59]||(e[59]=m("p",{style:{"margin-bottom":"20px",color:"#666"}}," 用户当前已通过审核，如需重新审核可以将状态重置到初审阶段。 ",-1))]),t(T,{ref_key:"resetStatusFormRef",ref:Re,model:M,rules:ie,"label-width":"100px"},{default:a(()=>[t(y,{label:"重置原因",prop:"audit_note"},{default:a(()=>[t(B,{modelValue:M.audit_note,"onUpdate:modelValue":e[20]||(e[20]=o=>M.audit_note=o),type:"textarea",rows:4,placeholder:"请输入重置原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t($,{title:"添加被保险人",modelValue:N.value,"onUpdate:modelValue":e[26]||(e[26]=o=>N.value=o),width:"600px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",Ft,[t(s,{onClick:e[25]||(e[25]=o=>N.value=!1)},{default:a(()=>e[68]||(e[68]=[r("取 消")])),_:1,__:[68]}),t(s,{type:"primary",onClick:he},{default:a(()=>e[69]||(e[69]=[r("确 定")])),_:1,__:[69]})])]),default:a(()=>[t(T,{ref_key:"addInsuredFormRef",ref:re,model:w,rules:De,"label-width":"140px"},{default:a(()=>[t(y,{label:"营业执照识别"},{default:a(()=>[m("div",xt,[t(fa,{ref_key:"uploadRef",ref:Ie,"file-list":[],"auto-upload":!1,"show-file-list":!1,accept:"image/*","on-change":sa,drag:""},{default:a(()=>[m("div",Rt,[t(be,{class:"upload-icon"},{default:a(()=>[t(k(Da))]),_:1}),e[62]||(e[62]=m("div",{class:"upload-text"},"点击或拖拽上传营业执照图片",-1)),e[63]||(e[63]=m("div",{class:"upload-tip"},"支持 JPG、PNG、BMP 格式，文件大小不超过 5MB",-1))])]),_:1},512),K.value?(f(),D("div",It,[t(be,{class:"is-loading"},{default:a(()=>[t(k(Fa))]),_:1}),e[64]||(e[64]=m("span",null,"正在识别营业执照...",-1))])):g("",!0),P.value?(f(),D("div",Et,[t(Q,{title:"识别成功，信息已自动填入",type:"success",closable:!1,style:{"margin-bottom":"10px"}},{default:a(()=>[m("div",Dt,[m("p",null,[e[65]||(e[65]=m("strong",null,"公司名称：",-1)),r(u(P.value.name||"未识别"),1)]),m("p",null,[e[66]||(e[66]=m("strong",null,"信用代码：",-1)),r(u(P.value.reg_num||"未识别"),1)])])]),_:1})])):g("",!0)])]),_:1}),t(ca,null,{default:a(()=>e[67]||(e[67]=[r("或手动输入")])),_:1,__:[67]}),t(y,{label:"公司名称",prop:"company_name"},{default:a(()=>[t(B,{modelValue:w.company_name,"onUpdate:modelValue":e[23]||(e[23]=o=>w.company_name=o),placeholder:"请输入公司名称"},null,8,["modelValue"])]),_:1}),t(y,{label:"统一社会信用代码",prop:"organization"},{default:a(()=>[t(B,{modelValue:w.organization,"onUpdate:modelValue":e[24]||(e[24]=o=>w.organization=o),placeholder:"请输入统一社会信用代码（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t($,{title:"添加保险公司",modelValue:Y.value,"onUpdate:modelValue":e[29]||(e[29]=o=>Y.value=o),width:"500px","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[m("span",Ut,[t(s,{onClick:e[28]||(e[28]=o=>Y.value=!1)},{default:a(()=>e[70]||(e[70]=[r("取 消")])),_:1,__:[70]}),t(s,{type:"primary",onClick:ea},{default:a(()=>e[71]||(e[71]=[r("确 定")])),_:1,__:[71]})])]),default:a(()=>[t(T,{ref_key:"addInsurerFormRef",ref:se,model:L,rules:Fe,"label-width":"120px"},{default:a(()=>[t(y,{label:"保险公司",prop:"insurer_id"},{default:a(()=>[t(X,{modelValue:L.insurer_id,"onUpdate:modelValue":e[27]||(e[27]=o=>L.insurer_id=o),placeholder:"请选择保险公司",style:{width:"100%"},filterable:""},{default:a(()=>[(f(!0),D(h,null,ee(H.value,o=>(f(),v(C,{key:o.id,label:oa(o),value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},al=ya(zt,[["__scopeId","data-v-a25296e8"]]);export{al as default};
